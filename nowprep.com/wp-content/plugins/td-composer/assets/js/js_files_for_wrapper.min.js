var tdcNotice;
(function(f,e){tdcNotice={$_noticeWrapper:e,_isInitialized:!1,notice:function(b,d,a){if(tdcNotice._isInitialized){var c="";"undefined"!==typeof d&&!0===d&&(c="tdc-notice-error");var g="";"undefined"!==typeof a&&!0===a&&(g='<div class="tdc-close-notice"></div>');this.$element=f('<div class="tdc-notice '+c+'">'+b+g+"</div>");tdcNotice.$_noticeWrapper.append(this.$element);var l=this;if("undefined"!==typeof d&&!0===d)throw b;setTimeout(function(){l.$element.length&&l.$element.remove()},5E3)}},init:function(){tdcNotice._isInitialized||
(tdcNotice.$_noticeWrapper=f('<div class="tdc-notice-wrapper"></div>'),tdcNotice.$_noticeWrapper.on("click",".tdc-close-notice",function(b){f(this).closest(".tdc-notice").remove()}),f("#tdc-live-iframe-wrapper").append(tdcNotice.$_noticeWrapper),tdcNotice._isInitialized=!0)}};tdcNotice.init()})(jQuery);var tdcDebug;
(function(f,e){tdcDebug={_debug:!0,_logWindowObj:e,_content:e,_disabled:!1,log:function(b){tdcDebug._debug&&console.log(b)},dumpAllItems:function(){var b=tdcAdminIFrameUI.getIframeWindow();console.group("All items dump:");"undefined"!==typeof b.tdcComposerBlocksApi&&(console.log("%c tdcComposerBlocksApi.items ","background: #222; color: white"),console.log(b.tdcComposerBlocksApi.items));"undefined"!==typeof b.tdPullDown&&(console.log("%c tdPullDown.items ","background: #222; color: white"),console.log(b.tdPullDown.items));
"undefined"!==typeof b.tdAnimationSprite&&(console.log("%c tdAnimationSprite.items ","background: #222; color: white"),console.log(b.tdAnimationSprite.items));"undefined"!==typeof b.tdHomepageFull&&(console.log("%c tdHomepageFull.items ","background: #222; color: white"),console.log(b.tdHomepageFull.items));"undefined"!==typeof b.tdTrendingNow&&(console.log("%c tdTrendingNow.items ","background: #222; color: white"),console.log(b.tdTrendingNow.items));console.groupEnd()},group:function(b,d){!1!==
tdcDebug._debug&&(console.group?console.group(b,d):console.log(b))},groupCollapsed:function(b,d){!1!==tdcDebug._debug&&(console.groupCollapsed?console.groupCollapsed(b,d):console.log(b))},groupEnd:function(){!1!==tdcDebug._debug&&console.groupEnd&&console.groupEnd()},logWindow:function(b){if(e===tdcDebug._logWindowObj){tdcDebug._logWindowObj=f("<div></div>");var d=f('<div style="width: 50px; cursor: pointer; float: left; border: 1px solid black">Clear</div>'),a=f('<div style="width: 50px; cursor: pointer; float: left; border: 1px solid black">Disable</div>');
tdcDebug._content=f('<div style="clear: both"></div>');tdcDebug._logWindowObj.append(d);tdcDebug._logWindowObj.append(a);d.click(function(a){tdcDebug._content.html("")});a.click(function(a){tdcDebug._disabled=!tdcDebug._disabled;tdcDebug._disabled?f(this).css("background-color","#FF000"):f(this).css("background-color","")});tdcDebug._logWindowObj.append(tdcDebug._content);f("body").append(tdcDebug._logWindowObj);tdcDebug._logWindowObj.css({width:300,height:500,border:"1px solid red",position:"fixed",
bottom:0,right:20,"background-color":"#FFFFFF",overflow:"scroll","z-index":1E4})}tdcDebug._disabled||tdcDebug._content.html(b+"<br>"+tdcDebug._content.html())}}})(jQuery);var tdcUtil={};
(function(){tdcUtil={getRestEndPoint:function(f,e){return _.isEmpty(window.tdcAdminSettings.permalinkStructure)?window.tdcAdminSettings.wpRestUrl+f+"&"+e:window.tdcAdminSettings.wpRestUrl+f+"?"+e},makeSafeForCSS:function(f){return f.replace(/[^a-z0-9]/g,function(e){var b=e.charCodeAt(0);return 32===b?"-":65<=b&&90>=b?e.toLowerCase():"__"+("000"+b.toString(16)).slice(-4)})}}})();var tdcRecycle;
(function(f,e,b){tdcRecycle={_maxItems:100,_items:[],$_restoreItem:b,$_restoreContent:b,item:function(b,a,c){this.timestamp=b;this.description=a;this.shortcode=c},init:function(){tdcRecycle.$_restoreItem=f("#tdc-restore");tdcRecycle.$_restoreContent=f("#tdc-restore-content");tdcRecycle.$_restoreItem.on("click",function(b){tdcRecycle.$_restoreContent.toggle()});tdcRecycle.$_restoreContent.on("click",".tdc-snapshot",function(d){d=new tdcJobManager.job;var a=f(this).find(".tdc-snapshot-shortcode").html();
d.shortcode=a;d.columns=3;d.success_callback=function(c){var g=f(tdcAdminIFrameUI._$liveIframe).contents(),d=g.find("#tdc-rows");e.has(c,"replyHtml")&&d.replaceWith(c.replyHtml);window.addWrappers(g);tdcIFrameData._isInitialized=!1;tdcIFrameData._postOriginalContentJSON=b;window.tdcPostSettings.postContent=a;tdcIFrameData.init(g);tdcOperationUI.init(g);e.has(c,"replyJsForEval")&&tdcAdminIFrameUI.evalInIframe(c.replyJsForEval)};d.error_callback=function(a,b){tdcDebug.log(b);tdcDebug.log(a)};tdcJobManager.addJob(d)})},
takeSnapshot:function(d){var a={error:b,getShortcode:""};tdcIFrameData.getShortcodeFromData(a);e.isUndefined(a.error)||tdcDebug.log(a.error);if(!e.isUndefined(a.getShortcode)){var c=new Date;d=new tdcRecycle.item(c.getTime(),d,a.getShortcode);tdcRecycle._maxItems===tdcRecycle._items.length&&(tdcRecycle._items.splice(0,1),tdcRecycle.$_restoreContent.find(".tdc-snapshot:first").remove());tdcRecycle._items.push(d);tdcRecycle.$_restoreContent.prepend('<div class="tdc-snapshot"><div style="width: 150px; float: left">'+
c.toLocaleDateString()+" "+c.toLocaleTimeString()+'</div><div style="width: 350px; float: left">Before '+d.description+'</div><div class="tdc-snapshot-shortcode" style="display: none">'+d.shortcode+"</div></div>")}}};tdcRecycle.init()})(jQuery,_);var tdcSavePost;
(function(f,e,b,d){tdcSavePost={content:d,save:function(){var a={error:d,getShortcode:""};tdcIFrameData.getShortcodeFromData(a);b.isUndefined(a.error)||tdcDebug.log(a.error);b.isUndefined(a.getShortcode)||b.isUndefined(window.tdcPostSettings)||(tdcSavePost.content=a.getShortcode,tdcLivePanel.$tdcAction.val("tdc_ajax_save_post"),tdcLivePanel.$tdcContent.val(tdcSavePost.content),tdcDebug.log(tdcSavePost.content),f.ajax({timeout:1E4,type:"POST",url:tdcUtil.getRestEndPoint("td-composer/save_post","uuid="+
tdcJobManager._getUniqueID()),beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",window.tdcAdminSettings.wpRestNonce);tdcLivePanelMenuSettings.saveMenuSettings()},data:tdcLivePanel.$panel.serialize()}).done(function(a,g,d){window.tdcPostSettings.postContent=tdcSavePost.content;f(".tdc-save-page").removeClass("tdc-saving-loader");"success"===g&&(b.isObject(a)&&b.has(a,"errors")?new tdcNotice.notice(a.errors,!0,!1):new tdcNotice.notice(g,!1,!0),tdcMain.resetContentModified())}).fail(function(a,
b,d){}))}}})(jQuery,Backbone,_);var tdcShortcodeParser={};
(function(){tdcShortcodeParser={levels:{},init:function(f){tdcShortcodeParser.levels=_.clone(f);tdcShortcodeParser.levels[2]=tdcShortcodeParser.levels[2].concat(tdcShortcodeParser.levels[4])},multiNext:function(f,e){for(var b=tdcShortcodeParser.levels[f],d,a=0;a<b.length;a++){var c=tdcShortcodeParser.generateTreeElement(wp.shortcode.next(b[a],e));"undefined"!==typeof c&&("undefined"===typeof d||d.index>c.index)&&(d=c)}return d},parse:function(f,e){for(var b=tdcShortcodeParser.multiNext(f,e),d=0,a=
[];"undefined"!==typeof b&&5E3>d;)e=e.substring(b.index+b.content.length),4>f&&(b.child=tdcShortcodeParser.parse(f+1,b.content)),a.push(b),b=tdcShortcodeParser.multiNext(f,e),d++;return a},generateTreeElement:function(f){return f}}})();var tdcJobManager={};
(function(){tdcJobManager={_sentJobs:{},totalJobsCount:0,job:function(){this.shortcode="";this.columns=0;this.error_callback=this.success_callback=this.blockUid=""},jobRequest:function(f){this.shortcode=f.shortcode;this.columns=f.columns;this.jobId=tdcJobManager._generateJobId();this.postId=window.tdcPostSettings.postId;this.replyHtml=""},addJob:function(f){tdcMain.setContentModified();tdcDebug.group("%c tdcJobManager.addJob","background-color:#2489c2; color:white");var e=new tdcJobManager.jobRequest(f);
jQuery.ajax({timeout:1E4,type:"POST",url:tdcUtil.getRestEndPoint("td-composer/do_job","tmp_jobId="+e.jobId+"&tmp_blockUid="+e.blockUid+"&uuid="+tdcJobManager._getUniqueID()),beforeSend:function(b){b.setRequestHeader("X-WP-Nonce",window.tdcAdminSettings.wpRestNonce)},cache:!1,data:e,dataType:"json",statusCode:{404:function(){console.log("tdcJobManager.addJob - ERROR: 404 not found")},500:function(){console.log("tdcJobManager.addJob - ERROR: 500 server error")}},success:function(b,d,a){null===b?f.error(e,
"tdcJobManager.addJob - ERROR: Empty response received from server"):(!0===tdcJobManager._isJobCallbackReplyValid(f.blockUid,b.jobId)?f.success_callback(b):tdcDebug.log("tdcJobManager.addJob - dropped job :) (probably it's older than the last timestamp)"),tdcDebug.groupEnd())},error:function(b,d,a){f.error_callback(e,"tdcJobManager.addJob - Error callback - textStatus: "+d+" errorThrown: "+a);tdcDebug.groupEnd()}})},_isJobCallbackReplyValid:function(f,e){return"undefined"===typeof tdcJobManager._sentJobs[f]||
parseInt(tdcJobManager._sentJobs[f])<parseInt(e)?(tdcJobManager._sentJobs[f]=e,!0):!1},_generateJobId:function(){var f=tdcJobManager.totalJobsCount;tdcJobManager.totalJobsCount++;return f},_getUniqueID:function(){function f(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return f()+f()+"-"+f()+"-"+f()+"-"+f()+"-"+f()+f()+f()}}})();var tdcAdminWrapperUI;
(function(f,e){tdcAdminWrapperUI={$placeholder:e,$helper:e,$recycle:e,_initialized:!1,init:function(){tdcAdminWrapperUI._tdcJqObjElements=f(".tdc-sidebar-elements");tdcAdminWrapperUI.helperId="tdc-dragged-helper";tdcAdminWrapperUI.placeholderId="tdc-placeholder";tdcAdminWrapperUI.maskId="tdc-mask";tdcAdminWrapperUI.$helper=f('<div id="'+tdcAdminWrapperUI.helperId+'"></div>');tdcAdminWrapperUI.$placeholder=f('<span id="'+tdcAdminWrapperUI.placeholderId+'"></span>');f("body").append(tdcAdminWrapperUI.$helper);
f("body").append(tdcAdminWrapperUI.$placeholder);f(".tdc-save-page").click(function(b){f(this).hasClass("tdc-saving-loader")||(f(this).addClass("tdc-saving-loader"),tdcSavePost.save())})}};tdcAdminWrapperUI.init()})(jQuery);var tdcOperationUI;
(function(f,e,b,d){tdcOperationUI={iframeContents:d,_draggedElement:{$element:d},_currentElementOver:{$element:d},_emptyElementClass:"tdc-element-empty",_isPlaceholderVisible:!1,_intervalUpdateInfoHelper:d,init:function(a,c){window.previousMouseClientX=0;window.previousMouseClientY=0;tdcOperationUI.iframeContents=a;tdcRowUI.init(tdcOperationUI.iframeContents);tdcColumnUI.init(tdcOperationUI.iframeContents);tdcInnerRowUI.init(tdcOperationUI.iframeContents);tdcInnerColumnUI.init(tdcOperationUI.iframeContents);
tdcElementUI.init(tdcOperationUI.iframeContents);tdcRecycleUI.init(c);tdcAdminWrapperUI.$mask=f('<div id="'+tdcAdminWrapperUI.maskId+'"></div>');tdcOperationUI.iframeContents.find("body").append(tdcAdminWrapperUI.$mask);tdcMaskUI.init(tdcAdminWrapperUI.$mask,c);f(window).mouseup(function(a){tdcOperationUI.deactiveDraggedElement();tdcOperationUI.hideHelper()}).mousemove(function(a){tdcOperationUI.showHelper(a)}).keydown(function(a){});a.mousedown(function(a){tdcSidebar.setSettings({$currentRow:d,$currentColumn:d,
$currentInnerRow:d,$currentInnerColumn:d,$currentElement:d});tdcSidebar.closeModals()}).mouseup(function(a){tdcOperationUI.deactiveDraggedElement();tdcOperationUI.hideHelper();tdcOperationUI.setCurrentElementOver(d);tdcElementUI.positionElementPlaceholder(a)}).mousemove(function(a){tdcOperationUI.showHelper(a);window.previousMouseClientX=a.clientX;window.previousMouseClientY=a.clientY}).scroll(function(a){tdcOperationUI.isElementDragged()?tdcElementUI.positionElementPlaceholder(a):tdcOperationUI.isInnerColumnDragged()?
tdcInnerColumnUI.positionInnerColumnPlaceholder(a):tdcOperationUI.isInnerRowDragged()||tdcOperationUI.isTempInnerRowDragged()?tdcInnerRowUI.positionInnerRowPlaceholder(a):tdcOperationUI.isColumnDragged()?tdcColumnUI.positionColumnPlaceholder(a):(tdcOperationUI.isRowDragged()||tdcOperationUI.isTempRowDragged())&&tdcRowUI.positionRowPlaceholder(a)}).keydown(function(a){});tdcAdminWrapperUI.$helper.mouseup(function(a){tdcOperationUI.hideHelper()})},_keyDownHandler:function(a){46===a.keyCode&&(a=tdcSidebar.getCurrentModel(),
b.isUndefined(a)||"vc_row"===a.get("tag")||"vc_column"===a.get("tag")||"vc_row_inner"===a.get("tag")||"vc_column_inner"===a.get("tag")||tdcElementHandlerUI.deleteHandler(null))},setDraggedElement:function(a){tdcOperationUI._draggedElement.$element=a;b.isUndefined(a)||(tdcOperationUI._draggedElement.classes=a[0].className.split(" "))},getDraggedElement:function(){return tdcOperationUI._draggedElement.$element},hasClassDraggedElement:function(a){if(!b.isUndefined(tdcOperationUI._draggedElement.$element))return-1!==
tdcOperationUI._draggedElement.classes.indexOf(a)},addClassDraggedElement:function(a){b.isUndefined(tdcOperationUI._draggedElement.$element)||tdcOperationUI._draggedElement.$element.addClass(a)},setCurrentElementOver:function(a){if(!b.isUndefined(a)||!b.isUndefined(tdcOperationUI._currentElementOver.$element))if(b.isUndefined(a)||b.isUndefined(tdcOperationUI._currentElementOver.$element)||!a.is(tdcOperationUI._currentElementOver.$element.get(0)))tdcOperationUI._currentElementOver.$element=a,b.isUndefined(a)||
(tdcOperationUI._currentElementOver.elementOuterHeight=a.outerHeight(!0),tdcOperationUI._currentElementOver.elementOuterWidth=a.outerWidth(!0),tdcOperationUI._currentElementOver.elementOffset=a.offset())},getCurrentElementOver:function(){return tdcOperationUI._currentElementOver.$element},getCurrentElementOverOuterHeight:function(){if(!b.isUndefined(tdcOperationUI._currentElementOver.$element)&&!b.isUndefined(tdcOperationUI._currentElementOver.elementOuterHeight))return tdcOperationUI._currentElementOver.elementOuterHeight},
getCurrentElementOverOuterWidth:function(){if(!b.isUndefined(tdcOperationUI._currentElementOver.$element)&&!b.isUndefined(tdcOperationUI._currentElementOver.elementOuterWidth))return tdcOperationUI._currentElementOver.elementOuterWidth},getCurrentElementOverOffset:function(){if(!b.isUndefined(tdcOperationUI._currentElementOver.$element)&&!b.isUndefined(tdcOperationUI._currentElementOver.elementOffset))return tdcOperationUI._currentElementOver.elementOffset},_placeholderCacheCssSettings:{classes:d,
props:d},setPlaceholderCss:function(a){if(b.isUndefined(tdcOperationUI._placeholderCacheCssSettings)||!b.isEqual(tdcOperationUI._placeholderCacheCssSettings,a))tdcOperationUI._placeholderCacheCssSettings=a,tdcAdminWrapperUI.$placeholder.css(a)},setReadyToMove:function(){var a=tdcOperationUI.getDraggedElement();b.isUndefined(a)||a.addClass("tdc-ready-to-move")},clearReadyToMove:function(){var a=tdcOperationUI.getDraggedElement();b.isUndefined(a)||a.removeClass("tdc-ready-to-move")},activeDraggedElement:function(a){tdcOperationUI.setDraggedElement(a);
tdcOperationUI.hasClassDraggedElement("tdc-dragged")||tdcOperationUI.addClassDraggedElement("tdc-dragged")},deactiveDraggedElement:function(){var a=tdcOperationUI.getDraggedElement();b.isUndefined(a)||(a.removeClass("tdc-dragged"),tdcOperationUI._moveDraggedElement(),tdcSidebar.setSettings({$currentRow:tdcOperationUI.inRow(a),$currentColumn:tdcOperationUI.inColumn(a),$currentInnerRow:tdcOperationUI.inInnerRow(a),$currentInnerColumn:tdcOperationUI.inInnerColumn(a),$currentElement:a}),tdcOperationUI.setDraggedElement(d))},
showHelper:function(a){var c=tdcAdminWrapperUI.$helper,g=tdcOperationUI.getDraggedElement();if(b.isUndefined(g))tdcOperationUI.hideHelper(),tdcRecycleUI.hide(),tdcOperationUI.setLiveIframeCss("tdc-active-helper",!0);else{var d=0;!0!==tdcMain.getSidebarInline()||!1!==tdcMain.getSidebarHidden()||f(a.target).closest("#tdc-sidebar").length||(d=tdcSidebar.$_sidebar.width());var k=tdcAdminIFrameUI.getLiveIframe().width(),e=0;window.innerWidth!==k&&(e=(window.innerWidth-k)/2,!0===tdcMain.getSidebarInline()&&
!1===tdcMain.getSidebarHidden()&&(e-=tdcSidebar.$_sidebar.width()/2));f(a.target).closest("#tdc-sidebar").length?e=0:f(a.target).closest("#tdc-live-iframe-wrapper").length&&(e=0,tdcMain.getSidebarInline()&&(e=-tdcSidebar.$_sidebar.width()));c.css({left:a.clientX-30+d+e,top:a.clientY-22});c.show();tdcOperationUI.deactivateMenu();tdcOperationUI.setLiveIframeCss("tdc-active-helper");g.hasClass("tdc-element");a=g.data("shortcodeName");b.isUndefined(a)&&(g=g.data("model_id"),a=tdcIFrameData.getModel(g).get("tag"));
b.isUndefined(a)||c.addClass("tdc-element-ico tdc-ico-"+a);tdcRecycleUI.show()}},hideHelper:function(){tdcAdminWrapperUI.$helper.hide();tdcAdminWrapperUI.$helper.removeClass();tdcOperationUI.activateMenu()},setLiveIframeCss:function(a,c){var g=tdcAdminIFrameUI.getLiveIframe();b.isUndefined(c)?g.contents().find("body").addClass(a):g.contents().find("body").removeClass(a)},activateMenu:function(){var a=tdcAdminIFrameUI.getLiveIframe().contents().find(".td-header-wrap");a.length&&a.removeClass("tdc-inactive-menu")},
deactivateMenu:function(){var a=tdcAdminIFrameUI.getLiveIframe().contents().find(".td-header-wrap");a.length&&a.addClass("tdc-inactive-menu")},updateInfoHelper:function(a){},showPlaceholder:function(){var a=tdcAdminWrapperUI.$placeholder;!1===tdcOperationUI._isPlaceholderVisible&&(tdcOperationUI._isPlaceholderVisible=!0,a.show(),tdcOperationUI.updateInfoHelper(d))},hidePlaceholder:function(){var a=tdcAdminWrapperUI.$placeholder;!0===tdcOperationUI._isPlaceholderVisible&&(tdcOperationUI._isPlaceholderVisible=
!1,a.hide(),tdcOperationUI.updateInfoHelper(!0))},isPlaceholderVisible:function(){return tdcOperationUI._isPlaceholderVisible},isRowDragged:function(){var a=tdcOperationUI.getDraggedElement();return!b.isUndefined(a)&&tdcOperationUI.hasClassDraggedElement(tdcRowUI.getElementCssClass())},inRow:function(a){a=a.closest("."+tdcRowUI.getElementCssClass());if(a.length)return a},isRow:function(a){return a.hasClass(tdcRowUI.getElementCssClass())},isTempRowDragged:function(){var a=tdcOperationUI.getDraggedElement();
return!b.isUndefined(a)&&tdcOperationUI.hasClassDraggedElement("tdc-row-temp")},isColumnDragged:function(a){var c=tdcOperationUI.getDraggedElement(),c=!b.isUndefined(c)&&tdcOperationUI.hasClassDraggedElement(tdcColumnUI.getElementCssClass());b.isUndefined(a)||(c=c&&(0<a.siblings(".tdc-column.tdc-dragged").length||a.hasClass("tdc-dragged")));return c},inColumn:function(a){a=a.closest("."+tdcColumnUI.getElementCssClass());if(a.length)return a},isColumn:function(a){return a.hasClass(tdcColumnUI.getElementCssClass())},
isInnerRowDragged:function(){var a=tdcOperationUI.getDraggedElement();return!b.isUndefined(a)&&tdcOperationUI.hasClassDraggedElement(tdcInnerRowUI.getElementCssClass())},inInnerRow:function(a){a=a.closest("."+tdcInnerRowUI.getElementCssClass());if(a.length)return a},isInnerRow:function(a){return a.hasClass(tdcInnerRowUI.getElementCssClass())},isTempInnerRowDragged:function(){var a=tdcOperationUI.getDraggedElement();return!b.isUndefined(a)&&tdcOperationUI.hasClassDraggedElement("tdc-element-inner-row-temp")},
isInnerColumnDragged:function(a){var c=tdcOperationUI.getDraggedElement(),c=!b.isUndefined(c)&&tdcOperationUI.hasClassDraggedElement(tdcInnerColumnUI.getElementCssClass());b.isUndefined(a)||(c=c&&(0<a.siblings(".tdc-inner-column.tdc-dragged").length||a.hasClass("tdc-dragged")));return c},inInnerColumn:function(a){a=a.closest("."+tdcInnerColumnUI.getElementCssClass());if(a.length)return a},isInnerColumn:function(a){return a.hasClass(tdcInnerColumnUI.getElementCssClass())},isElement:function(a){return a.hasClass(tdcElementUI.getElementCssClass())},
isElementDragged:function(){var a=tdcOperationUI.getDraggedElement();return!b.isUndefined(a)&&tdcOperationUI.hasClassDraggedElement("tdc-element")},isSidebarElementDragged:function(){var a=tdcOperationUI.getDraggedElement();return!b.isUndefined(a)&&tdcOperationUI.hasClassDraggedElement("tdc-sidebar-element")},setPlaceholder:function(a,c){var g=tdcAdminWrapperUI.$placeholder;if(b.isUndefined(tdcOperationUI._placeholderCacheCssSettings.classes)||!b.isUndefined(tdcOperationUI._placeholderCacheCssSettings.classes)&&
tdcOperationUI._placeholderCacheCssSettings.classes!==a)tdcOperationUI._placeholderCacheCssSettings.classes=a,a.length?g.addClass(a):g.attr("class","");b.isObject(c)&&(b.isUndefined(tdcOperationUI._placeholderCacheCssSettings.props)||!b.isUndefined(tdcOperationUI._placeholderCacheCssSettings.props)&&!b.isEqual(tdcOperationUI._placeholderCacheCssSettings.props,c))&&(tdcOperationUI._placeholderCacheCssSettings.props=c,g.css(c))},setHorizontalPlaceholder:function(a){tdcOperationUI.setPlaceholder("",
a)},setVerticalPlaceholder:function(a){tdcOperationUI.setPlaceholder("vertical",a)},_moveDraggedElement:function(){var a=tdcOperationUI.getDraggedElement(),c=tdcOperationUI.getCurrentElementOver(),g=tdcAdminWrapperUI.$placeholder,l="";if(!(b.isUndefined(a)||b.isUndefined(c)||b.isUndefined(g)||!g.is(":visible")&&c!==tdcAdminWrapperUI.$recycle)){var k=tdcOperationUI.isSidebarElementDragged(),e=tdcOperationUI.isElementDragged(),h=!1,m=!1,n=!1,p=!1,u=!1,v=!1;if(e){var w=a.closest(".tdc-elements");k||
(l=tdcIFrameData._getSourceCol())}else(h=tdcOperationUI.isInnerColumnDragged())&&(w=a.closest(".tdc-inner-columns"));!h&&(m=tdcOperationUI.isInnerRowDragged(),n=tdcOperationUI.isTempInnerRowDragged(),m||n)&&(w=a.closest(".tdc-elements"));m||n||(p=tdcOperationUI.isColumnDragged())&&(w=a.closest(".tdc-columns"));!p&&(u=tdcOperationUI.isRowDragged(),v=tdcOperationUI.isTempRowDragged(),u||v)&&(w=a.closest("#tdc-rows"));if(k||e||h||m||n||p||u||v){var r="",t=a.find(".td_block_inner");t.length&&(r=t.attr("id"));
if(!k&&!b.isUndefined(w)&&w.length){var x=w.children(),t=x.index(a),y=x.index(g);if(c!==tdcAdminWrapperUI.$recycle&&-1!==y&&1===Math.abs(t-y))return;if(e||m||n||u||v){if((e||m||u)&&c===tdcAdminWrapperUI.$recycle){g="Deleting ";tdConfirm.showModal(m?g+"inner row":u?g+"row":g+"element",tdcOperationUI,function(){if((-1===y&&1===x.length||2===x.length&&-1!==y)&&(!u||1!==tdcIFrameData.tdcRows.length)){var c="";z=a.closest(".tdc-inner-column");z.length?c=" tdc-element-inner-column":(A=a.closest(".tdc-column"),
A.length&&(c=" tdc-element-column"));c=f('<div class="'+tdcOperationUI._emptyElementClass+c+'" title="Empty element that should be removed by composer"></div>');tdcElementUI.bindEmptyElement(c);w.append(c)}tdcOperationUI.setDraggedElement(a);tdcOperationUI.setCurrentElementOver(tdcAdminWrapperUI.$recycle);tdcIFrameData.changeData({wasSidebarElementDragged:k,wasElementDragged:e,wasInnerColumnDragged:h,wasInnerRowDragged:m,wasTempInnerRowDragged:n,wasColumnDragged:p,wasRowDragged:u,wasTempRowDragged:v,
draggedBlockUid:r,sourceColParam:l});tdcSidebarPanel.clearPanel();tdcOperationUI.setDraggedElement(d);tdcOperationUI.setCurrentElementOver(d);tb_remove()},d,"Are you sure you want to delete this element?");return}if(-1===y&&1===x.length||2===x.length&&-1!==y){c="";var z=a.closest(".tdc-inner-column");if(z.length)c=" tdc-element-inner-column";else{var A=a.closest(".tdc-column");A.length&&(c=" tdc-element-column")}c=f('<div class="'+tdcOperationUI._emptyElementClass+c+'" title="Empty element that should be removed by composer"></div>');
tdcElementUI.bindEmptyElement(c);w.append(c)}}}k&&(c="",e?c="tdc-element":n?c="tdc-element-inner-row-temp":m?c="tdc-element-inner-row":v?c="tdc-row-temp":u&&(c="tdc-row"),c=f('<div class="'+c+'">'+a.html()+"</div>"),c.data("shortcodeName",a.data("shortcodeName")),tdcOperationUI.setDraggedElement(c),a=tdcOperationUI.getDraggedElement());g.replaceWith(a);if(k||e)z=a.closest(".tdc-inner-column"),z.length?(a.removeClass("tdc-element-column"),a.addClass("tdc-element-inner-column")):(A=a.closest(".tdc-column"),
A.length&&(a.removeClass("tdc-element-inner-column"),a.addClass("tdc-element-column")));g=a.prev();g.hasClass(tdcOperationUI._emptyElementClass)&&g.remove();g=a.next();g.hasClass(tdcOperationUI._emptyElementClass)&&g.remove();tdcIFrameData.changeData({wasSidebarElementDragged:k,wasElementDragged:e,wasInnerColumnDragged:h,wasInnerRowDragged:m,wasTempInnerRowDragged:n,wasColumnDragged:p,wasRowDragged:u,wasTempRowDragged:v,draggedBlockUid:r,sourceColParam:l})}else new tdcNotice.notice("_moveDraggedElement Error: $draggedElement not valid!",
!0,!1)}}}})(jQuery,Backbone,_);var tdcRowUI;
(function(f,e,b,d){tdcRowUI={_elementCssClass:"tdc-row",tdcRow:d,init:function(a){b.isUndefined(a)&&(a=tdcOperationUI.iframeContents);tdcRowUI.tdcRow=a.find(".tdc-row");tdcRowUI.tdcRow.each(function(a,b){tdcRowUI.bindRow(f(b))})},_mouseCoordinates:d,_setMouseCoordinates:function(a){tdcRowUI._mouseCoordinates=a},_getMouseCoordinates:function(){return tdcRowUI._mouseCoordinates},bindRow:function(a){a.unbind();a.click(function(a){a.preventDefault();a.stopPropagation()}).mousedown(function(c){1===c.which&&
(c.preventDefault(),c.stopPropagation(),tdcOperationUI.activeDraggedElement(f(this)),tdcOperationUI.hideHelper(),tdcOperationUI.setCurrentElementOver(a),tdcRowUI.positionRowPlaceholder(c,!0),tdcSidebar.setSettings({$currentRow:tdcOperationUI.inRow(a)}),tdcRowUI._setMouseCoordinates({screenX:c.screenX,screenY:c.screenY}),tdcOperationUI.setReadyToMove())}).mouseup(function(c){if(tdcOperationUI.isRowDragged()||tdcOperationUI.isTempRowDragged())c.preventDefault(),tdcOperationUI.clearReadyToMove(),tdcOperationUI.deactiveDraggedElement(),
tdcOperationUI.hideHelper(),tdcRowUI._setMouseCoordinates(d);tdcMaskUI.setContentAtMouseUp(a)}).mousemove(function(c){if(tdcOperationUI.isRowDragged()||tdcOperationUI.isTempRowDragged())b.isEqual({screenX:c.screenX,screenY:c.screenY},tdcRowUI._getMouseCoordinates())?(c.stopPropagation(),tdcOperationUI.hideHelper()):(c.preventDefault(),c.stopPropagation(),tdcOperationUI.showHelper(c),tdcOperationUI.setCurrentElementOver(a),tdcRowUI.positionRowPlaceholder(c),tdcMaskUI.hide(),tdcRowUI._setMouseCoordinates(d),
tdcOperationUI.clearReadyToMove())}).mouseenter(function(c){tdcOperationUI.isRowDragged()||tdcOperationUI.isTempRowDragged()?(c.preventDefault(),tdcOperationUI.setCurrentElementOver(a),tdcRowUI.positionRowPlaceholder(c)):b.isUndefined(tdcOperationUI.getDraggedElement())&&tdcMaskUI.setCurrentContainer(a)}).mouseleave(function(a){tdcOperationUI.isRowDragged()||tdcOperationUI.isTempRowDragged()?(a.preventDefault(),tdcOperationUI.setCurrentElementOver(d),tdcRowUI.positionRowPlaceholder(a)):tdcMaskUI.setCurrentContainer(d)}).on("fakemouseenterevent",
function(c){if(tdcOperationUI.isRowDragged()||tdcOperationUI.isTempRowDragged()){var b=a.outerHeight(!0),d=a.outerWidth(),k=a.offset();parseInt(k.left)<=parseInt(c.pageX)&&parseInt(c.pageX)<=parseInt(k.left+d)&&parseInt(k.top)<=parseInt(c.pageY)&&parseInt(c.pageY)<=parseInt(k.top+b)&&(tdcOperationUI.setCurrentElementOver(a),tdcRowUI.positionRowPlaceholder(c))}})},positionRowPlaceholder:function(a,c){var g=tdcAdminWrapperUI.$placeholder,l=0,k=0;if("mousedown"===a.type||"mousemove"===a.type||"fakemouseenterevent"===
a.type)l=a.pageX,k=a.pageY,b.isUndefined(a.clientX)||b.isUndefined(a.clientY)||(window.previousMouseClientX=a.clientX,window.previousMouseClientY=a.clientY);else if("scroll"===a.type){var l=tdcOperationUI.iframeContents.scrollLeft()+window.previousMouseClientX,k=tdcOperationUI.iframeContents.scrollTop()+window.previousMouseClientY,e={pageX:l,pageY:k};tdcOperationUI.setCurrentElementOver(d);tdcRowUI.tdcRow.each(function(a,c){b.isUndefined(tdcOperationUI.getCurrentElementOver())&&f(c).trigger(f.Event("fakemouseenterevent",
e))});return}l=tdcOperationUI.getCurrentElementOver();if(b.isUndefined(tdcOperationUI.getDraggedElement())||b.isUndefined(l))tdcOperationUI.hidePlaceholder();else{var h=tdcOperationUI.getCurrentElementOverOuterHeight(),m=tdcOperationUI.getCurrentElementOverOuterWidth(),n=tdcOperationUI.getCurrentElementOverOffset();if(k>n.top+h/2){k=l.next();if(!k.length||k.length&&k.attr("id")!==tdcAdminWrapperUI.placeholderId)l.after(g),tdcOperationUI.updateInfoHelper();parseInt(n.top)+parseInt(h)>parseInt(tdcOperationUI.iframeContents.scrollTop())+
parseInt(window.innerHeight)?tdcOperationUI.setHorizontalPlaceholder({position:"fixed",top:"",left:"",right:"auto",bottom:"0",width:m,"margin-left":""}):tdcOperationUI.setHorizontalPlaceholder({position:"absolute",top:"",left:"",right:"",bottom:"",width:m,"margin-left":""})}else{k=l.prev();if(!k.length||k.length&&k.attr("id")!==tdcAdminWrapperUI.placeholderId)l.before(g),tdcOperationUI.updateInfoHelper();parseInt(n.top)<parseInt(tdcOperationUI.iframeContents.scrollTop())?tdcOperationUI.setHorizontalPlaceholder({position:"fixed",
top:"0",left:"",right:"auto",bottom:"",width:m,"margin-left":""}):tdcOperationUI.setHorizontalPlaceholder({position:"absolute",top:"",left:"",right:"",bottom:"",width:m,"margin-left":""})}b.isUndefined(c)||!0!==c?tdcOperationUI.showPlaceholder():tdcOperationUI.hidePlaceholder()}},getElementCssClass:function(){return tdcRowUI._elementCssClass}}})(jQuery,Backbone,_);var tdcColumnUI;
(function(f,e,b,d){tdcColumnUI={_elementCssClass:"tdc-column",tdcColumn:d,init:function(a){b.isUndefined(a)&&(a=tdcOperationUI.iframeContents);tdcColumnUI.tdcColumn=a.find("."+tdcColumnUI._elementCssClass);tdcColumnUI.tdcColumn.each(function(a,b){tdcColumnUI.bindColumn(f(b))})},_mouseCoordinates:d,_setMouseCoordinates:function(a){tdcColumnUI._mouseCoordinates=a},_getMouseCoordinates:function(){return tdcColumnUI._mouseCoordinates},bindColumn:function(a){a.unbind();a.click(function(a){a.preventDefault();
a.stopPropagation()}).mousedown(function(c){1===c.which&&(c.preventDefault(),c.stopPropagation(),tdcOperationUI.activeDraggedElement(f(this)),tdcOperationUI.hideHelper(),tdcOperationUI.setCurrentElementOver(a),tdcColumnUI.positionColumnPlaceholder(c,!0),tdcSidebar.setSettings({$currentRow:tdcOperationUI.inRow(a),$currentColumn:tdcOperationUI.inColumn(a)}),tdcColumnUI._setMouseCoordinates({screenX:c.screenX,screenY:c.screenY}),tdcOperationUI.setReadyToMove())}).mouseup(function(c){tdcOperationUI.isColumnDragged(a)&&
(c.preventDefault(),tdcOperationUI.clearReadyToMove(),tdcOperationUI.deactiveDraggedElement(),tdcOperationUI.hideHelper(),tdcOperationUI.setCurrentElementOver(d),tdcColumnUI.positionColumnPlaceholder(c),tdcColumnUI._setMouseCoordinates(d));tdcMaskUI.setContentAtMouseUp(a)}).mousemove(function(c){tdcOperationUI.isColumnDragged(a)&&(b.isEqual({screenX:c.screenX,screenY:c.screenY},tdcColumnUI._getMouseCoordinates())?(c.stopPropagation(),tdcOperationUI.hideHelper()):(c.preventDefault(),c.stopPropagation(),
tdcOperationUI.showHelper(c),tdcOperationUI.setCurrentElementOver(a),tdcColumnUI.positionColumnPlaceholder(c),tdcMaskUI.hide(),tdcColumnUI._setMouseCoordinates(d),tdcOperationUI.clearReadyToMove()))}).mouseenter(function(c){tdcOperationUI.isColumnDragged(a)?(c.preventDefault(),tdcOperationUI.setCurrentElementOver(a),tdcColumnUI.positionColumnPlaceholder(c)):b.isUndefined(tdcOperationUI.getDraggedElement())&&(tdcMaskUI.setCurrentContainer(a),c.stopPropagation())}).mouseleave(function(c){tdcOperationUI.isColumnDragged(a)?
(c.preventDefault(),tdcOperationUI.setCurrentElementOver(d),tdcColumnUI.positionColumnPlaceholder(c)):(tdcMaskUI.setCurrentContainer(d),c=tdcOperationUI.inRow(a),b.isUndefined(c)||c.mouseenter())}).on("fakemouseenterevent",function(c){if(tdcOperationUI.isColumnDragged(a)){var b=a.find(".tdc-elements:first");if(b.length){var d=b.outerHeight(!0),b=b.outerWidth(),k=a.offset(),e=0,h=a.prevAll("."+tdcColumnUI._elementCssClass);h.length&&h.each(function(a,c){e+=parseInt(f(c).find(".tdc-elements:first").width())});
e+=k.left;parseInt(e)<=parseInt(c.pageX)&&parseInt(c.pageX)<=parseInt(e+b)&&parseInt(k.top)<=parseInt(c.pageY)&&parseInt(c.pageY)<=parseInt(k.top+d)&&(tdcOperationUI.setCurrentElementOver(a),tdcColumnUI.positionColumnPlaceholder(c))}}})},positionColumnPlaceholder:function(a,c){var g,l=tdcAdminWrapperUI.$placeholder,k=g=0;if("mousedown"===a.type||"mousemove"===a.type||"fakemouseenterevent"===a.type)g=a.pageX,k=a.pageY,b.isUndefined(a.clientX)||b.isUndefined(a.clientY)||(window.previousMouseClientX=
a.clientX,window.previousMouseClientY=a.clientY);else if("scroll"===a.type){g=tdcOperationUI.iframeContents.scrollLeft()+window.previousMouseClientX;var k=tdcOperationUI.iframeContents.scrollTop()+window.previousMouseClientY,e={pageX:g,pageY:k};tdcOperationUI.setCurrentElementOver(d);tdcOperationUI.getDraggedElement().closest(".tdc-columns").find(".tdc-column").each(function(a,c){b.isUndefined(tdcOperationUI.getCurrentElementOver())&&f(c).trigger(f.Event("fakemouseenterevent",e))});return}k=tdcOperationUI.getCurrentElementOver();
if(b.isUndefined(tdcOperationUI.getDraggedElement())||b.isUndefined(k))tdcOperationUI.hidePlaceholder();else{var h=k.find(".vc_column_container:first").outerWidth(!0),m=tdcOperationUI.getCurrentElementOverOffset(),n=0,p=k.prevAll();p.length&&p.each(function(a,c){var b=f(c);b.hasClass("tdc-column")&&(n+=parseInt(b.find(".vc_column_container:first").outerWidth(!0)))});var p=k.parent(".tdc-columns").parent(".vc_row"),u=p.css("position");if(b.isUndefined(u)||"static"!==u)if(p=p.css("padding-left"),b.isUndefined(p)||
(p=parseInt(p.replace("px",""))),g>n+m.left+h/2){g=k.next();if(!g.length||g.length&&g.attr("id")!==tdcAdminWrapperUI.placeholderId)k.after(l),tdcOperationUI.updateInfoHelper();tdcOperationUI.setVerticalPlaceholder({left:parseInt(n+h+p),"margin-left":-24})}else{g=k.prev();if(!g.length||g.length&&g.attr("id")!==tdcAdminWrapperUI.placeholderId)k.before(l),tdcOperationUI.updateInfoHelper();tdcOperationUI.setVerticalPlaceholder({left:parseInt(n+p),"margin-left":-24})}else if(n+=m.left,g>n+h/2){g=k.next();
if(!g.length||g.length&&g.attr("id")!==tdcAdminWrapperUI.placeholderId)k.after(l),tdcOperationUI.updateInfoHelper();tdcOperationUI.setVerticalPlaceholder({left:parseInt(n+h),"margin-left":-24})}else{g=k.prev();if(!g.length||g.length&&g.attr("id")!==tdcAdminWrapperUI.placeholderId)k.before(l),tdcOperationUI.updateInfoHelper();tdcOperationUI.setVerticalPlaceholder({left:parseInt(n),"margin-left":-24})}b.isUndefined(c)||!0!==c?tdcOperationUI.showPlaceholder():tdcOperationUI.hidePlaceholder()}},getElementCssClass:function(){return tdcColumnUI._elementCssClass}}})(jQuery,
Backbone,_);var tdcInnerRowUI;
(function(f,e,b,d){tdcInnerRowUI={_elementCssClass:"tdc-element-inner-row",tdcElementInnerRow:d,init:function(a){b.isUndefined(a)&&(a=tdcOperationUI.iframeContents);tdcInnerRowUI.tdcElementInnerRow=a.find(".tdc-element-inner-row");tdcInnerRowUI.tdcElementInnerRow.each(function(a,b){tdcInnerRowUI.bindInnerRow(f(b))})},_mouseCoordinates:d,_setMouseCoordinates:function(a){tdcInnerRowUI._mouseCoordinates=a},_getMouseCoordinates:function(){return tdcInnerRowUI._mouseCoordinates},bindInnerRow:function(a){a.unbind();
a.click(function(a){a.preventDefault();a.stopPropagation()}).mousedown(function(c){1===c.which&&(c.preventDefault(),c.stopPropagation(),tdcOperationUI.activeDraggedElement(f(this)),tdcOperationUI.hideHelper(),tdcOperationUI.setCurrentElementOver(a),tdcInnerRowUI.positionInnerRowPlaceholder(c,!0),tdcSidebar.setSettings({$currentRow:tdcOperationUI.inRow(a),$currentColumn:tdcOperationUI.inColumn(a),$currentInnerRow:tdcOperationUI.inInnerRow(a)}),tdcInnerRowUI._setMouseCoordinates({screenX:c.screenX,
screenY:c.screenY}),tdcOperationUI.setReadyToMove())}).mouseup(function(c){c.preventDefault();tdcOperationUI.clearReadyToMove();tdcOperationUI.deactiveDraggedElement();tdcOperationUI.hideHelper();tdcMaskUI.setContentAtMouseUp(a)}).mousemove(function(c){if(tdcOperationUI.isElementDragged()||tdcOperationUI.isInnerRowDragged()||tdcOperationUI.isTempInnerRowDragged())b.isEqual({screenX:c.screenX,screenY:c.screenY},tdcInnerRowUI._getMouseCoordinates())?(c.stopPropagation(),tdcOperationUI.hideHelper()):
(c.preventDefault(),c.stopPropagation(),tdcOperationUI.showHelper(c),tdcOperationUI.setCurrentElementOver(a),tdcInnerRowUI.positionInnerRowPlaceholder(c),tdcMaskUI.hide(),tdcInnerRowUI._setMouseCoordinates(d),tdcOperationUI.clearReadyToMove())}).mouseenter(function(c){tdcOperationUI.isElementDragged()||tdcOperationUI.isInnerRowDragged()||tdcOperationUI.isTempInnerRowDragged()?(c.preventDefault(),tdcOperationUI.setCurrentElementOver(a),tdcInnerRowUI.positionInnerRowPlaceholder(c)):b.isUndefined(tdcOperationUI.getDraggedElement())&&
(tdcMaskUI.setCurrentContainer(a),c.stopPropagation())}).mouseleave(function(c){tdcOperationUI.isElementDragged()||tdcOperationUI.isInnerRowDragged()||tdcOperationUI.isTempInnerRowDragged()?(c.preventDefault(),tdcOperationUI.setCurrentElementOver(d),tdcInnerRowUI.positionInnerRowPlaceholder(c)):(tdcMaskUI.setCurrentContainer(d),c=tdcOperationUI.inColumn(a),b.isUndefined(c)||c.mouseenter())}).on("fakemouseenterevent",function(c){if(tdcOperationUI.isElementDragged()||tdcOperationUI.isInnerRowDragged()||
tdcOperationUI.isTempInnerRowDragged()){var b=a.outerHeight(!0),d=a.outerWidth(),k=a.offset();parseInt(k.left)<=parseInt(c.pageX)&&parseInt(c.pageX)<=parseInt(k.left+d)&&parseInt(k.top)<=parseInt(c.pageY)&&parseInt(c.pageY)<=parseInt(k.top+b)&&(tdcOperationUI.setCurrentElementOver(a),tdcInnerRowUI.positionInnerRowPlaceholder(c))}})},positionInnerRowPlaceholder:function(a,c){var g=tdcAdminWrapperUI.$placeholder,l=0,k=0;if("mousedown"===a.type||"mousemove"===a.type||"fakemouseenterevent"===a.type)l=
a.pageX,k=a.pageY,b.isUndefined(a.clientX)||b.isUndefined(a.clientY)||(window.previousMouseClientX=a.clientX,window.previousMouseClientY=a.clientY);else if("scroll"===a.type){var l=tdcOperationUI.iframeContents.scrollLeft()+window.previousMouseClientX,k=tdcOperationUI.iframeContents.scrollTop()+window.previousMouseClientY,e={pageX:l,pageY:k};tdcOperationUI.setCurrentElementOver(d);tdcElementUI.tdcElement.each(function(a,c){b.isUndefined(tdcOperationUI.getCurrentElementOver())&&f(c).trigger(f.Event("fakemouseenterevent",
e))});tdcInnerRowUI.tdcElementInnerRow.each(function(a,c){b.isUndefined(tdcOperationUI.getCurrentElementOver())&&f(c).trigger(f.Event("fakemouseenterevent",e))});return}l=tdcOperationUI.getCurrentElementOver();if(b.isUndefined(tdcOperationUI.getDraggedElement())||b.isUndefined(l))tdcOperationUI.hidePlaceholder();else{var h=l.outerHeight(!0),m=l.innerWidth(),n=l.offset();if(k>n.top+h/2){k=l.next();if(!k.length||k.length&&k.attr("id")!==tdcAdminWrapperUI.placeholderId)l.after(g),tdcOperationUI.updateInfoHelper(d);
parseInt(n.top)+parseInt(h)>parseInt(tdcOperationUI.iframeContents.scrollTop())+parseInt(window.innerHeight)?tdcOperationUI.setHorizontalPlaceholder({position:"fixed",top:"",left:"","margin-top":"","margin-left":"",bottom:"0",width:m}):tdcOperationUI.setHorizontalPlaceholder({position:"absolute",top:"",left:"","margin-top":"","margin-left":"",bottom:"",width:m})}else{k=l.prev();if(!k.length||k.length&&k.attr("id")!==tdcAdminWrapperUI.placeholderId)l.before(g),tdcOperationUI.updateInfoHelper(d);parseInt(n.top)<
parseInt(tdcOperationUI.iframeContents.scrollTop())?tdcOperationUI.setHorizontalPlaceholder({position:"fixed",top:"0",left:"","margin-top":"0","margin-left":"",bottom:"",width:m}):tdcOperationUI.setHorizontalPlaceholder({position:"absolute",top:"",left:"","margin-top":"","margin-left":"",bottom:"",width:m})}b.isUndefined(c)||!0!==c?tdcOperationUI.showPlaceholder():tdcOperationUI.hidePlaceholder()}},getElementCssClass:function(){return tdcInnerRowUI._elementCssClass}}})(jQuery,Backbone,_);var tdcInnerColumnUI;
(function(f,e,b,d){tdcInnerColumnUI={_elementCssClass:"tdc-inner-column",tdcInnerColumn:d,init:function(a){b.isUndefined(a)&&(a=tdcOperationUI.iframeContents);tdcInnerColumnUI.tdcInnerColumn=a.find("."+tdcInnerColumnUI._elementCssClass);tdcInnerColumnUI.tdcInnerColumn.each(function(a,b){tdcInnerColumnUI.bindInnerColumn(f(b))})},_mouseCoordinates:d,_setMouseCoordinates:function(a){tdcInnerColumnUI._mouseCoordinates=a},_getMouseCoordinates:function(){return tdcInnerColumnUI._mouseCoordinates},bindInnerColumn:function(a){a.unbind();
a.click(function(a){a.preventDefault();a.stopPropagation()}).mousedown(function(c){1===c.which&&(c.preventDefault(),c.stopPropagation(),tdcOperationUI.activeDraggedElement(f(this)),tdcOperationUI.hideHelper(),tdcOperationUI.setCurrentElementOver(a),tdcInnerColumnUI.positionInnerColumnPlaceholder(c,!0),tdcSidebar.setSettings({$currentRow:tdcOperationUI.inRow(a),$currentColumn:tdcOperationUI.inColumn(a),$currentInnerRow:tdcOperationUI.inInnerRow(a),$currentInnerColumn:tdcOperationUI.inInnerColumn(a)}),
tdcInnerColumnUI._setMouseCoordinates({screenX:c.screenX,screenY:c.screenY}),tdcOperationUI.setReadyToMove())}).mouseup(function(c){tdcOperationUI.isInnerColumnDragged(a)&&(c.preventDefault(),tdcOperationUI.clearReadyToMove(),tdcOperationUI.deactiveDraggedElement(),tdcOperationUI.hideHelper(),tdcOperationUI.setCurrentElementOver(d),tdcInnerColumnUI.positionInnerColumnPlaceholder(c),tdcInnerColumnUI._setMouseCoordinates(d));tdcMaskUI.setContentAtMouseUp(a)}).mousemove(function(c){tdcOperationUI.isInnerColumnDragged(a)&&
(b.isEqual({screenX:c.screenX,screenY:c.screenY},tdcInnerColumnUI._getMouseCoordinates())?(c.stopPropagation(),tdcOperationUI.hideHelper()):(c.preventDefault(),c.stopPropagation(),tdcOperationUI.showHelper(c),tdcOperationUI.setCurrentElementOver(a),tdcInnerColumnUI.positionInnerColumnPlaceholder(c),tdcMaskUI.hide(),tdcInnerColumnUI._setMouseCoordinates(d),tdcOperationUI.clearReadyToMove()))}).mouseenter(function(c){tdcOperationUI.isInnerColumnDragged(a)?(c.preventDefault(),tdcOperationUI.setCurrentElementOver(a),
tdcInnerColumnUI.positionInnerColumnPlaceholder(c)):b.isUndefined(tdcOperationUI.getDraggedElement())&&(tdcMaskUI.setCurrentContainer(a),c.stopPropagation())}).mouseleave(function(c){tdcOperationUI.isInnerColumnDragged(a)?(c.preventDefault(),tdcOperationUI.setCurrentElementOver(d),tdcInnerColumnUI.positionInnerColumnPlaceholder(c)):(tdcMaskUI.setCurrentContainer(d),c=tdcOperationUI.inInnerRow(a),b.isUndefined(c)||c.mouseenter())}).on("fakemouseenterevent",function(c){if(tdcOperationUI.isInnerColumnDragged(a)){var b=
a.find(".tdc-elements:first");if(b.length){var d=b.outerHeight(!0),b=b.outerWidth(),k=a.offset(),e=0,h=a.prevAll("."+tdcInnerColumnUI._elementCssClass);h.length&&h.each(function(a,c){e+=parseInt(f(c).find(".tdc-elements:first").width())});e+=k.left;parseInt(e)<=parseInt(c.pageX)&&parseInt(c.pageX)<=parseInt(e+b)&&parseInt(k.top)<=parseInt(c.pageY)&&parseInt(c.pageY)<=parseInt(k.top+d)&&(tdcOperationUI.setCurrentElementOver(a),tdcInnerColumnUI.positionInnerColumnPlaceholder(c))}}})},positionInnerColumnPlaceholder:function(a,
c){var g=tdcAdminWrapperUI.$placeholder,l=0,k=0;if("mousedown"===a.type||"mousemove"===a.type||"fakemouseenterevent"===a.type)l=a.pageX,k=a.pageY,b.isUndefined(a.clientX)||b.isUndefined(a.clientY)||(window.previousMouseClientX=a.clientX,window.previousMouseClientY=a.clientY);else if("scroll"===a.type){var l=tdcOperationUI.iframeContents.scrollLeft()+window.previousMouseClientX,k=tdcOperationUI.iframeContents.scrollTop()+window.previousMouseClientY,e={pageX:l,pageY:k};tdcOperationUI.setCurrentElementOver(d);
tdcOperationUI.getDraggedElement().closest(".tdc-inner-columns").find(".tdc-inner-column").each(function(a,c){b.isUndefined(tdcOperationUI.getCurrentElementOver())&&f(c).trigger(f.Event("fakemouseenterevent",e))});return}k=tdcOperationUI.getCurrentElementOver();if(b.isUndefined(tdcOperationUI.getDraggedElement())||b.isUndefined(k))tdcOperationUI.hidePlaceholder();else{var h=k.find(".vc_column_container:first").outerWidth(!0),m=k.offset(),n=0,p=k.prevAll();p.length&&p.each(function(a,c){var b=f(c);
b.hasClass("tdc-inner-column")&&(n+=parseInt(b.find(".vc_column_container:first").outerWidth(!0)))});p=k.parent(".tdc-inner-columns").parent(".vc_row_inner").css("padding-left");p=b.isUndefined(p)?0:parseInt(p.replace("px",""));if(l>n+m.left+h/2){l=k.next();if(!l.length||l.length&&l.attr("id")!==tdcAdminWrapperUI.placeholderId)k.after(g),tdcOperationUI.updateInfoHelper();tdcOperationUI.setVerticalPlaceholder({left:parseInt(n+h+p),"margin-left":-24})}else{l=k.prev();if(!l.length||l.length&&l.attr("id")!==
tdcAdminWrapperUI.placeholderId)k.before(g),tdcOperationUI.updateInfoHelper();tdcOperationUI.setVerticalPlaceholder({left:parseInt(n+p),"margin-left":-24})}b.isUndefined(c)||!0!==c?tdcOperationUI.showPlaceholder():tdcOperationUI.hidePlaceholder()}},getElementCssClass:function(){return tdcInnerColumnUI._elementCssClass}}})(jQuery,Backbone,_);var tdcElementsUI;
(function(f,e,b,d){tdcElementsUI={tdcElements:d,init:function(){tdcElementsUI.tdcElements=tdcOperationUI.iframeContents.find(".tdc-elements");tdcElementsUI.tdcElements.each(function(a,c){tdcElementsUI.bindElementList(f(c))})},bindElementList:function(a){a.mousemove(function(a){a.preventDefault()}).mouseenter(function(a){a.preventDefault()}).mouseleave(function(a){a.preventDefault()})}}})(jQuery,Backbone,_);var tdcElementUI;
(function(f,e,b,d){tdcElementUI={_elementCssClass:"tdc-element",_innerColumnGap:10,tdcElements:d,init:function(a){b.isUndefined(a)&&(a=tdcOperationUI.iframeContents);tdcElementUI.tdcElement=a.find(".tdc-element");tdcElementUI.tdcElement.each(function(a,b){tdcElementUI.bindElement(f(b))})},positionElementPlaceholder:function(a,c){var g=tdcAdminWrapperUI.$placeholder,l=0,k=0;if("mousedown"===a.type||"mousemove"===a.type||"fakemouseenterevent"===a.type)l=a.pageX,k=a.pageY,b.isUndefined(a.clientX)||b.isUndefined(a.clientY)||
(window.previousMouseClientX=a.clientX,window.previousMouseClientY=a.clientY);else if("scroll"===a.type){var l=tdcOperationUI.iframeContents.scrollLeft()+window.previousMouseClientX,k=tdcOperationUI.iframeContents.scrollTop()+window.previousMouseClientY,e={pageX:l,pageY:k};tdcOperationUI.setCurrentElementOver(d);tdcElementUI.tdcElement.each(function(a,c){b.isUndefined(tdcOperationUI.getCurrentElementOver())&&f(c).trigger(f.Event("fakemouseenterevent",e))});return}var h=tdcOperationUI.getCurrentElementOver();
if(b.isUndefined(tdcOperationUI.getDraggedElement())||b.isUndefined(h))tdcOperationUI.hidePlaceholder();else{var m=tdcOperationUI.getCurrentElementOverOuterHeight(),l=tdcOperationUI.getCurrentElementOverOuterWidth(),n=tdcOperationUI.getCurrentElementOverOffset();if(k>n.top+m/2){var p=!1;tdcElementUI.isInnerColumnLastElement(h)&&k>n.top+m-tdcElementUI._innerColumnGap&&(p=!0);p&&(h=h.closest(".tdc-element-inner-row"),l=h.outerWidth(!0));k=h.next();if(!k.length||k.length&&k.attr("id")!==tdcAdminWrapperUI.placeholderId)h.after(g),
tdcOperationUI.updateInfoHelper(d);parseInt(n.top)+parseInt(m)>parseInt(tdcOperationUI.iframeContents.scrollTop())+parseInt(window.innerHeight)?tdcOperationUI.setHorizontalPlaceholder({position:"fixed",top:"",left:"","margin-top":"","margin-left":"",bottom:"0",width:l}):tdcOperationUI.setHorizontalPlaceholder({position:"absolute",top:"",left:"","margin-top":"","margin-left":"",bottom:"",width:l})}else{m=!1;tdcElementUI.isInnerColumnFirstElement(h)&&k<n.top+tdcElementUI._innerColumnGap&&(m=!0);m&&
(h=h.closest(".tdc-element-inner-row"),l=h.outerWidth(!0));k=h.prev();if(!k.length||k.length&&k.attr("id")!==tdcAdminWrapperUI.placeholderId)h.before(g),tdcOperationUI.updateInfoHelper(d);parseInt(n.top)<parseInt(tdcOperationUI.iframeContents.scrollTop())?tdcOperationUI.setHorizontalPlaceholder({position:"fixed",top:"0",left:"","margin-top":"0","margin-left":"",bottom:"",width:l}):tdcOperationUI.setHorizontalPlaceholder({position:"absolute",top:"",left:"","margin-top":"","margin-left":"",bottom:"",
width:l})}b.isUndefined(c)||!0!==c?tdcOperationUI.showPlaceholder():tdcOperationUI.hidePlaceholder()}},positionEmptyElementPlaceholder:function(a){var c=tdcAdminWrapperUI.$placeholder,g=0;var l=0;if("mousedown"===a.type||"mousemove"===a.type||"fakemouseenterevent"===a.type)g=a.pageX,l=a.pageY,b.isUndefined(a.clientX)||b.isUndefined(a.clientY)||(window.previousMouseClientX=a.clientX,window.previousMouseClientY=a.clientY);else if("scroll"===a.type){g=tdcOperationUI.iframeContents.scrollLeft()+window.previousMouseClientX;
l=tdcOperationUI.iframeContents.scrollTop()+window.previousMouseClientY;var k={pageX:g,pageY:l};tdcOperationUI.setCurrentElementOver(d);tdcElementUI.tdcElement.each(function(a,c){b.isUndefined(tdcOperationUI.getCurrentElementOver())&&f(c).trigger(f.Event("fakemouseenterevent",k))});return}var e=tdcOperationUI.getCurrentElementOver();if(b.isUndefined(tdcOperationUI.getDraggedElement())||b.isUndefined(e))tdcOperationUI.hidePlaceholder();else{var h=tdcOperationUI.getCurrentElementOverOuterHeight();a=
tdcOperationUI.getCurrentElementOverOuterWidth();g=tdcOperationUI.getCurrentElementOverOffset();if(l>g.top+h/2){var m=!1;tdcElementUI.isInnerColumnLastElement(e)&&l>g.top+h-tdcElementUI._innerColumnGap&&(m=!0);m?(l=e.closest(".tdc-element-inner-row"),a=l.outerWidth(!0),m=l.next(),m.length||(l.after(c),tdcOperationUI.updateInfoHelper(d))):(m=e.next(),m.length||(e.after(c),tdcOperationUI.updateInfoHelper(d)));parseInt(g.top)+parseInt(h)>parseInt(tdcOperationUI.iframeContents.scrollTop())+parseInt(window.innerHeight)?
tdcOperationUI.setHorizontalPlaceholder({position:"fixed",top:"",left:"","margin-top":"","margin-left":"",bottom:0,width:a}):tdcOperationUI.setHorizontalPlaceholder({position:"absolute",top:"",left:"","margin-top":-50,"margin-left":"",bottom:"",width:a})}else h=!1,tdcElementUI.isInnerColumnFirstElement(e)&&l<g.top+tdcElementUI._innerColumnGap&&(h=!0),h?(l=e.closest(".tdc-element-inner-row"),a=l.outerWidth(!0),h=l.prev(),h.length||(l.before(c),tdcOperationUI.updateInfoHelper(d))):(h=e.prev(),h.length||
(e.before(c),tdcOperationUI.updateInfoHelper(d))),parseInt(g.top)<parseInt(tdcOperationUI.iframeContents.scrollTop())?tdcOperationUI.setHorizontalPlaceholder({position:"fixed",top:0,left:"","margin-top":0,"margin-left":"",bottom:"",width:a}):tdcOperationUI.setHorizontalPlaceholder({position:"absolute",top:"",left:"","margin-top":0,"margin-left":"",bottom:"",width:a});tdcOperationUI.showPlaceholder()}},_mouseCoordinates:d,_setMouseCoordinates:function(a){tdcElementUI._mouseCoordinates=a},_getMouseCoordinates:function(){return tdcElementUI._mouseCoordinates},
bindElement:function(a){a.click(function(a){a.preventDefault();a.stopPropagation()}).mousedown(function(c){tdcDebug.log("element mouse down");1===c.which&&(c.preventDefault(),c.stopPropagation(),tdcOperationUI.activeDraggedElement(a),tdcOperationUI.hideHelper(),tdcOperationUI.setCurrentElementOver(a),tdcElementUI.positionElementPlaceholder(c,!0),tdcSidebar.setSettings({$currentRow:tdcOperationUI.inRow(a),$currentColumn:tdcOperationUI.inColumn(a),$currentInnerRow:tdcOperationUI.inInnerRow(a),$currentInnerColumn:tdcOperationUI.inInnerColumn(a),
$currentElement:a}),tdcElementUI._setMouseCoordinates({screenX:c.screenX,screenY:c.screenY}),tdcOperationUI.setReadyToMove())}).mouseup(function(c){if(tdcOperationUI.isElementDragged()||(tdcOperationUI.isInnerRowDragged()||tdcOperationUI.isTempInnerRowDragged())&&a.hasClass("tdc-element-column"))c.preventDefault(),tdcOperationUI.clearReadyToMove(),tdcOperationUI.deactiveDraggedElement(),tdcOperationUI.hideHelper(),tdcElementUI.positionElementPlaceholder(c),tdcElementUI._setMouseCoordinates(d);tdcMaskUI.setContentAtMouseUp(a)}).mousemove(function(c){if(tdcOperationUI.isElementDragged()||
(tdcOperationUI.isInnerRowDragged()||tdcOperationUI.isTempInnerRowDragged())&&a.hasClass("tdc-element-column"))b.isEqual({screenX:c.screenX,screenY:c.screenY},tdcElementUI._getMouseCoordinates())?(c.stopPropagation(),tdcOperationUI.hideHelper()):(c.preventDefault(),c.stopPropagation(),tdcOperationUI.showHelper(c),tdcOperationUI.setCurrentElementOver(a),tdcElementUI.positionElementPlaceholder(c),tdcMaskUI.hide(),tdcElementUI._setMouseCoordinates(d),tdcOperationUI.clearReadyToMove())}).mouseenter(function(c){tdcOperationUI.isElementDragged()||
(tdcOperationUI.isInnerRowDragged()||tdcOperationUI.isTempInnerRowDragged())&&a.hasClass("tdc-element-column")?(c.preventDefault(),tdcOperationUI.setCurrentElementOver(a),tdcElementUI.positionElementPlaceholder(c)):b.isUndefined(tdcOperationUI.getDraggedElement())&&(tdcMaskUI.setCurrentElement(a),c.stopPropagation())}).mouseleave(function(c){tdcOperationUI.isElementDragged()||(tdcOperationUI.isInnerRowDragged()||tdcOperationUI.isTempInnerRowDragged())&&a.hasClass("tdc-element-column")?(c.preventDefault(),
tdcOperationUI.setCurrentElementOver(d),tdcElementUI.positionElementPlaceholder(c)):b.isUndefined(tdcOperationUI.getDraggedElement())&&(tdcMaskUI.setCurrentElement(d),tdcMaskUI.setCurrentContainer(d),c=tdcOperationUI.inInnerColumn(a),b.isUndefined(c)?(c=tdcOperationUI.inColumn(a),b.isUndefined(c)||c.mouseenter()):c.mouseenter())}).on("fakemouseenterevent",function(c){if(tdcOperationUI.isElementDragged()||(tdcOperationUI.isInnerRowDragged()||tdcOperationUI.isTempInnerRowDragged())&&a.hasClass("tdc-element-column")){c.preventDefault();
c.stopPropagation();var b=a.outerHeight(!0),d=a.outerWidth(),k=a.offset();parseInt(k.left)<=parseInt(c.pageX)&&parseInt(c.pageX)<=parseInt(k.left+d)&&parseInt(k.top)<=parseInt(c.pageY)&&parseInt(c.pageY)<=parseInt(k.top+b)&&(tdcOperationUI.setCurrentElementOver(a),tdcElementUI.positionElementPlaceholder(c))}})},bindEmptyElement:function(a){a.click(function(a){a.preventDefault()}).mousedown(function(c){1===c.which&&(a.hasClass("tdc-element-column")?tdcColumnHandlerUI._triggerEvent(c):a.hasClass("tdc-element-inner-column")&&
tdcInnerColumnHandlerUI._triggerEvent(c))}).mouseup(function(c){tdcOperationUI.isElementDragged()||(tdcOperationUI.isInnerRowDragged()||tdcOperationUI.isTempInnerRowDragged())&&a.hasClass("tdc-element-column")?(c.preventDefault(),c.stopPropagation(),tdcOperationUI.deactiveDraggedElement(),tdcOperationUI.hideHelper(),tdcElementUI.positionEmptyElementPlaceholder(c)):tdcMaskUI.setCurrentElement(a)}).mousemove(function(c){if(tdcOperationUI.isElementDragged()||(tdcOperationUI.isInnerRowDragged()||tdcOperationUI.isTempInnerRowDragged())&&
a.hasClass("tdc-element-column"))c.preventDefault(),c.stopPropagation(),tdcOperationUI.showHelper(c),tdcOperationUI.setCurrentElementOver(a),tdcElementUI.positionEmptyElementPlaceholder(c)}).mouseenter(function(c){tdcOperationUI.isElementDragged()||(tdcOperationUI.isInnerRowDragged()||tdcOperationUI.isTempInnerRowDragged())&&a.hasClass("tdc-element-column")?(c.preventDefault(),tdcOperationUI.setCurrentElementOver(a),tdcElementUI.positionEmptyElementPlaceholder(c)):b.isUndefined(tdcOperationUI.getDraggedElement())&&
tdcMaskUI.setCurrentElement(a)}).mouseleave(function(c){tdcOperationUI.isElementDragged()||(tdcOperationUI.isInnerRowDragged()||tdcOperationUI.isTempInnerRowDragged())&&a.hasClass("tdc-element-column")?(c.preventDefault(),tdcOperationUI.setCurrentElementOver(d),tdcElementUI.positionEmptyElementPlaceholder(c)):b.isUndefined(tdcOperationUI.getDraggedElement())&&tdcMaskUI.setCurrentElement(d)})},isInnerColumnFirstElement:function(a){var c=a.closest(".tdc-inner-column");return c.length&&(c=c.find(".tdc-element-inner-column"),
c.length&&0===c.index(a))?!0:!1},isInnerColumnLastElement:function(a){var c=a.closest(".tdc-inner-column");return c.length&&(c=c.find(".tdc-element-inner-column"),c.length&&c.length===c.index(a)+1)?!0:!1},getElementCssClass:function(){return tdcElementUI._elementCssClass}}})(jQuery,Backbone,_);var tdcRecycleUI;
(function(f,e,b,d){tdcRecycleUI={_activeClass:"active",_showClass:"show",_isInitialized:!1,init:function(a){b.isUndefined(a)||!0!==a||(tdcRecycleUI._isInitialized=!1);tdcRecycleUI._isInitialized||(tdcAdminWrapperUI.$recycle.mouseup(function(a){(tdcOperationUI.isElementDragged()||tdcOperationUI.isInnerRowDragged()||tdcOperationUI.isRowDragged())&&!tdcOperationUI.isSidebarElementDragged()&&(a.preventDefault(),tdcOperationUI.deactiveDraggedElement(),tdcRecycleUI._deactivate())}).mouseenter(function(a){(tdcOperationUI.isElementDragged()||
tdcOperationUI.isInnerRowDragged()||tdcOperationUI.isRowDragged())&&!tdcOperationUI.isSidebarElementDragged()&&(a.preventDefault(),tdcOperationUI.setCurrentElementOver(tdcAdminWrapperUI.$recycle),tdcRecycleUI._activate())}).mouseleave(function(a){(tdcOperationUI.isElementDragged()||tdcOperationUI.isInnerRowDragged()||tdcOperationUI.isRowDragged())&&!tdcOperationUI.isSidebarElementDragged()&&(a.preventDefault(),tdcOperationUI.setCurrentElementOver(d),tdcRecycleUI._deactivate())}),tdcRecycleUI._isInitialized=
!0)},_activate:function(){tdcAdminWrapperUI.$recycle.addClass(tdcRecycleUI._activeClass)},_deactivate:function(){tdcAdminWrapperUI.$recycle.removeClass(tdcRecycleUI._activeClass)},show:function(){!0!==tdcMain.getRecycleShown()&&(tdcMain.setRecycleShown(),!0===tdcMain.getRecycleShown()&&tdcAdminWrapperUI.$recycle.addClass(tdcRecycleUI._showClass))},hide:function(){!1!==tdcMain.getRecycleShown()&&(tdcMain.resetRecycleShown(),tdcAdminWrapperUI.$recycle.removeClass(tdcRecycleUI._showClass))}}})(jQuery,
Backbone,_);var tdcMaskUI;
(function(f,e,b,d){tdcMaskUI={$currentContainer:d,$currentElement:d,$wrapper:d,$content:d,_inMouseUpBubbling:!1,_isInitialized:!1,_handlers:d,contentSettings:{innerColumn:{top:0,left:0},innerRow:{top:0,left:0},column:{top:0,left:0},row:{top:0,left:0}},init:function(a,c){b.isUndefined(c)||!0!==c||(tdcMaskUI._isInitialized=!1);tdcMaskUI._isInitialized||(tdcMaskUI.$wrapper=a,tdcMaskUI.$content=f('<div id="tdc-mask-content"></div>'),tdcMaskUI.$handlerStructure=f('<div id="tdc-mask-handler-structure"></div>'),tdcMaskUI.$wrapper.after(tdcMaskUI.$content),
tdcMaskUI.$wrapper.append(tdcMaskUI.$handlerStructure),tdcRowHandlerUI.init(c),tdcColumnHandlerUI.init(c),tdcInnerRowHandlerUI.init(c),tdcInnerColumnHandlerUI.init(c),tdcElementHandlerUI.init(c),tdcMaskUI._isInitialized=!0)},setCurrentContainer:function(a){if(tdcMaskUI._isInitialized)if(tdcMaskUI.$currentContainer=a,b.isUndefined(tdcMaskUI.$currentContainer))tdcMaskUI.$content.css({top:"",left:"",width:"",height:""}),tdcMaskUI.$content.hide(),tdcSidebar.setSidebarInfo("");else{var c="";if(tdcOperationUI.isRow(tdcMaskUI.$currentContainer)){var d=
tdcMaskUI.$currentContainer;c="tdc-content-row"}else tdcOperationUI.isColumn(tdcMaskUI.$currentContainer)?(d=tdcMaskUI.$currentContainer.children(":first"),c="tdc-content-column"):tdcOperationUI.isInnerRow(tdcMaskUI.$currentContainer)?(d=tdcMaskUI.$currentContainer,c="tdc-content-inner-row"):tdcOperationUI.isInnerColumn(tdcMaskUI.$currentContainer)&&(d=tdcMaskUI.$currentContainer.children(":first"),c="tdc-content-inner-column");var l=d.offset();a=l.top;l=l.left;var k=d.outerWidth();d=d.outerHeight(!0);
tdcMaskUI.$content.css({top:a,left:l,width:k,height:d});tdcMaskUI.$content.attr("class",c);tdcMaskUI.$content.show();d=tdcMaskUI.$currentContainer.data("model_id");b.isUndefined(d)||(d=tdcIFrameData.getModel(d),tdcSidebar.setSidebarInfo(d.get("tag")));tdcElementHandlerUI.hide()}},setCurrentElement:function(a){if(tdcMaskUI._isInitialized)if(tdcMaskUI.$currentElement=a,b.isUndefined(tdcMaskUI.$currentElement))tdcMaskUI.$wrapper.hide(),tdcMaskUI.$content.hide();else{a=tdcMaskUI.$currentElement.offset();
var c=tdcMaskUI.$currentElement.outerWidth(),d=tdcMaskUI.$currentElement.outerHeight(!0);tdcMaskUI.$wrapper.css({top:a.top,left:a.left,width:c,height:d});tdcMaskUI.$content.css({top:a.top,left:a.left,width:c,height:d});tdcMaskUI.$content.removeAttr("class");tdcMaskUI.$wrapper.show();tdcMaskUI.$content.show();tdcMaskUI.setHandlers();a=tdcMaskUI.$currentElement.data("model_id");b.isUndefined(a)||(a=tdcIFrameData.getModel(a),c=a.get("attrs"),b.has(c,"custom_title")?tdcSidebar.setSidebarInfo(c.custom_title):
tdcSidebar.setSidebarInfo(a.get("tag")))}},repositionMask:function(a){tdcMaskUI._isInitialized&&(a=tdcAdminIFrameUI._$liveIframe[0].contentWindow.document.elementFromPoint(a.pageX,a.pageY),a=f(a).closest(".tdc-element"),a.length&&tdcMaskUI.setCurrentElement(a))},setContentAtMouseUp:function(a){a.hasClass("tdc-row")?tdcMaskUI._inMouseUpBubbling?tdcMaskUI._inMouseUpBubbling=!1:tdcMaskUI.setCurrentContainer(a):a.hasClass("tdc-column")?tdcMaskUI._inMouseUpBubbling||(tdcMaskUI._inMouseUpBubbling=!0,tdcMaskUI.setCurrentContainer(a)):
a.hasClass("tdc-element-inner-row")?tdcMaskUI._inMouseUpBubbling||(tdcMaskUI._inMouseUpBubbling=!0,tdcMaskUI.setCurrentContainer(a)):a.hasClass("tdc-inner-column")?tdcMaskUI._inMouseUpBubbling||(tdcMaskUI._inMouseUpBubbling=!0,tdcMaskUI.setCurrentContainer(a)):a.hasClass("tdc-element")&&(tdcMaskUI.setCurrentElement(a),tdcMaskUI._inMouseUpBubbling=!0)},setHandlers:function(){tdcMaskUI._isInitialized&&(b.isUndefined(tdcMaskUI.$currentElement)||b.isUndefined(tdcMaskUI._handlers)||b.map(tdcMaskUI._handlers,
function(a,c){a.setElement(tdcMaskUI.$currentElement)}))},addHandler:function(a,c){tdcMaskUI._isInitialized||(b.isUndefined(tdcMaskUI._handlers)?(tdcMaskUI._handlers={},tdcMaskUI._handlers[a]=c):b.has(tdcMaskUI._handlers,a)||(tdcMaskUI._handlers[a]=c))},show:function(){tdcMaskUI._isInitialized&&!b.isUndefined(tdcMaskUI.$wrapper)&&(tdcMaskUI.$wrapper.show(),tdcMaskUI.$content.show())},hide:function(){tdcMaskUI._isInitialized&&!b.isUndefined(tdcMaskUI.$wrapper)&&(tdcMaskUI.$wrapper.hide(),tdcMaskUI.$content.hide())}}})(jQuery,
Backbone,_);var tdcRowHandlerUI;
(function(f,e,b,d){tdcRowHandlerUI={_handlerId:"tdc-row",_handlerText:"Row",_handlerCssClass:"tdc-mask-row",$elementRow:d,_$handlerWrapper:d,_$handlerClone:d,_isInitialized:!1,init:function(a){b.isUndefined(a)||!0!==a||(tdcRowHandlerUI._isInitialized=!1);tdcRowHandlerUI._isInitialized||(tdcRowHandlerUI._$handlerWrapper=f('<div id="'+tdcRowHandlerUI._handlerCssClass+'"><div class="tdc-mask-arrow-vertical" title="Drag row vertically"></div><div class="tdc-mask-handler-drag" title="Row settings">'+tdcRowHandlerUI._handlerText+
"</div></div>"),tdcRowHandlerUI._$handlerClone=f('<div class="tdc-mask-clone" title="Duplicate row"></div>'),tdcRowHandlerUI._$handlerWrapper.append(tdcRowHandlerUI._$handlerClone),tdcMaskUI.$handlerStructure.append(tdcRowHandlerUI._$handlerWrapper),tdcRowHandlerUI._$handlerWrapper.mousedown(function(a){1===a.which&&tdcRowHandlerUI._triggerEvent(a)}).mouseup(function(a){tdcRowHandlerUI._triggerEvent(a)}).mousemove(function(a){tdcMaskUI.show();tdcRowHandlerUI._triggerEvent(a)}).mouseenter(function(a){a.preventDefault();
tdcMaskUI.setCurrentContainer(tdcRowHandlerUI.$elementRow);tdcMaskUI.show()}).mouseleave(function(a){a.preventDefault();tdcMaskUI.setCurrentContainer(d);tdcMaskUI.hide()}),tdcRowHandlerUI._$handlerClone.mousedown(tdcRowHandlerUI.cloneHandler),tdcMaskUI.addHandler(tdcRowHandlerUI._handlerId,tdcRowHandlerUI),tdcRowHandlerUI._isInitialized=!0)},setElement:function(a){a=tdcOperationUI.inRow(a);b.isUndefined(a)?tdcRowHandlerUI._$handlerWrapper.hide():(tdcRowHandlerUI.$elementRow=a,tdcRowHandlerUI._$handlerWrapper.show())},
_triggerEvent:function(a){b.isUndefined(a)||b.isUndefined(tdcRowHandlerUI.$elementRow)||tdcRowHandlerUI.$elementRow.trigger(a)},cloneHandler:function(a){1===a.which&&(a.preventDefault(),a.stopPropagation(),tdConfirm.showModal("Clone row",tdcRowHandlerUI,function(a){a=f(a.currentTarget);if(a.hasClass("tdc-sidebar-clone-row")){a=a.data("model_id");var c=tdcIFrameData.getModel(a).get("blockUid"),l=tdcAdminIFrameUI.getLiveIframe();tdcRowHandlerUI.$elementRow=l.contents().find("#"+c);tdcDebug.log(a);tdcDebug.log(c);
if(!tdcRowHandlerUI.$elementRow.length){tb_remove();return}tdcRowHandlerUI.$elementRow.data("model_id",a)}a=tdcRowHandlerUI.$elementRow.data("model_id");if(b.isUndefined(a))new tdcNotice.notice("tdcRowHandlerUI -> tdcRowHandlerUI._$handlerClone Error: Element model id is not in $draggedElement data!",!0,!1);else if(a=tdcIFrameData.getModel(a),b.isUndefined(a))new tdcNotice.notice("tdcRowHandlerUI -> tdcRowHandlerUI._$handlerClone Error: Element model not in structure data!",!0,!1);else{tdcOperationUI.setDraggedElement(f('<div class="tdc-row">Cloned row</div>'));
var k=tdcOperationUI.getDraggedElement();k.insertAfter(tdcRowHandlerUI.$elementRow);tdcRowUI.bindRow(k);var e=k.prevAll(".tdc-row").length,c=new tdcIFrameData.TdcModel({content:"",attrs:b.clone(a.get("attrs")),tag:"vc_row",type:"closed",level:0,parentModel:d});new tdcIFrameData.TdcLiveView({model:c,el:k[0]});l=new tdcIFrameData.TdcModel({content:"",attrs:{},tag:"vc_column",type:"closed",level:1,parentModel:c});k.data("model_id",c.cid);tdcIFrameData.tdcRows.add(c,{at:e});k=new tdcIFrameData.TdcCollection;
k.add(l);c.set("childCollection",k);k=new tdcIFrameData.TdcCollection;l.set("childCollection",k);c.getShortcodeRender(1,"",!0,a);tdcOperationUI.setDraggedElement(d);tb_remove()}},[a],"Are you sure you want to clone the current row and all its elements?"),tdcRowHandlerUI._inCloneOperation=!1)},deleteHandler:function(a){null!==a&&a.preventDefault();a.preventDefault();a.stopPropagation();tdConfirm.showModal("Delete row",tdcRowHandlerUI,function(a){a=f(a.currentTarget);if(a.hasClass("tdc-sidebar-delete-row")){a=
a.data("model_id");var c=tdcIFrameData.getModel(a).get("blockUid"),b=tdcAdminIFrameUI.getLiveIframe();tdcRowHandlerUI.$elementRow=b.contents().find("#"+c);tdcDebug.log(a);tdcDebug.log(c);if(!tdcRowHandlerUI.$elementRow.length){tb_remove();return}tdcRowHandlerUI.$elementRow.data("model_id",a)}tdcOperationUI.setDraggedElement(tdcRowHandlerUI.$elementRow);tdcOperationUI.setCurrentElementOver(tdcAdminWrapperUI.$recycle);a=tdcOperationUI.getDraggedElement();c=tdcAdminWrapperUI.$placeholder;a=a.closest(".tdc-elements");
b=a.children();c=b.index(c);if(-1===c&&1===b.length||2===b.length&&-1!==c)c="",tdcElementHandlerUI.$element.closest(".tdc-inner-column").length?c=" tdc-element-inner-column":tdcElementHandlerUI.$element.closest(".tdc-column").length&&(c=" tdc-element-column"),c=f('<div class="'+tdcOperationUI._emptyElementClass+c+'" title="Empty element that should be removed by composer"></div>'),tdcElementUI.bindEmptyElement(c),a.append(c);tdcIFrameData.changeData({wasSidebarElementDragged:!1,wasElementDragged:!1,
wasInnerColumnDragged:!1,wasInnerRowDragged:!1,wasTempInnerRowDragged:!1,wasColumnDragged:!1,wasRowDragged:!0,wasTempRowDragged:!1,draggedBlockUid:"",sourceColParam:null});tdcOperationUI.setDraggedElement(d);tdcOperationUI.setCurrentElementOver(d);tdcSidebarPanel.clearPanel();tb_remove()},[a],"Are you sure you want to delete the current row and all its elements?")}}})(jQuery,Backbone,_);var tdcColumnHandlerUI;
(function(f,e,b,d){tdcColumnHandlerUI={_handlerId:"tdc-column",_handlerText:"Column",_handlerCssClass:"tdc-mask-column",$elementColumn:d,_$handlerWrapper:d,_isInitialized:!1,init:function(a){b.isUndefined(a)||!0!==a||(tdcColumnHandlerUI._isInitialized=!1);tdcColumnHandlerUI._isInitialized||(a=f('<div id="'+tdcColumnHandlerUI._handlerCssClass+'"><div class="tdc-mask-arrow-horizontal" title="Drag column horizontally"></div><div class="tdc-mask-handler-drag" title="Column settings">'+tdcColumnHandlerUI._handlerText+
"</div></div>"),tdcColumnHandlerUI._$handlerWrapper=a,tdcMaskUI.$handlerStructure.append(a),tdcColumnHandlerUI._$handlerWrapper.mousedown(function(a){1===a.which&&tdcColumnHandlerUI._triggerEvent(a)}).mouseup(function(a){tdcColumnHandlerUI._triggerEvent(a)}).mousemove(function(a){tdcMaskUI.show();tdcColumnHandlerUI._triggerEvent(a)}).mouseenter(function(a){tdcMaskUI.show();tdcColumnHandlerUI._triggerEvent(a)}).mouseleave(function(a){tdcColumnHandlerUI._triggerEvent(a)}),tdcColumnHandlerUI._$handlerWrapper.mouseenter(function(a){a.preventDefault();
tdcMaskUI.setCurrentContainer(tdcColumnHandlerUI.$elementColumn);tdcMaskUI.show()}).mouseleave(function(a){a.preventDefault();tdcMaskUI.setCurrentContainer(d);tdcMaskUI.hide()}),tdcMaskUI.addHandler(tdcColumnHandlerUI._handlerId,tdcColumnHandlerUI),tdcColumnHandlerUI._isInitialized=!0)},setElement:function(a){a=tdcOperationUI.inColumn(a);b.isUndefined(a)?tdcColumnHandlerUI._$handlerWrapper.hide():(tdcColumnHandlerUI.$elementColumn=a,tdcColumnHandlerUI._$handlerWrapper.show())},_triggerEvent:function(a){b.isUndefined(a)||
b.isUndefined(tdcColumnHandlerUI.$elementColumn)||tdcColumnHandlerUI.$elementColumn.trigger(a)}}})(jQuery,Backbone,_);var tdcInnerRowHandlerUI;
(function(f,e,b,d){tdcInnerRowHandlerUI={_handlerId:"tdc-element-inner-row",_handlerText:"Inner Row",_handlerCssClass:"tdc-mask-inner-row",$elementInnerRow:d,_$handlerWrapper:d,_$handlerClone:d,_isInitialized:!1,init:function(a){b.isUndefined(a)||!0!==a||(tdcInnerRowHandlerUI._isInitialized=!1);tdcInnerRowHandlerUI._isInitialized||(tdcInnerRowHandlerUI._$handlerWrapper=f('<div id="'+tdcInnerRowHandlerUI._handlerCssClass+'"><div class="tdc-mask-arrow-vertical" title="Drag inner row"></div><div class="tdc-mask-handler-drag" title="Inner row settings">'+
tdcInnerRowHandlerUI._handlerText+"</div></div>"),tdcInnerRowHandlerUI._$handlerClone=f('<div class="tdc-mask-clone" title="Duplicate inner row"></div>'),tdcInnerRowHandlerUI._$handlerWrapper.append(tdcInnerRowHandlerUI._$handlerClone),tdcMaskUI.$handlerStructure.append(tdcInnerRowHandlerUI._$handlerWrapper),tdcInnerRowHandlerUI._$handlerWrapper.mousedown(function(a){1===a.which&&tdcInnerRowHandlerUI._triggerEvent(a)}).mouseup(function(a){tdcInnerRowHandlerUI._triggerEvent(a)}).mousemove(function(a){tdcMaskUI.show();
tdcInnerRowHandlerUI._triggerEvent(a)}).mouseenter(function(a){a.preventDefault();tdcMaskUI.setCurrentContainer(tdcInnerRowHandlerUI.$elementInnerRow);tdcMaskUI.show()}).mouseleave(function(a){a.preventDefault();tdcMaskUI.setCurrentContainer(d);tdcMaskUI.hide()}),tdcInnerRowHandlerUI._$handlerClone.mousedown(tdcInnerRowHandlerUI.cloneHandler),tdcMaskUI.addHandler(tdcInnerRowHandlerUI._handlerId,tdcInnerRowHandlerUI),tdcInnerRowHandlerUI._isInitialized=!0)},setElement:function(a){a=tdcOperationUI.inInnerRow(a);
b.isUndefined(a)?tdcInnerRowHandlerUI._$handlerWrapper.hide():(tdcInnerRowHandlerUI.$elementInnerRow=a,tdcInnerRowHandlerUI._$handlerWrapper.show())},_triggerEvent:function(a){b.isUndefined(a)||b.isUndefined(tdcInnerRowHandlerUI.$elementInnerRow)||tdcInnerRowHandlerUI.$elementInnerRow.trigger(a)},cloneHandler:function(a){1===a.which&&(a.preventDefault(),a.stopPropagation(),tdConfirm.showModal("Clone inner row",tdcInnerRowHandlerUI,function(a){a=f(a.currentTarget);if(a.hasClass("tdc-sidebar-clone-inner-row")){a=
a.data("model_id");var c=tdcIFrameData.getModel(a).get("blockUid"),l=tdcAdminIFrameUI.getLiveIframe();console.log(a);console.log(c);c=l.contents().find("#"+c);if(!c.length){tb_remove();return}tdcInnerRowHandlerUI.$elementInnerRow=c.closest("."+tdcInnerRowUI.getElementCssClass());tdcInnerRowHandlerUI.$elementInnerRow.data("model_id",a)}a=tdcInnerRowHandlerUI.$elementInnerRow.data("model_id");if(b.isUndefined(a))new tdcNotice.notice("tdcInnerRowHandlerUI -> tdcInnerRowHandlerUI._$handlerClone Error: Element model id is not in $draggedElement data!",
!0,!1);else if(a=tdcIFrameData.getModel(a),b.isUndefined(a))new tdcNotice.notice("tdcInnerRowHandlerUI -> tdcInnerRowHandlerUI._$handlerClone Error: Element model not in structure data!",!0,!1);else{tdcOperationUI.setDraggedElement(f('<div class="tdc-element-column tdc-element-inner-row">Cloned Inner Row</div>'));var k=tdcOperationUI.getDraggedElement();k.insertAfter(tdcInnerRowHandlerUI.$elementInnerRow);tdcInnerRowUI.bindInnerRow(k);var e=k.prevAll(".tdc-element-column").length,c=new tdcIFrameData.TdcModel({content:"",
attrs:b.clone(a.get("attrs")),tag:"vc_row_inner",type:"closed",level:2,parentModel:a.get("parentModel")});new tdcIFrameData.TdcLiveView({model:c,el:k[0]});l=new tdcIFrameData.TdcModel({content:"",attrs:{},tag:"vc_column_inner",type:"closed",level:3,parentModel:c});k.data("model_id",c.cid);a.get("parentModel").get("childCollection").add(c,{at:e});k=new tdcIFrameData.TdcCollection;k.add(l);c.set("childCollection",k);k=new tdcIFrameData.TdcCollection;l.set("childCollection",k);l=tdcIFrameData._getDestinationCol();
c.getShortcodeRender(l,"",!0,a);tdcOperationUI.setDraggedElement(d);tb_remove()}},[a],"Are you sure you want to clone the current inner row and all its elements?"))},deleteHandler:function(a){null!==a&&a.preventDefault();tdConfirm.showModal("Delete inner row",tdcInnerRowHandlerUI,function(){tdcOperationUI.setDraggedElement(tdcInnerRowHandlerUI.$elementInnerRow);tdcOperationUI.setCurrentElementOver(tdcAdminWrapperUI.$recycle);var a=tdcOperationUI.getDraggedElement(),g=tdcAdminWrapperUI.$placeholder,
a=a.closest(".tdc-elements"),l=a.children(),g=l.index(g);if(-1===g&&1===l.length||2===l.length&&-1!==g)g="",b.isUndefined(tdcElementHandlerUI.$element)&&(tdcElementHandlerUI.$element=tdcInnerRowHandlerUI.$elementInnerRow),tdcElementHandlerUI.$element.closest(".tdc-inner-column").length?g=" tdc-element-inner-column":tdcElementHandlerUI.$element.closest(".tdc-column").length&&(g=" tdc-element-column"),g=f('<div class="'+tdcOperationUI._emptyElementClass+g+'" title="Empty element that should be removed by composer"></div>'),
tdcElementUI.bindEmptyElement(g),a.append(g);tdcIFrameData.changeData({wasSidebarElementDragged:!1,wasElementDragged:!1,wasInnerColumnDragged:!1,wasInnerRowDragged:!0,wasTempInnerRowDragged:!1,wasColumnDragged:!1,wasRowDragged:!1,wasTempRowDragged:!1,draggedBlockUid:"",sourceColParam:null});tdcOperationUI.setDraggedElement(d);tdcOperationUI.setCurrentElementOver(d);tdcSidebarPanel.clearPanel();tb_remove()},d,"Are you sure you want to delete the current inner row and all its elements?")}}})(jQuery,
Backbone,_);var tdcInnerColumnHandlerUI;
(function(f,e,b,d){tdcInnerColumnHandlerUI={_handlerId:"tdc-inner-column",_handlerText:"Inner Column",_handlerCssClass:"tdc-mask-inner-column",$elementInnerColumn:d,_$handlerWrapper:d,_isInitialized:!1,init:function(a){b.isUndefined(a)||!0!==a||(tdcInnerColumnHandlerUI._isInitialized=!1);tdcInnerColumnHandlerUI._isInitialized||(a=f('<div id="'+tdcInnerColumnHandlerUI._handlerCssClass+'"><div class="tdc-mask-arrow-horizontal" title="Drag inner column horizontally"></div><div class="tdc-mask-handler-drag" title="Inner column settings">'+tdcInnerColumnHandlerUI._handlerText+
"</div></div>"),tdcInnerColumnHandlerUI._$handlerWrapper=a,tdcMaskUI.$handlerStructure.append(a),tdcInnerColumnHandlerUI._$handlerWrapper.mousedown(function(a){1===a.which&&tdcInnerColumnHandlerUI._triggerEvent(a)}).mouseup(function(a){tdcInnerColumnHandlerUI._triggerEvent(a)}).mousemove(function(a){tdcMaskUI.show();tdcInnerColumnHandlerUI._triggerEvent(a)}).mouseenter(function(a){tdcMaskUI.show();tdcInnerColumnHandlerUI._triggerEvent(a)}).mouseleave(function(a){tdcInnerColumnHandlerUI._triggerEvent(a)}),
tdcInnerColumnHandlerUI._$handlerWrapper.mouseenter(function(a){a.preventDefault();tdcMaskUI.setCurrentContainer(tdcInnerColumnHandlerUI.$elementInnerColumn);tdcMaskUI.show()}).mouseleave(function(a){a.preventDefault();tdcMaskUI.setCurrentContainer(d);tdcMaskUI.hide()}),tdcMaskUI.addHandler(tdcInnerColumnHandlerUI._handlerId,tdcInnerColumnHandlerUI),tdcInnerColumnHandlerUI._isInitialized=!0)},setElement:function(a){a=tdcOperationUI.inInnerColumn(a);b.isUndefined(a)?tdcInnerColumnHandlerUI._$handlerWrapper.hide():
(tdcInnerColumnHandlerUI.$elementInnerColumn=a,tdcInnerColumnHandlerUI._$handlerWrapper.show())},_triggerEvent:function(a){b.isUndefined(a)||b.isUndefined(tdcInnerColumnHandlerUI.$elementInnerColumn)||tdcInnerColumnHandlerUI.$elementInnerColumn.trigger(a)}}})(jQuery,Backbone,_);var tdcElementHandlerUI;
(function(f,e,b,d){tdcElementHandlerUI={_handlerId:"tdc-element",_handlerCssClass:"tdc-mask-element",_confirmDeletion:"Do you want to delete element?",$element:d,_$handlerWrapper:d,_$handlerClone:d,_$handlerDelete:d,_isInitialized:!1,init:function(a){b.isUndefined(a)||!0!==a||(tdcElementHandlerUI._isInitialized=!1);tdcElementHandlerUI._isInitialized||(tdcElementHandlerUI._$handlerWrapper=f('<div id="'+tdcElementHandlerUI._handlerCssClass+'"></div>'),tdcElementHandlerUI._$handlerDelete=f('<div class="tdc-mask-element-delete" title="Delete element"></div>'),
tdcElementHandlerUI._$handlerClone=f('<div class="tdc-mask-element-clone" title="Duplicate element"></div>'),tdcElementHandlerUI._$handlerWrapper.append(tdcElementHandlerUI._$handlerDelete),tdcElementHandlerUI._$handlerWrapper.append(tdcElementHandlerUI._$handlerClone),tdcMaskUI.$handlerStructure.append(tdcElementHandlerUI._$handlerWrapper),tdcElementHandlerUI._$handlerDelete.click(function(a){tdConfirm.showModal("Delete current element",tdcElementHandlerUI,function(a){tdcElementHandlerUI.deleteHandler(a);
tb_remove()},[a],"Are you sure you want to delete this element?")}),tdcElementHandlerUI._$handlerClone.click(function(a){a.preventDefault();a.stopPropagation();a=tdcElementHandlerUI.$element.data("model_id");if(b.isUndefined(a))new tdcNotice.notice("tdcElementHandlerUI -> tdcElementHandlerUI._$handlerClone Error: Element model id is not in $draggedElement data!",!0,!1);else if(a=tdcIFrameData.getModel(a),b.isUndefined(a))new tdcNotice.notice("tdcElementHandlerUI -> tdcElementHandlerUI._$handlerClone Error: Element model not in structure data!",
!0,!1);else{var c=a.clone(),l=a.get("parentModel").get("childCollection");l.add(c,{at:l.indexOf(a)+1,silent:!0});tdcOperationUI.setDraggedElement(f('<div class="tdc-element">Cloned Element</div>'));l=tdcOperationUI.getDraggedElement();l.insertAfter(tdcElementHandlerUI.$element);tdcElementUI.bindElement(l);var k=tdcIFrameData._getDestinationModel([".tdc-inner-column",".tdc-column"]);b.isUndefined(k)&&new tdcNotice.notice("tdcElementHandlerUI -> tdcElementHandlerUI._$handlerClone Error: Destination model not in structure data!",
!0,!1);k=tdcIFrameData._getDestinationCol();new tdcIFrameData.TdcLiveView({model:c,el:l[0]});l.data("model_id",c.cid);c.getShortcodeRender(k,"",!1,a);tdcOperationUI.setDraggedElement(d)}}),tdcElementHandlerUI._$handlerWrapper.mousedown(function(a){1===a.which&&tdcElementHandlerUI._triggerEvent(a)}).mouseup(function(a){tdcElementHandlerUI._triggerEvent(a)}).mousemove(function(a){tdcMaskUI.show();tdcElementHandlerUI._triggerEvent(a)}).mouseenter(function(a){a.preventDefault();tdcMaskUI.setCurrentElement(tdcElementHandlerUI.$element);
tdcMaskUI.show()}).mouseleave(function(a){a.preventDefault();tdcMaskUI.setCurrentElement(d);tdcMaskUI.hide()}),tdcMaskUI.addHandler(tdcElementHandlerUI._handlerId,tdcElementHandlerUI),tdcElementHandlerUI._isInitialized=!0)},deleteHandler:function(a){null!==a&&a.preventDefault();tdcOperationUI.setDraggedElement(tdcElementHandlerUI.$element);tdcOperationUI.setCurrentElementOver(tdcAdminWrapperUI.$recycle);a=tdcOperationUI.getDraggedElement();var c=tdcAdminWrapperUI.$placeholder;a=a.closest(".tdc-elements");
var b=a.children(),c=b.index(c);if(-1===c&&1===b.length||2===b.length&&-1!==c)c="",tdcElementHandlerUI.$element.closest(".tdc-inner-column").length?c=" tdc-element-inner-column":tdcElementHandlerUI.$element.closest(".tdc-column").length&&(c=" tdc-element-column"),c=f('<div class="'+tdcOperationUI._emptyElementClass+c+'" title="Empty element that should be removed by composer"></div>'),tdcElementUI.bindEmptyElement(c),a.append(c);tdcIFrameData.changeData({wasSidebarElementDragged:!1,wasElementDragged:!0,
wasInnerColumnDragged:!1,wasInnerRowDragged:!1,wasTempInnerRowDragged:!1,wasColumnDragged:!1,wasRowDragged:!1,wasTempRowDragged:!1,draggedBlockUid:"",sourceColParam:null});tdcOperationUI.setDraggedElement(d);tdcOperationUI.setCurrentElementOver(d);tdcSidebarPanel.clearPanel()},setElement:function(a){!b.isUndefined(a)&&tdcOperationUI.isElement(a)?(tdcElementHandlerUI.$element=a,tdcElementHandlerUI._$handlerWrapper.show()):tdcElementHandlerUI._$handlerWrapper.hide()},show:function(){tdcElementHandlerUI._$handlerWrapper.show()},
hide:function(){tdcElementHandlerUI._$handlerWrapper.hide()},_triggerEvent:function(a){b.isUndefined(a)||b.isUndefined(tdcElementHandlerUI.$element)||tdcElementHandlerUI.$element.trigger(a)}}})(jQuery,Backbone,_);var tdcIFrameData;
(function(f,e,b,d){tdcIFrameData={iframeContents:d,tdcRows:d,TdcModel:d,TdcCollection:d,TdcLiveView:d,_postOriginalContentJSON:d,_shortcodeParserSettingsClone:d,_isInitialized:!1,init:function(a,c){b.isUndefined(c)||!0!==c||(tdcIFrameData._isInitialized=!1);if(!tdcIFrameData._isInitialized&&(tdcIFrameData.iframeContents=a,tdcIFrameData._defineStructuredData(),!0===tdcIFrameData._initStructuredData())){var d={};tdcIFrameData.bindViewsModelsWrappers(d);if(!b.isEmpty(d)){for(var l in d)tdcDebug.log(d[l]);
new tdcNotice.notice("Errors happened during tdcIframeData.init() -> bindViewsModelsWrappers()!",!0,!1)}tdcDebug.log(tdcIFrameData.tdcRows.models);tdcIFrameData._isInitialized=!0}},_defineStructuredData:function(){tdcIFrameData._isInitialized||(tdcIFrameData.TdcModel=Backbone.Model.extend({getShortcodeRender:function(a,c,g,l){var k=this,e={error:d,getShortcode:""};b.isUndefined(l)?tdcIFrameData._checkModelData(k,e):tdcIFrameData._checkModelData(l,e);if(!b.isUndefined(e.getShortcode)){var h=new tdcJobManager.job;
h.shortcode=e.getShortcode;h.columns=a;h.blockUid=c;h.success_callback=function(a){tdcDebug.log(a);var e=tdcAdminIFrameUI.getIframeWindow();b.isUndefined(l)&&tdcIFrameData.deleteCallback(k);!1===g?k.set("blockUid",a.blockUid):k.set("blockUid",d);b.has(a,"replyHtml")&&(k.set("bindNewContent",g),k.set("shortcode",h.shortcode),k.set("html",a.replyHtml));b.has(a,"replyJsForEval")&&(e.tdcEvalGlobal={oldBlockUid:c},tdcAdminIFrameUI.evalInIframe(a.replyJsForEval))};h.error_callback=function(a,c){tdcDebug.log(c);
tdcDebug.log(a)};a=tdcOperationUI.getDraggedElement();b.isUndefined(a)||a.addClass("tdc-dropped");tdcJobManager.addJob(h)}e={error:d,getShortcode:""};tdcIFrameData._checkModelData(k,e);b.isUndefined(e.error)||tdcDebug.log(e.error);e={error:d,getShortcode:""};b.isUndefined(k.get("parentModel"))||(tdcIFrameData._checkModelData(k.get("parentModel"),e),b.isUndefined(e.error)||tdcDebug.log(e.error))}}),tdcIFrameData.TdcCollection=Backbone.Collection.extend({model:tdcIFrameData.TdcModel}),tdcIFrameData.TdcLiveView=
Backbone.View.extend({initialize:function(){this.listenTo(this.model,"change:current",this.changeCurrent);this.listenTo(this.model,"change:html",this.customRender);this.listenTo(this.model,"remove",this.customRemove)},changeCurrent:function(a,c,d){this.model.has("current")&&!b.isUndefined(this.model.get("current"))&&!0===this.model.get("current")?this.$el.addClass("tdc-element-selected"):this.$el.removeClass("tdc-element-selected");this.model.set("cssWidth",this.$el.width())},customRemove:function(a,
c,b){"tdc-rows"===this.$el.attr("id")?this.$el.html(""):this.remove()},customRender:function(a,c,d){tdcDebug.log("customRender - Rendering our model");if(this.model.has("html")&&!b.isUndefined(this.model.get("html"))&&(this.$el.removeClass("tdc-dropped"),this.$el.removeClass("tdc-changed"),this.$el.html(this.model.get("html")),setTimeout(function(){tdcMaskUI.repositionMask(tdcIFrameData.iframeContents.lastMouseEvent)},100),c=this.$el.find(".td_block_wrap"),c.length&&0===parseInt(c.height())&&c.addClass("tdc-block-empty"),
this.model.has("bindNewContent")&&!0===this.model.get("bindNewContent")))if(this.model.set("bindNewContent",!1,{silent:!0}),this.$el.hasClass("tdc-element-inner-row-temp")){d=this.$el.find(".tdc-inner-row");c=a.get("childCollection");this.$el.removeClass("tdc-element-inner-row-temp").addClass("tdc-element-inner-row");this.model.set("blockUid",d.attr("id"));window.addInnerRowWrappers(this.$el);if(!b.isUndefined(c)&&(a={},tdcIFrameData.bindViewsModelsWrappers(a,c,this.$el,3),!b.isEmpty(a))){for(var g in a)tdcDebug.log(a[g]);
new tdcNotice.notice("Errors happened during tdcIFrameData.TdcLiveView -> customRender!",!0,!1);return}tdcInnerRowUI.init(this.$el.parent());tdcInnerColumnUI.init(this.$el);tdcElementUI.init(this.$el);tdcSidebar.setSettings({$currentRow:tdcOperationUI.inRow(this.$el),$currentColumn:tdcOperationUI.inColumn(this.$el),$currentInnerRow:tdcOperationUI.inInnerRow(this.$el)})}else if(this.$el.hasClass("tdc-element-inner-row")){d=this.$el.find(".tdc-inner-row");c=this.model.get("childCollection");b.isUndefined(c)||
c.reset();window.addInnerRowWrappers(this.$el);this.model.set("blockUid",d.attr("id"));d=this.model.get("shortcode");if(!0===tdcIFrameData._initNewContentStructureData(3,d,a)&&(c=this.model.get("childCollection"),!b.isUndefined(c)&&(a={},tdcIFrameData.bindViewsModelsWrappers(a,c,this.$el,3),!b.isEmpty(a)))){for(g in a)tdcDebug.log(a[g]);new tdcNotice.notice("Errors happened during tdcIFrameData.TdcLiveView -> customRender!",!0,!1);return}tdcInnerRowUI.init(this.$el);tdcInnerColumnUI.init(this.$el);
tdcElementUI.init(this.$el);tdcSidebar.setSettings({$currentRow:tdcOperationUI.inRow(this.$el),$currentColumn:tdcOperationUI.inColumn(this.$el),$currentInnerRow:tdcOperationUI.inInnerRow(this.$el)})}else if(this.$el.hasClass("tdc-row-temp")){d=this.$el.find(".tdc-row");c=a.get("childCollection");this.$el.removeClass("tdc-row-temp").addClass("tdc-row");this.$el.attr("id",d.attr("id"));this.$el.html(d.html());this.model.set("blockUid",d.attr("id"));window.addRowWrappers(this.$el);if(!b.isUndefined(c)&&
(a={},tdcIFrameData.bindViewsModelsWrappers(a,c,this.$el,1),!b.isEmpty(a))){for(g in a)tdcDebug.log(a[g]);new tdcNotice.notice("Errors happened during tdcIFrameData.TdcLiveView -> customRender!",!0,!1);return}tdcRowUI.init(this.$el.parent());tdcColumnUI.init(this.$el);tdcElementUI.init(this.$el);tdcSidebar.setSettings({$currentRow:this.$el})}else if(this.$el.hasClass("tdc-row")){d=this.$el.find(".tdc-row");c=this.model.get("childCollection");b.isUndefined(c)||c.reset();this.$el.html(d.html());this.$el.attr("class",
d.attr("class"));this.$el.attr("id",d.attr("id"));this.model.set("blockUid",d.attr("id"));window.addRowWrappers(this.$el);d=this.model.get("shortcode");if(!0===tdcIFrameData._initNewContentStructureData(1,d,this.model)&&!b.isUndefined(c)&&(a={},tdcIFrameData.bindViewsModelsWrappers(a,c,this.$el,1),!b.isEmpty(a))){for(g in a)tdcDebug.log(a[g]);new tdcNotice.notice("Errors happened during tdcIFrameData.TdcLiveView -> customRender!",!0,!1);return}tdcColumnUI.init(this.$el);tdcInnerRowUI.init(this.$el);
tdcInnerColumnUI.init(this.$el);tdcElementUI.init(this.$el);tdcSidebar.setSettings({$currentRow:this.$el})}else if(this.$el.hasClass("tdc-column")){a=this.$el.find(".tdc-column");c=this.model.get("childCollection");b.isUndefined(c)||c.reset();this.$el.html(a.html());window.addColumnWrappers(this.$el);d=this.model.get("shortcode");if(!0===tdcIFrameData._initNewContentStructureData(2,d,this.model)&&!b.isUndefined(c)&&(a={},tdcIFrameData.bindViewsModelsWrappers(a,c,this.$el,2),!b.isEmpty(a))){for(g in a)tdcDebug.log(a[g]);
new tdcNotice.notice("Errors happened during tdcIFrameData.TdcLiveView -> customRender!",!0,!1);return}tdcInnerRowUI.init(this.$el);tdcInnerColumnUI.init(this.$el);tdcElementUI.init(this.$el);tdcSidebar.setSettings({$currentRow:tdcOperationUI.inRow(this.$el),$currentColumn:this.$el})}else if(this.$el.hasClass("tdc-inner-row")){d=this.$el.find(".tdc-inner-row");c=this.model.get("childCollection");b.isUndefined(c)||c.reset();this.$el.html(d.html());window.addInnerRowWrappers(this.$el);d=this.model.get("shortcode");
if(!0===tdcIFrameData._initNewContentStructureData(3,d,this.model)&&!b.isUndefined(c)&&(a={},tdcIFrameData.bindViewsModelsWrappers(a,c,this.$el,3),!b.isEmpty(a))){for(g in a)tdcDebug.log(a[g]);new tdcNotice.notice("Errors happened during tdcIFrameData.TdcLiveView -> customRender!",!0,!1);return}tdcInnerColumnUI.init(this.$el);tdcElementUI.init(this.$el);tdcSidebar.setSettings({$currentRow:tdcOperationUI.inRow(this.$el),$currentColumn:tdcOperationUI.inColumn(this.$el),$currentInnerRow:this.$el})}else if(this.$el.hasClass("tdc-inner-column")){a=
this.$el.find(".tdc-inner-column");c=this.model.get("childCollection");b.isUndefined(c)||c.reset();this.$el.html(a.html());window.addInnerColumnWrappers(this.$el);d=this.model.get("shortcode");if(!0===tdcIFrameData._initNewContentStructureData(4,d,this.model)&&!b.isUndefined(c)&&(a={},tdcIFrameData.bindViewsModelsWrappers(a,c,this.$el,4),!b.isEmpty(a))){for(g in a)tdcDebug.log(a[g]);new tdcNotice.notice("Errors happened during tdcIFrameData.TdcLiveView -> customRender!",!0,!1);return}tdcElementUI.init(this.$el);
tdcSidebar.setSettings({$currentRow:tdcOperationUI.inRow(this.$el),$currentColumn:tdcOperationUI.inColumn(this.$el),$currentInnerRow:tdcOperationUI.inInnerRow(this.$el),$currentInnerColumn:this.$el})}else if("tdc-rows"===this.$el.attr("id")){d=this.$el.find(".tdc-row");var e=this.model.cid;a=tdcIFrameData.getModel(e);c=a.get("childCollection");d.data("model_id",e);this.model.set("blockUid",d.attr("id"));window.addRowWrappers(this.$el);if(!b.isUndefined(c)&&(a={},tdcIFrameData.bindViewsModelsWrappers(a,
c,d,1),!b.isEmpty(a))){for(g in a)tdcDebug.log(a[g]);new tdcNotice.notice("Errors happened during tdcIFrameData.TdcLiveView -> customRender!",!0,!1);return}tdcRowUI.init(this.$el);tdcColumnUI.init(this.$el);tdcInnerRowUI.init(this.$el);tdcInnerColumnUI.init(this.$el);tdcElementUI.init(this.$el);this.$el=d;tdcSidebar.setSettings({$currentRow:d})}}}))},_getPostOriginalContentJSON:function(){if(b.isUndefined(tdcIFrameData._postOriginalContentJSON)&&!b.isUndefined(window.tdcPostSettings)){var a=Object.keys(window.tdcAdminSettings.mappedShortcodes),
a=a.filter(function(a){return 0>["vc_row","vc_column","vc_row_inner","vc_column_inner"].indexOf(a)}),a={0:["vc_row"],1:["vc_column"],2:["vc_row_inner"],3:["vc_column_inner"],4:a};tdcIFrameData._shortcodeParserSettingsClone=a;tdcShortcodeParser.init(a);tdcIFrameData._postOriginalContentJSON=tdcShortcodeParser.parse(0,window.tdcPostSettings.postContent)}return tdcIFrameData._postOriginalContentJSON},_getContentJSON:function(a,c){var d;b.isUndefined(window.tdcPostSettings)||(d=tdcShortcodeParser.parse(a,
c));return d},_initStructuredData:function(){if(!tdcIFrameData._isInitialized){var a=tdcIFrameData._getPostOriginalContentJSON();tdcDebug.log(a);if(a.length){tdcIFrameData.tdcRows=new tdcIFrameData.TdcCollection;var c={};b.each(a,function(a,b,e){tdcIFrameData._getData(d,a,c)});b.isEmpty(c)||(tdcDebug.log(c),new tdcNotice.notice("Errors happened during _initStructureData() -> _getData()!",!0,!1));a={error:d,shortcode:d};tdcIFrameData.checkCurrentData(a);b.isUndefined(a.error)||(tdcDebug.log(a.error),
new tdcNotice.notice(c,!0,!1))}return!0}},_initNewContentStructureData:function(a,c,g){c=tdcIFrameData._getContentJSON(a,c);if(c.length){var l={};b.each(c,function(c,b,d){tdcIFrameData._getData(g,c,l,a)});b.isEmpty(l)||(tdcDebug.log(l),new tdcNotice.notice(l,!0,!1));c={error:d,shortcode:d};tdcIFrameData.checkCurrentData(c);b.isUndefined(c.error)||(tdcDebug.log(c.error),new tdcNotice.notice("Errors happened during _initNewContentStructureData() -> checkCurrentData()!",!0,!1))}return!0},_getData:function(a,
c,g,l){var e;var f=b.isUndefined(a)?tdcIFrameData.tdcRows:a.get("childCollection");for(var h in tdcIFrameData._shortcodeParserSettingsClone)if(!(!b.isUndefined(l)&&parseInt(l,10)>h||b.isUndefined(c.shortcode))&&b.isObject(c.shortcode)&&b.has(c.shortcode,"tag")&&-1!==b.indexOf(tdcIFrameData._shortcodeParserSettingsClone[h],c.shortcode.tag)){0<parseInt(h,10)&&b.isUndefined(a)&&(e="Not rows as the first elements!");!b.isUndefined(a)&&parseInt(a.get("level"),10)>=parseInt(h,10)&&(e="Elements does not respect the shortcode levels!");
!b.isUndefined(a)&&1<parseInt(h,10)-parseInt(a.get("level"),10)&&2!==parseInt(a.get("level"),10)&&4!==parseInt(h,10)&&(e="Elements respect the shortcode levels, but the difference higher than 1 is not allowed here!");b.isUndefined(e)||(g[b.keys(g).length]={element:c,info:e,parentModel:a});4!==parseInt(h,10)||b.isUndefined(c.shortcode.content)||(l=b.clone(c.shortcode.attrs.named),l.content=c.shortcode.content,c.shortcode.attrs.named=l);var m=new tdcIFrameData.TdcModel({content:c.content,attrs:c.shortcode.attrs.named,
tag:c.shortcode.tag,type:c.shortcode.type,level:parseInt(h,10),parentModel:a,bindNewContent:!1});b.has(c,"child")&&0<c.child.length&&(m.set("childCollection",new tdcIFrameData.TdcCollection),b.each(c.child,function(a,c,b){tdcIFrameData._getData(m,a,g,d)}));break}b.isUndefined(m)?g[b.keys(g).length]={element:c,info:"Element not found!",parentModel:a}:b.isUndefined(f)||f.add(m)},getModel:function(a,c){if(tdcIFrameData._isInitialized){var d;b.isUndefined(c)&&(c=tdcIFrameData.tdcRows);b.each(c.models,
function(c,g,e){b.isUndefined(d)&&(c.cid===a?d=c:c.has("childCollection")&&(c=c.get("childCollection"),d=tdcIFrameData.getModel(a,c)))});if(!b.isUndefined(d))return d}},getFirstModelByTag:function(a,c){if(tdcIFrameData._isInitialized){var d;b.isUndefined(c)&&(c=tdcIFrameData.tdcRows);b.each(c.models,function(c,g,e){b.isUndefined(d)&&(c.attributes.tag===a?d=c:c.has("childCollection")&&(c=c.get("childCollection"),d=tdcIFrameData.getFirstModelByTag(a,c)))});if(!b.isUndefined(d))return d}},removeModel:function(a,
c,d){(b.isUndefined(c)||!0===c)&&tdcIFrameData.deleteCallback(a);c=a.get("parentModel");b.isUndefined(d)&&(d={});b.isUndefined(c)?tdcIFrameData.tdcRows.remove(a,d):c.get("childCollection").remove(a,d)},deleteCallback:function(a){var c=a.get("blockUid");a=a.get("childCollection");tdcAdminIFrameUI.getIframeWindow().tdcComposerBlocksApi.deleteItem(c);!b.isUndefined(a)&&a.length&&b.each(a.models,function(a,c,b){tdcIFrameData.deleteCallback(a)})},_checkModelData:function(a,c){if(b.isUndefined(c.error)){var g=
a.get("parentModel");if(0!==a.level||b.isUndefined(g))if(!b.isUndefined(g)&&parseInt(g.get("level"),10)>=parseInt(a.level,10))c.error="Elements does not respect the shortcode levels!";else if(!b.isUndefined(g)&&1<parseInt(a.level,10)-parseInt(g.get("level"),10)&&2!==parseInt(g.get("level"),10)&&4!==parseInt(a.level,10))c.error="Elements respect the shortcode levels, but the difference higher than 1 is not allowed here!";else{!b.isUndefined(c.getShortcode)&&b.isUndefined(c.deepLevel)&&(c.deepLevel=
0,c["tempShortcodeDeepLevel"+c.deepLevel]="");if(a.has("childCollection")){b.isUndefined(c.getShortcode)||(c.deepLevel++,c["tempShortcodeDeepLevel"+c.deepLevel]="");var l=a.get("childCollection");b.each(l.models,function(a,b,d){tdcIFrameData._checkModelData(l.get(a.cid),c)});b.isUndefined(c.getShortcode)||c.deepLevel--}if(!b.isUndefined(c.getShortcode)){var e=a.get("type"),g=a.get("tag"),f=a.get("attrs"),h="";if("td_block_text_with_title"===g||"vc_column_text"===g||"vc_raw_html"===g)b.map(f,function(a,
c){"content"!==c&&(h+=" "+c+'="'+a+'"')}),h=b.has(f,"content")?"["+g+h+"]"+f.content+"[/"+g+"]":"["+g+h+"]";else switch(b.map(f,function(a,c){h+=" "+c+'="'+a+'"'}),e){case "single":h="["+g+h+"]";break;case "closed":e="",b.isUndefined(c["tempShortcodeDeepLevel"+(parseInt(c.deepLevel)+1)])||(e=c["tempShortcodeDeepLevel"+(parseInt(c.deepLevel)+1)],c["tempShortcodeDeepLevel"+(parseInt(c.deepLevel)+1)]=d),h="["+g+h+"]"+e+"[/"+g+"]"}c["tempShortcodeDeepLevel"+c.deepLevel]+=h;0===c.deepLevel&&(c.getShortcode+=
h)}}else c.error="Not rows as the first elements!"}},checkCurrentData:function(a){tdcIFrameData._isInitialized&&b.each(tdcIFrameData.tdcRows.models,function(c,b,d){tdcIFrameData._checkModelData(tdcIFrameData.tdcRows.get(c.cid),a)})},changeData:function(a){if(tdcIFrameData._isInitialized){tdcMain.setContentModified();var c=tdcOperationUI.getDraggedElement();var g=c.prevAll().length;if(a.wasSidebarElementDragged)if(a.wasElementDragged){var l=tdcIFrameData._getDestinationModel([".tdc-inner-column",".tdc-column"]);
b.isUndefined(l)&&new tdcNotice.notice("changeData Error: Destination model not in structure data!",!0,!1);var e=tdcIFrameData._getDestinationCol();l.has("childCollection")||l.set("childCollection",new tdcIFrameData.TdcCollection);var f=l.get("childCollection");var h=c.data("shortcodeName");h=new tdcIFrameData.TdcModel({content:"",attrs:{},tag:h,type:"single",level:4,parentModel:l});new tdcIFrameData.TdcLiveView({model:h,el:c[0]});tdcElementUI.bindElement(c);tdcRecycle.takeSnapshot(h.get("tag")+" : sidebar element added");
c.data("model_id",h.cid);f.add(h,{at:g});h.set("parentModel",l);h.getShortcodeRender(e,a.draggedBlockUid,!1)}else if(a.wasTempInnerRowDragged){tdcRecycle.takeSnapshot("Sidebar inner-row added");l=tdcIFrameData._getDestinationModel([".tdc-column"]);b.isUndefined(l)&&new tdcNotice.notice("changeData Error: Destination model not in structure data!",!0,!1);e=tdcIFrameData._getDestinationCol();l.has("childCollection")||l.set("childCollection",new tdcIFrameData.TdcCollection);f=l.get("childCollection");
h=new tdcIFrameData.TdcModel({content:"",attrs:{},tag:"vc_row_inner",type:"closed",level:2,parentModel:l});new tdcIFrameData.TdcLiveView({model:h,el:c[0]});var m=new tdcIFrameData.TdcModel({content:"",attrs:{},tag:"vc_column_inner",type:"closed",level:3,parentModel:h});c.data("model_id",h.cid);f.add(h,{at:g});c=new tdcIFrameData.TdcCollection;c.add(m);h.set("childCollection",c);c=new tdcIFrameData.TdcCollection;m.set("childCollection",c);h.getShortcodeRender(e,a.draggedBlockUid,!0)}else a.wasTempRowDragged&&
(tdcRecycle.takeSnapshot("Sidebar row added"),e=new tdcIFrameData.TdcModel({content:"",attrs:{},tag:"vc_row",type:"closed",level:0,parentModel:d}),new tdcIFrameData.TdcLiveView({model:e,el:c[0]}),h=new tdcIFrameData.TdcModel({content:"",attrs:{},tag:"vc_column",type:"closed",level:1,parentModel:e}),c.data("model_id",e.cid),tdcIFrameData.tdcRows.add(e,{at:g}),c=new tdcIFrameData.TdcCollection,c.add(h),e.set("childCollection",c),c=new tdcIFrameData.TdcCollection,h.set("childCollection",c),e.getShortcodeRender(1,
a.draggedBlockUid,!0));else{h=c.data("model_id");if(b.isUndefined(h)){new tdcNotice.notice("changeData Error: Element model id is not in $draggedElement data!",!0,!1);return}h=tdcIFrameData.getModel(h);if(b.isUndefined(h)){new tdcNotice.notice("changeData Error: Element model not in structure data!",!0,!1);return}if(a.wasElementDragged){tdcDebug.log("case 1");if(tdcOperationUI.getCurrentElementOver()===tdcAdminWrapperUI.$recycle){tdcDebug.log("element recycled");tdcIFrameData.removeModel(h);return}tdcRecycle.takeSnapshot(h.get("tag")+
" : element moved");var n=h.get("parentModel");l=tdcIFrameData._getDestinationModel([".tdc-inner-column",".tdc-column"]);b.isUndefined(l)&&new tdcNotice.notice("changeData Error: Destination model not in structure data!",!0,!1);n.cid===l.cid?(e=n.get("childCollection"),e.remove(h,{silent:!0}),e.add(h,{at:g})):(e=tdcIFrameData._getDestinationCol(),l.has("childCollection")||l.set("childCollection",new tdcIFrameData.TdcCollection),f=l.get("childCollection"),tdcIFrameData.removeModel(h,!1,{silent:!0}),
f.add(h,{at:g}),h.set("parentModel",l),a.sourceColParam!==e&&h.getShortcodeRender(e,a.draggedBlockUid,!1))}else if(a.wasInnerRowDragged){tdcDebug.log("case 2");if(tdcOperationUI.getCurrentElementOver()===tdcAdminWrapperUI.$recycle){tdcDebug.log("inner row recycled");tdcRecycle.takeSnapshot("Inner row recycled");tdcIFrameData.removeModel(h);return}tdcRecycle.takeSnapshot("Inner row moved");n=h.get("parentModel");l=tdcIFrameData._getDestinationModel([".tdc-column"]);b.isUndefined(l)&&new tdcNotice.notice("changeData Error: Destination model not in structure data!",
!0,!1);if(n.cid===l.cid)e=n.get("childCollection"),e.remove(h,{silent:!0}),e.add(h,{at:g});else{l.has("childCollection")||l.set("childCollection",new tdcIFrameData.TdcCollection);f=l.get("childCollection");tdcIFrameData.removeModel(h,!0,{silent:!0});f.add(h,{at:g});h.set("parentModel",l);a=n.get("attrs");g=l.get("attrs");if(b.has(a,"width"))switch(a.width){case "1/3":e="13";break;case "2/3":e="23"}if(b.has(g,"width"))switch(g.width){case "1/3":m="13";break;case "2/3":m="23"}b.isUndefined(e)&&(e="11");
b.isUndefined(m)&&(m="11");if(e!==m&&(a=h.get("childCollection"),!b.isUndefined(a))){a=tdcIFrameData.getChildCollectionWidths(a);b.isUndefined(a)&&(a="11");g="11";f=1;switch(m){case "11":switch(a){case "11":g="11";break;case "23_13":g="23_13";break;case "13_23":g="13_23";break;case "12_12":g="13_13_13";break;case "13_13_13":g="13_13_13"}f=3;break;case "13":switch(a){case "11":g="11";break;case "23_13":g="11";break;case "13_23":g="11";break;case "12_12":g="11";break;case "13_13_13":g="11"}break;case "23":switch(a){case "11":g=
"12_12";break;case "23_13":g="12_12";break;case "13_23":g="12_12";break;case "12_12":g="12_12";break;case "13_13_13":g="12_12"}f=2}if(a!==g||e!==m)tdcIFrameData.changeInnerRowModel(h,a,g),h.getShortcodeRender(f,null,!0)}h=tdcOperationUI.inRow(c);a=tdcOperationUI.inColumn(c);c=tdcOperationUI.inInnerRow(c);b.isUndefined(h)||b.isUndefined(a)||b.isUndefined(c)||tdcSidebar.setSettings({$currentRow:h,$currentColumn:a,$currentInnerRow:c},!0)}}else if(a.wasInnerColumnDragged||a.wasColumnDragged)tdcDebug.log("case 3"),
a.wasColumnDragged?tdcRecycle.takeSnapshot("Column moved"):a.wasInnerColumnDragged&&tdcRecycle.takeSnapshot("Inner-column moved"),n=h.get("parentModel"),e=n.get("childCollection"),e.remove(h,{silent:!0}),e.add(h,{at:g}),a.wasColumnDragged?(h=tdcOperationUI.inRow(c),b.isUndefined(h)||tdcSidebar.setSettings({$currentRow:h})):a.wasInnerColumnDragged&&(h=tdcOperationUI.inRow(c),a=tdcOperationUI.inColumn(c),c=tdcOperationUI.inInnerRow(c),b.isUndefined(h)||b.isUndefined(a)||b.isUndefined(c)||tdcSidebar.setSettings({$currentRow:h,
$currentColumn:a,$currentInnerRow:c}));else if(a.wasRowDragged){tdcDebug.log("case 4");if(tdcOperationUI.getCurrentElementOver()===tdcAdminWrapperUI.$recycle){tdcDebug.log("row recycled");tdcRecycle.takeSnapshot("Row recycled");tdcIFrameData.removeModel(h);tdcDebug.log(tdcIFrameData.tdcRows);tdcIFrameData.tdcRows.length||(e=new tdcIFrameData.TdcModel({content:"",attrs:{},tag:"vc_row",type:"closed",level:0,parentModel:d}),new tdcIFrameData.TdcLiveView({model:e,el:tdcIFrameData.iframeContents.find("#tdc-rows")[0]}),
h=new tdcIFrameData.TdcModel({content:"",attrs:{},tag:"vc_column",type:"closed",level:1,parentModel:e}),tdcIFrameData.tdcRows.add(e,{at:0}),c=new tdcIFrameData.TdcCollection,c.add(h),e.set("childCollection",c),c=new tdcIFrameData.TdcCollection,h.set("childCollection",c),e.getShortcodeRender(1,a.draggedBlockUid,!0));return}tdcRecycle.takeSnapshot("Row moved");tdcIFrameData.tdcRows.remove(h,{silent:!0});tdcIFrameData.tdcRows.add(h,{at:g});tdcDebug.log("newPosition: "+g);tdcDebug.log(c)}}tdcDebug.log(tdcIFrameData.tdcRows)}},
_parseModelWidthAttrs:function(a){a=a.get("attrs");var c=3;if(b.has(a,"width"))switch(a.width){case "1/3":c=1;break;case "2/3":c=2;break;case "1/2":c=1}return c},getColumnNumber:function(a){var c=3,d=parseInt(a.get("level"),10),e=a.get("parentModel");b.isUndefined(e)||(a=4===d?tdcIFrameData._parseModelWidthAttrs(e):tdcIFrameData._parseModelWidthAttrs(a),c=3===a?tdcIFrameData.getColumnNumber(e):a);return c},_getDestinationModel:function(a){for(var c=tdcOperationUI.getDraggedElement(),d,e=0;e<a.length&&
(d=c.closest(a[e]),!d.length);e++);d.length||new tdcNotice.notice("_getDestinationModel Error: Container destination not available!",!0,!1);a=d.data("model_id");b.isUndefined(a)&&new tdcNotice.notice("_getDestinationModel Error: Model id of the container destination not in data!",!0,!1);a=tdcIFrameData.getModel(a);b.isUndefined(a)&&new tdcNotice.notice("_getDestinationModel Error: Model not in structure data!",!0,!1);return a},_getDestinationCol:function(){var a=tdcOperationUI.getDraggedElement();
var c=a.closest(".tdc-column");a=a.closest(".tdc-inner-column");if(a.length&&(a=a.data("model_id"),b.isUndefined(a)&&new tdcNotice.notice("_getDestinationCol Error: The inner column model id not in data!",!0,!1),a=tdcIFrameData.getModel(a),b.isUndefined(a)&&new tdcNotice.notice("_getDestinationCol Error: The inner column model not in structure data!",!0,!1),a=tdcIFrameData._parseModelWidthAttrs(a),3!==a))return a;if(c.length)return c=c.data("model_id"),b.isUndefined(c)&&new tdcNotice.notice("_getDestinationCol Error: The column model id not in data!",
!0,!1),a=tdcIFrameData.getModel(c),b.isUndefined(c)&&new tdcNotice.notice("_getDestinationCol Error: Tne column model not in structure data!",!0,!1),a=tdcIFrameData._parseModelWidthAttrs(a);new tdcNotice.notice("_getDestinationCol Error: The destination container is not inside of .tdc-column !",!0,!1)},_getSourceCol:function(){var a=tdcOperationUI.getDraggedElement();var c=a.closest(".tdc-column");a=a.closest(".tdc-inner-column");if(a.length&&(a=a.data("model_id"),b.isUndefined(a)&&new tdcNotice.notice("_getSourceCol Error: The inner column model id not in data!",
!0,!1),a=tdcIFrameData.getModel(a),b.isUndefined(a)&&new tdcNotice.notice("_getSourceCol Error: The inner column model not in structure data!",!0,!1),a=tdcIFrameData._parseModelWidthAttrs(a),3!==a))return a;if(c.length)return c=c.data("model_id"),b.isUndefined(c)&&new tdcNotice.notice("_getSourceCol Error: The column model id not in data!",!0,!1),a=tdcIFrameData.getModel(c),b.isUndefined(c)&&new tdcNotice.notice("_getSourceCol Error: Tne column model not in structure data!",!0,!1),a=tdcIFrameData._parseModelWidthAttrs(a);
new tdcNotice.notice("_getSourceCol Error: The source container is not inside of .tdc-column !",!0,!1)},getShortcodeFromData:function(a){a.getShortcode="";b.each(tdcIFrameData.tdcRows.models,function(c,b,d){tdcIFrameData._checkModelData(tdcIFrameData.tdcRows.get(c.cid),a)})},bindViewsModelsWrappers:function(a,c,d,e){if(b.isEmpty(a)){b.isUndefined(e)&&(e=0);if(b.isUndefined(c)){c=tdcIFrameData.tdcRows;d=tdcIFrameData.iframeContents.find("#tdc-rows .tdc-row");if(c.models.length!==d.length){a[b.keys(a).length]=
{collection:c,jqDOMElements:d,info:"Error at rows: "+c.models.length+"(models) : "+d.length+"(dom)"};return}e++;b.each(d,function(b,d,g){d=c.models[d];g=f(b);g.data("model_id",d.cid);d.set("blockUid",g.attr("id"));d.set("html",b.innerHTML);new tdcIFrameData.TdcLiveView({model:d,el:b});d.has("childCollection")&&tdcIFrameData.bindViewsModelsWrappers(a,d.get("childCollection"),g,e)})}else{switch(e){case 1:var g=d.find(".tdc-columns:first").children(".tdc-column");if(c.models.length!==g.length){a[b.keys(a).length]=
{collection:c,jqDOMElements:g,info:"Errors at columns: "+c.models.length+"(models) : "+g.length+"(dom)",level:e};return}break;case 2:g=d.find(".tdc-elements:first").children(".tdc-element, .tdc-element-inner-row");if(c.models.length!==g.length){a[b.keys(a).length]={collection:c,jqDOMElements:g,info:"Errors at columns elements: "+c.models.length+"(models) : "+g.length+"(dom)",level:e};return}break;case 3:g=d.find(".tdc-inner-columns:first").children(".tdc-inner-column");if(c.models.length!==g.length){a[b.keys(a).length]=
{collection:c,jqDOMElements:g,info:"Errors at inner columns: "+c.models.length+"(models) : "+g.length+"(dom)",level:e};return}break;case 4:if(g=d.find(".tdc-elements:first").children(".tdc-element"),c.models.length!==g.length){a[b.keys(a).length]={collection:c,jqDOMElements:g,info:"Errors at elements: "+c.models.length+"(models) : "+g.length+"(dom)",level:e};return}}e++;b.each(g,function(d,g,l){g=c.models[g];l=f(d);l.data("model_id",g.cid);g.set("html",d.innerHTML,{silent:!0});var h;if(4===g.get("level")){var k=
l.find(".td_block_inner");k.length&&(h=k.attr("id"))}else 2===g.get("level")&&(k=l.find(".tdc-inner-row"),k.length&&(h=k.attr("id")));g.set("blockUid",h);new tdcIFrameData.TdcLiveView({model:g,el:d});!l.hasClass("tdc-element")&&g.has("childCollection")&&0<b.size(g.get("childCollection"))&&tdcIFrameData.bindViewsModelsWrappers(a,g.get("childCollection"),l,e)})}e--}},changeRowModel:function(a,c,d){var g=a.get("childCollection");if("11"===c&&("23_13"===d||"13_23"===d||"13_13_13"===d)){d=d.split("_");
var e=d[0].charAt(0)+"/"+d[0].charAt(1);var f=g.at(0);var h=f.get("attrs");b.isUndefined(h)?f.set("attrs",{width:e}):(h=b.clone(h),h.width=e,f.set("attrs",h));g.add(new tdcIFrameData.TdcModel({content:"",tag:"vc_column",attrs:{width:d[1].charAt(0)+"/"+d[1].charAt(1)},type:"closed",level:1,parentModel:a}));3===d.length&&g.add(new tdcIFrameData.TdcModel({content:"",tag:"vc_column",attrs:{width:d[2].charAt(0)+"/"+d[2].charAt(1)},type:"closed",level:1,parentModel:a}));tdcIFrameData.changeColumnModel(f,
c,d[0])}else if(("23_13"===c||"13_23"===c||"13_13_13"===c)&&"11"===d){c=c.split("_");f=g.at(0);h=f.get("attrs");var m=f.get("childCollection");var n=g.at(1);var p=n.get("childCollection");b.isUndefined(h)||(h=b.clone(h),delete h.width,f.set("attrs",h));b.isUndefined(m)&&(m=new tdcIFrameData.TdcCollection,f.set("childCollection",m));!b.isUndefined(p)&&p.length&&b.each(p.models,function(a,c,b){a.set("parentModel",f);m.add(a)});3===c.length&&(g=g.at(2),a=g.get("childCollection"),!b.isUndefined(a)&&a.length&&
b.each(a.models,function(a,c,b){a.set("parentModel",f);m.add(a)}),tdcIFrameData.removeModel(g));tdcIFrameData.removeModel(n);tdcIFrameData.changeColumnModel(f,c[0],d)}else if(!("23_13"!==c&&"13_23"!==c&&"13_13_13"!==c||"23_13"!==d&&"13_23"!==d&&"13_13_13"!==d)){c=c.split("_");d=d.split("_");e=d[0].charAt(0)+"/"+d[0].charAt(1);var u=d[1].charAt(0)+"/"+d[1].charAt(1);f=g.at(0);h=f.get("attrs");n=g.at(1);var v=n.get("attrs");p=n.get("childCollection");3===d.length?g.add(new tdcIFrameData.TdcModel({content:"",
tag:"vc_column",attrs:{width:d[2].charAt(0)+"/"+d[2].charAt(1)},type:"closed",level:1,parentModel:a})):3===c.length&&(g=g.at(2),a=g.get("childCollection"),!b.isUndefined(a)&&a.length&&(b.isUndefined(p)&&(p=new tdcIFrameData.TdcCollection,n.set("childCollection",p)),b.each(a.models,function(a,c,b){a.set("parentModel",n);p.add(a)})),tdcIFrameData.removeModel(g));h=b.clone(h);h.width=e;f.set("attrs",h);c[0]!==d[0]&&tdcIFrameData.changeColumnModel(f,c[0],d[0]);h=b.clone(v);h.width=u;n.set("attrs",h);
c[1]!==d[1]&&tdcIFrameData.changeColumnModel(n,c[1],d[1])}tdcDebug.log(tdcIFrameData.tdcRows.models)},changeColumnModel:function(a,c,d){if(!(b.isUndefined(a)||b.isUndefined(c)||b.isUndefined(d))){var g=a.get("childCollection");if(!b.isUndefined(g)&&g.length){var e=a.get("attrs");!b.isUndefined(e)&&b.has(e,"width");b.each(g.models,function(g,e,l){if("vc_row_inner"===g.get("tag")&&(g=g.get("childCollection"),!b.isUndefined(g)&&g.length)){var h="";b.each(g.models,function(a,c,d){a=a.get("attrs");!b.isUndefined(a)&&
b.isObject(a)&&b.has(a,"width")&&(h=c===d.length-1?h+a.width:h+(a.width+"_"))});h=h.replace(/\//g,"");"12_12"!==h&&"23_13"!==h&&"13_23"!==h&&"13_13_13"!==h&&(h="");if("11"===c)if("23"===d)if("23_13"===h){var f=g.at(0);var k=g.at(1);e=f.get("attrs");l=k.get("attrs");e=b.clone(e);l=b.clone(l);e.width="1/2";l.width="1/2";f.set("attrs",e);k.set("attrs",l)}else if("13_23"===h)f=g.at(0),k=g.at(1),e=f.get("attrs"),l=k.get("attrs"),e=b.clone(e),l=b.clone(l),e.width="1/2",l.width="1/2",f.set("attrs",e),k.set("attrs",
l);else if("13_13_13"===h){f=g.at(0);k=g.at(1);g=g.at(2);e=f.get("attrs");l=k.get("attrs");var m=g.get("attrs");e=b.clone(e);l=b.clone(l);b.clone(m);e.width="1/2";l.width="1/2";f.set("attrs",e);k.set("attrs",l);e=g.get("childCollection");if(!b.isUndefined(e)&&e.length){var q=k.get("childCollection");b.isUndefined(q)&&(q=new tdcIFrameData.TdcCollection,k.set("childCollection",q));b.each(e.models,function(a,c,b){q.add(a);a.set("parentModel",k)})}tdcIFrameData.removeModel(g)}else{if(g.models.length){f=
g.at(0);e=f.get("attrs");e=b.clone(e);var r=f.get("childCollection");delete e.width;f.set("attrs",e);b.isUndefined(r)&&(r=new tdcIFrameData.TdcCollection,f.set("childCollection",r));var t=0;for(b.each(g.models,function(a,c,d){0!==c&&(t=c,a=a.get("childCollection"),b.isUndefined(a)||b.each(a.models,function(a,c,b){a.set("parentModel",f);r.add(a)}))});0<t;)tdcIFrameData.removeModel(g.at(t)),t--}}else{if("13"===d&&g.models.length)for(f=g.at(0),e=f.get("attrs"),e=b.clone(e),r=f.get("childCollection"),
delete e.width,f.set("attrs",e),b.isUndefined(r)&&(r=new tdcIFrameData.TdcCollection,f.set("childCollection",r)),t=0,b.each(g.models,function(a,c,d){0!==c&&(t=c,a=a.get("childCollection"),b.isUndefined(a)||b.each(a.models,function(a,c,b){a.set("parentModel",f);r.add(a)}))});0<t;)tdcIFrameData.removeModel(g.at(t)),t--}else if("23"===c)if("11"===d)if("12_12"===h)f=g.at(0),k=g.at(1),e=f.get("attrs"),l=k.get("attrs"),e=b.clone(e),l=b.clone(l),e.width="1/3",l.width="1/3",f.set("attrs",e),k.set("attrs",
l),e=new tdcIFrameData.TdcModel({content:"",tag:"vc_column_inner",attrs:{width:"1/3"},type:"closed",level:3,parentModel:a}),g.add(e);else{if(g.models.length)for(f=g.at(0),e=f.get("attrs"),e=b.clone(e),r=f.get("childCollection"),delete e.width,f.set("attrs",e),b.isUndefined(r)&&(r=new tdcIFrameData.TdcCollection,f.set("childCollection",r)),t=0,b.each(g.models,function(a,c,d){0!==c&&(t=c,a=a.get("childCollection"),b.isUndefined(a)||b.each(a.models,function(a){a.set("parentModel",f);r.add(a)}))});0<
t;)tdcIFrameData.removeModel(g.at(t)),t--}else{if("13"===d&&g.models.length)for(f=g.at(0),e=f.get("attrs"),e=b.clone(e),r=f.get("childCollection"),delete e.width,f.set("attrs",e),b.isUndefined(r)&&(r=new tdcIFrameData.TdcCollection,f.set("childCollection",r)),t=0,b.each(g.models,function(a,c,d){0!==c&&(t=c,a=a.get("childCollection"),b.isUndefined(a)||b.each(a.models,function(a,c,b){a.set("parentModel",f);r.add(a)}))});0<t;)tdcIFrameData.removeModel(g.at(t)),t--}else if("13"===c)if("11"===d)if(""===
h||"12_12"!==h&&"23_13"!==h&&"13_23"!==h&&"13_13_13"!==h){if(g.models.length)for(f=g.at(0),e=f.get("attrs"),e=b.clone(e),r=f.get("childCollection"),delete e.width,f.set("attrs",e),b.isUndefined(r)&&(r=new tdcIFrameData.TdcCollection,f.set("childCollection",r)),t=0,b.each(g.models,function(a,c,d){0!==c&&(t=c,a=a.get("childCollection"),b.isUndefined(a)||b.each(a.models,function(a,c,b){a.set("parentModel",f);r.add(a)}))});0<t;)tdcIFrameData.removeModel(g.at(t)),t--}else"12_12"===h&&g.models.length&&
(f=g.at(0),k=g.at(1),e=f.get("attrs"),l=k.get("attrs"),e.width="1/3",l.width="1/3",f.set("attrs",e),k.set("attrs",l),g.add(new tdcIFrameData.TdcModel({content:"",tag:"vc_column_inner",attrs:{width:"1/3"},type:"closed",level:1,parentModel:a})));else if("23"===d&&(""===h||"12_12"!==h)&&g.models.length)for(f=g.at(0),e=f.get("attrs"),e=b.clone(e),r=f.get("childCollection"),delete e.width,f.set("attrs",e),b.isUndefined(r)&&(r=new tdcIFrameData.TdcCollection,f.set("childCollection",r)),t=0,b.each(g.models,
function(a,c,d){0!==c&&(t=c,a=a.get("childCollection"),b.isUndefined(a)||b.each(a.models,function(a,c,b){a.set("parentModel",f);r.add(a)}))});0<t;)tdcIFrameData.removeModel(g.at(t)),t--}})}}},changeInnerRowModel:function(a,c,d){if(!(b.isUndefined(a)||b.isUndefined(c)||b.isUndefined(d))){var g=a.get("childCollection");if("11"===c&&("12_12"===d||"23_13"===d||"13_23"===d||"13_13_13"===d)){var e=new tdcIFrameData.TdcModel({content:"",tag:"vc_column_inner",type:"closed",level:3,parentModel:a});var f=d.split("_");
var h=f[0].charAt(0)+"/"+f[0].charAt(1);c=f[1].charAt(0)+"/"+f[1].charAt(1);var m=g.at(0);var n=m.get("attrs");b.isUndefined(n)?m.set("attrs",{width:h}):(n=b.clone(n),n.width=h,m.set("attrs",n));e.set("attrs",{width:c});g.add(e);3===f.length&&g.add(new tdcIFrameData.TdcModel({content:"",tag:"vc_column_inner",attrs:{width:f[2].charAt(0)+"/"+f[2].charAt(1)},type:"closed",level:3,parentModel:a}))}else if("12_12"===c||"23_13"===c||"13_23"===c)if("11"===d){m=g.at(0);n=m.get("attrs");var p=m.get("childCollection");
e=g.at(1);var u=e.get("childCollection");b.isUndefined(n)||(n=b.clone(n),delete n.width,m.set("attrs",n));b.isUndefined(p)&&(p=new tdcIFrameData.TdcCollection,m.set("childCollection",p));!b.isUndefined(u)&&u.length&&b.each(u.models,function(a,c,b){a.set("parentModel",m);p.add(a)});tdcIFrameData.removeModel(e)}else{if("12_12"===d||"23_13"===d||"13_23"===d||"13_13_13"===d)f=d.split("_"),h=f[0].charAt(0)+"/"+f[0].charAt(1),c=f[1].charAt(0)+"/"+f[1].charAt(1),m=g.at(0),n=m.get("attrs"),e=g.at(1),d=e.get("attrs"),
n=b.clone(n),n.width=h,m.set("attrs",n),d=b.clone(d),d.width=c,e.set("attrs",d),3===f.length&&g.add(new tdcIFrameData.TdcModel({content:"",tag:"vc_column_inner",attrs:{width:f[2].charAt(0)+"/"+f[2].charAt(1)},type:"closed",level:3,parentModel:a}))}else if("13_13_13"===c)if("11"===d)m=g.at(0),n=m.get("attrs"),p=m.get("childCollection"),e=g.at(1),u=e.get("childCollection"),g=g.at(2),a=g.get("childCollection"),b.isUndefined(n)||(n=b.clone(n),delete n.width,m.set("attrs",n)),b.isUndefined(p)&&(p=new tdcIFrameData.TdcCollection,
m.set("childCollection",p)),!b.isUndefined(u)&&u.length&&b.each(u.models,function(a,c,b){a.set("parentModel",m);p.add(a)}),!b.isUndefined(a)&&a.length&&b.each(a.models,function(a,c,b){a.set("parentModel",m);p.add(a)}),tdcIFrameData.removeModel(e),tdcIFrameData.removeModel(g);else if("12_12"===d||"23_13"===d||"13_23"===d)f=d.split("_"),h=f[0].charAt(0)+"/"+f[0].charAt(1),c=f[1].charAt(0)+"/"+f[1].charAt(1),m=g.at(0),n=m.get("attrs"),e=g.at(1),d=e.get("attrs"),u=e.get("childCollection"),g=g.at(2),a=
g.get("childCollection"),n=b.clone(n),n.width=h,m.set("attrs",n),d=b.clone(d),d.width=c,e.set("attrs",d),b.isUndefined(u)&&(u=new tdcIFrameData.TdcCollection,e.set("childCollection",u)),!b.isUndefined(a)&&a.length&&b.each(a.models,function(a,c,b){a.set("parentModel",e);u.add(a)}),tdcIFrameData.removeModel(g)}},getChildCollectionWidths:function(a){if(!b.isUndefined(a)){var c;b.map(a.models,function(a,d){var g=a.get("attrs");b.has(g,"width")&&(c=b.isUndefined(c)?g.width.replace("/",""):c+("_"+g.width.replace("/",
"")))});return c}}}})(jQuery,Backbone,_);var tdcAdminIFrameUI;
(function(f,e,b,d){tdcAdminIFrameUI={_liveIframeWindowObject:d,_$liveIframe:d,getIframeWindow:function(){b.isUndefined(tdcAdminIFrameUI._liveIframeWindowObject)&&new tdcNotice.notice("tdcAdminIFrameUI._liveIframeWindowObject is undefined. AKA: The iFrame window object is undefined. The iFrame was probably not added to the page!",!0,!1);return tdcAdminIFrameUI._liveIframeWindowObject},getLiveIframe:function(){return tdcAdminIFrameUI._$liveIframe},evalInIframe:function(a){tdcAdminIFrameUI.getIframeWindow().eval(a)},
initContent:function(a){a.find(".tdc-row").length||(a.find(".tdc-content-wrap").prepend('<div class="tdc-row"><div class="vc_row wpb_row td-pb-row"><div class="tdc-column"><div class="td-pb-span12 wpb_column vc_column_container"><div class="wpb_wrapper"></div></div></div></div></div>'),window.tdcPostSettings.postContent+="[vc_row][vc_column][/vc_column][/vc_row]")},init:function(){window.addWrappers=function(a){a=a.find(".td-main-content-wrap");a.find(".tdc-row").wrapAll('<div id="tdc-rows"></div>').each(function(a,
c){f(c).find(".tdc-column").wrapAll('<div class="tdc-columns"></div>')});a.find(".tdc-column").each(function(a,c){var b=f(c);b.find(".tdc-inner-row").wrap('<div class="tdc-element-inner-row"></div>');b=b.find(".td_block_wrap");window.checkTdBlockWrap(b);b.wrap('<div class="tdc-element"></div>')});a.find(".tdc-inner-row").each(function(a,c){f(c).find(".tdc-inner-column").wrapAll('<div class="tdc-inner-columns"></div>').each(function(a,c){var b=f(c).find(".tdc-element");b.length?b.addClass("tdc-element-inner-column").wrapAll('<div class="tdc-elements"></div>'):
(b=f(c).find(".wpb_wrapper"),b.length&&b.append('<div class="tdc-elements"></div>'))})});a.find(".tdc-element, .tdc-element-inner-row").each(function(a,c){var b=f(c);b.length&&b.not(".tdc-element-inner-column").addClass("tdc-element-column")});a.find(".tdc-column").each(function(a,c){var b=f(c).find(".tdc-element, .tdc-element-inner-row");b.length?b.not(".tdc-element-inner-column").wrapAll('<div class="tdc-elements"></div>'):(b=f(c).find(".wpb_wrapper"),b.length&&b.append('<div class="tdc-elements"></div>'))});
a.find(".tdc-elements:empty").each(function(a,c){var b="",d=f(c);d.closest(".tdc-inner-column").length?b=" tdc-element-inner-column":d.closest(".tdc-column").length&&(b=" tdc-element-column");b=f('<div class="'+tdcOperationUI._emptyElementClass+b+'" title="Empty element that should be removed by composer"></div>');tdcElementUI.bindEmptyElement(b);d.append(b)})};window.addRowWrappers=function(a){a.find(".tdc-column").wrapAll('<div class="tdc-columns"></div>');a.find(".tdc-column").each(function(a,
c){var b=f(c);b.find(".tdc-inner-row").wrap('<div class="tdc-element-inner-row"></div>');b=b.find(".td_block_wrap");window.checkTdBlockWrap(b);b.wrap('<div class="tdc-element"></div>')});a.find(".tdc-inner-row").each(function(a,c){f(c).find(".tdc-inner-column").wrapAll('<div class="tdc-inner-columns"></div>').each(function(a,c){var b=f(c).find(".tdc-element");b.length?b.addClass("tdc-element-inner-column").wrapAll('<div class="tdc-elements"></div>'):(b=f(c).find(".wpb_wrapper"),b.length&&b.append('<div class="tdc-elements"></div>'))})});
a.find(".tdc-element, .tdc-element-inner-row").each(function(a,c){var b=f(c);b.length&&b.not(".tdc-element-inner-column").addClass("tdc-element-column")});a.find(".tdc-column").each(function(a,c){var b=f(c).find(".tdc-element, .tdc-element-inner-row");b.length?b.not(".tdc-element-inner-column").wrapAll('<div class="tdc-elements"></div>'):(b=f(c).find(".wpb_wrapper"),b.length&&b.append('<div class="tdc-elements"></div>'))});a.find(".tdc-elements:empty").each(function(a,c){var b="",d=f(c);d.closest(".tdc-inner-column").length?
b=" tdc-element-inner-column":d.closest(".tdc-column").length&&(b=" tdc-element-column");b=f('<div class="'+tdcOperationUI._emptyElementClass+b+'" title="Empty element that should be removed by composer"></div>');tdcElementUI.bindEmptyElement(b);d.append(b)})};window.addColumnWrappers=function(a){a.find(".tdc-inner-row").wrap('<div class="tdc-element-inner-row"></div>');var c=a.find(".td_block_wrap");window.checkTdBlockWrap(c);c.wrap('<div class="tdc-element"></div>');a.find(".tdc-inner-row").each(function(a,
c){f(c).find(".tdc-inner-column").wrapAll('<div class="tdc-inner-columns"></div>').each(function(a,c){var b=f(c).find(".tdc-element");b.length?b.addClass("tdc-element-inner-column").wrapAll('<div class="tdc-elements"></div>'):(b=f(c).find(".wpb_wrapper"),b.length&&b.append('<div class="tdc-elements"></div>'))})});a.find(".tdc-element, .tdc-element-inner-row").each(function(a,c){var b=f(c);b.length&&b.not(".tdc-element-inner-column").addClass("tdc-element-column")});c=a.find(".tdc-element, .tdc-element-inner-row");
c.length?c.not(".tdc-element-inner-column").wrapAll('<div class="tdc-elements"></div>'):(c=a.find(".wpb_wrapper"),c.length&&c.append('<div class="tdc-elements"></div>'));a.find(".tdc-elements:empty").each(function(a,c){var b="",d=f(c);d.closest(".tdc-inner-column").length?b=" tdc-element-inner-column":d.closest(".tdc-column").length&&(b=" tdc-element-column");b=f('<div class="'+tdcOperationUI._emptyElementClass+b+'" title="Empty element that should be removed by composer"></div>');tdcElementUI.bindEmptyElement(b);
d.append(b)})};window.addInnerRowWrappers=function(a){var c=a.find(".td_block_wrap");window.checkTdBlockWrap(c);c.wrap('<div class="tdc-element"></div>');a.find(".tdc-inner-row").each(function(a,c){f(c).find(".tdc-inner-column").wrapAll('<div class="tdc-inner-columns"></div>').each(function(a,c){var b=f(c).find(".tdc-element");b.length?b.addClass("tdc-element-inner-column").wrapAll('<div class="tdc-elements"></div>'):(b=f(c).find(".wpb_wrapper"),b.length&&b.append('<div class="tdc-elements"></div>'))})});
a.find(".tdc-elements:empty").each(function(a,c){var b="",d=f(c);d.closest(".tdc-inner-column").length?b=" tdc-element-inner-column":d.closest(".tdc-column").length&&(b=" tdc-element-column");b=f('<div class="'+tdcOperationUI._emptyElementClass+b+'" title="Empty element that should be removed by composer"></div>');tdcElementUI.bindEmptyElement(b);d.append(b)})};window.addInnerColumnWrappers=function(a){var c=a.find(".td_block_wrap");window.checkTdBlockWrap(c);c.wrap('<div class="tdc-element"></div>');
c=a.find(".tdc-element");c.length?c.addClass("tdc-element-inner-column").wrapAll('<div class="tdc-elements"></div>'):(c=a.find(".wpb_wrapper"),c.length&&c.append('<div class="tdc-elements"></div>'));a.find(".tdc-elements:empty").each(function(a,c){var b="",d=f(c);d.closest(".tdc-inner-column").length?b=" tdc-element-inner-column":d.closest(".tdc-column").length&&(b=" tdc-element-column");b=f('<div class="'+tdcOperationUI._emptyElementClass+b+'" title="Empty element that should be removed by composer"></div>');
tdcElementUI.bindEmptyElement(b);d.append(b)})};window.checkTdBlockWrap=function(a){a.each(function(a,c){var b=f(c);0===parseInt(b.height())&&b.addClass("tdc-block-empty")})};var a=window.tdcPostSettings.postMetaVcJsStatus,c=window.tdcPostSettings.postContent;"1"!==window.tdcPostSettings.postMetaDirtyContent&&"true"!==a||""===c||new tdcNotice.notice("The current content page hasn't been created by TagDiv Composer!",!1,!1);tdcAdminIFrameUI.checkIframe(tdcAdminIFrameUI._$liveIframe)},loadIframe:function(){var a=
f(this).contents();tdcAdminIFrameUI.initContent(a);tdcAdminIFrameUI._liveIframeWindowObject=f(this).get(0).contentWindow;var c=f('<div id="tdc-recycle"><div class="tdc-delete-text"><span>Delete</span></div></div>');a.find("body").prepend(c);tdcAdminWrapperUI.$recycle=c;tdcIFrameData._postOriginalContentJSON=d;window.addWrappers(a);tdcIFrameData.init(a,!0);tdcOperationUI.init(a,!0);a.on("click","a",function(a){a.preventDefault();"undefined"!==this.href&&window.open(this.href,"_blank")});a[0].addEventListener("mousedown",
function(a){1!==a.which&&a.stopPropagation()},!0);a[0].addEventListener("mousemove",function(c){a.lastMouseEvent=c},!0)},checkIframe:function(a){if(b.isUndefined(a))a=window.tdcPostSettings.postUrl,a=0>a.indexOf("?")?a+("?td_action=tdc_edit&post_id="+window.tdcPostSettings.postId):a+("&td_action=tdc_edit&post_id="+window.tdcPostSettings.postId),a=f('<iframe id="tdc-live-iframe" name="tdc-live-iframe" src="'+a+'" scrolling="auto" style="width: 100%; height: 100%"></iframe>').load(tdcAdminIFrameUI.loadIframe),
f("#tdc-live-iframe-wrapper").append(a);else{var c=a,g=c.contents();tdcAdminIFrameUI.initContent(g);tdcAdminIFrameUI._liveIframeWindowObject=c.get(0).contentWindow;c=f('<div id="tdc-recycle"><div class="tdc-delete-text"><span>Delete</span></div></div>');g.find("body").prepend(c);tdcAdminWrapperUI.$recycle=c;tdcIFrameData._postOriginalContentJSON=d;window.addWrappers(g);tdcIFrameData.init(g,!0);tdcOperationUI.init(g,!0);g.find("a").each(function(a,c){c.setAttribute("target","_blank")});a.removeClass("tdc-live-iframe");
a.removeClass("tdc-live-iframe-temp")}tdcAdminIFrameUI._$liveIframe=a}}})(jQuery,Backbone,_);var tdcMain={};
(function(){tdcMain={_contentModified:!1,_sidebarInline:!1,_sidebarHidden:!1,_recycleShown:!1,init:function(){tdcAdminIFrameUI.init()},getContentModified:function(){return tdcMain._contentModified},setContentModified:function(){tdcMain._contentModified=!0},resetContentModified:function(){tdcMain._contentModified=!1},setSidebarInline:function(){tdcMain._sidebarInline=!0},getSidebarInline:function(){return tdcMain._sidebarInline},resetSidebarInline:function(){tdcMain._sidebarInline=!1},setSidebarHidden:function(){tdcMain._sidebarHidden=
!0},getSidebarHidden:function(){return tdcMain._sidebarHidden},resetSidebarHidden:function(){tdcMain._sidebarHidden=!1},setRecycleShown:function(){tdcMain._recycleShown=(tdcOperationUI.isRowDragged()||tdcOperationUI.isInnerRowDragged()||tdcOperationUI.isElementDragged())&&!tdcOperationUI.isSidebarElementDragged()},getRecycleShown:function(){return tdcMain._recycleShown},resetRecycleShown:function(){tdcMain._recycleShown=!1}};tdcMain.init()})();var tdcSidebarPanel={};
(function(f){tdcSidebarPanel={_defaultGroupName:"General",_currentBoundModel:f,_hook:{_hooks:[],addAction:function(e,b){_.isUndefined(tdcSidebarPanel._hook._hooks[e])&&(tdcSidebarPanel._hook._hooks[e]=[]);tdcSidebarPanel._hook._hooks[e].push(b)},doAction:function(e,b){if(!_.isUndefined(tdcSidebarPanel._hook._hooks[e]))for(var d=0;d<tdcSidebarPanel._hook._hooks[e].length;d++)tdcSidebarPanel._hook._hooks[e][d](b)},removeAction:function(e){_.isUndefined(tdcSidebarPanel._hook._hooks[e])||delete tdcSidebarPanel._hook._hooks[e]}},
init:function(){var e=jQuery("body");e.on("change focus",".tdc-tab-no-design .tdc-property-dropdown:not(.tdc-row-col-dropdown):not(.tdc-innerRow-col-dropdown) select",function(b){if("focusin"===b.type||"focus"===b.type)this.oldValue=this.value;else{var d=jQuery(this);b=d.val();var a=tdcIFrameData.getModel(d.data("model_id")),d=d.data("param_name");tdcSidebarController.onUpdate(a,d,this.oldValue,b);this.oldValue=b;"block_template_id"===d&&setTimeout(function(){tdcSidebar.setSettings({$currentRow:tdcSidebar.getCurrentRow(),
$currentColumn:tdcSidebar.getCurrentColumn(),$currentInnerRow:tdcSidebar.getCurrentInnerRow(),$currentInnerColumn:tdcSidebar.getCurrentInnerColumn(),$currentElement:tdcSidebar.getCurrentElement()},!0)},500)}});e.on("keyup focus",".tdc-tab-no-design .tdc-property-textfield input",function(b){if("focusin"===b.type)this.oldValue=this.value;else{b=jQuery(this).val();var d=tdcIFrameData.getModel(jQuery(this).data("model_id"));tdcSidebarController.onUpdate(d,jQuery(this).data("param_name"),this.oldValue,
_.escape(b));this.oldValue=b}});e.on("focus change",".tdc-tab-no-design .tdc-property-checkbox input",function(b){if("focusin"===b.type)this.oldValue=this.value;else{b=jQuery(this);var d=b.val();b.is(":checked")||(d="");var a=tdcIFrameData.getModel(b.data("model_id"));tdcSidebarController.onUpdate(a,b.data("param_name"),this.oldValue,d);this.oldValue=d}});e.on("click",".tdc-tab-no-design .tdc-image-wrap",tdcSidebarPanel.tdcImageWrapHandler);e.on("click",".tdc-tab-no-design .tdc-image-remove",tdcSidebarPanel.tdcImageRemoveHandler);
e.on("change keyup focus",".tdc-tab-no-design .tdc-property-colorpicker input",function(b){if("focusin"===b.type)this.oldValue=this.value;else{b=jQuery(this).val();var d=tdcIFrameData.getModel(jQuery(this).data("model_id"));tdcSidebarController.onUpdate(d,jQuery(this).data("param_name"),this.oldValue,b);this.oldValue=b}});e.on("change focus",".tdc-tab-no-design .tdc-row-col-dropdown select",function(b){if("focusin"===b.type||"focus"===b.type)this.oldValue=this.value;else{b=jQuery(this).val();var d=
tdcSidebar.getCurrentRow().data("model_id"),d=tdcIFrameData.getModel(d);"11"===this.oldValue&&("23_13"===b||"13_23"===b||"13_13_13"===b)||"23_13"===this.oldValue&&("11"===b||"13_23"===b||"13_13_13"===b)||"13_23"===this.oldValue&&("11"===b||"23_13"===b||"13_13_13"===b)||"13_13_13"===this.oldValue&&("11"===b||"23_13"===b||"13_23"===b)?(tdcIFrameData.changeRowModel(d,this.oldValue,b),d.getShortcodeRender(1,null,!0)):new tdcNotice.notice("Invalid row change detected: this.oldValue:"+this.oldValue+" and curValue: "+
b,!1,!0);this.oldValue=b}});e.on("change",".tdc-tab-no-design .tdc-row-col-dropdown input.tdc-property-input-radio",function(b){"undefined"!==typeof tdcSidebarPanel.timerChangingColumns&&clearTimeout(tdcSidebarPanel.timerChangingColumns);var d=jQuery(this);tdcSidebarPanel.timerChangingColumns=setTimeout(function(){var a=d.val(),c=tdcSidebar.getCurrentRow().data("model_id"),c=tdcIFrameData.getModel(c),b=c.get("childCollection");this.oldValue="11";_.isUndefined(b)||(b=tdcIFrameData.getChildCollectionWidths(b),
_.isUndefined(b)||(this.oldValue=b));"11"===this.oldValue&&("23_13"===a||"13_23"===a||"13_13_13"===a)||"23_13"===this.oldValue&&("11"===a||"13_23"===a||"13_13_13"===a)||"13_23"===this.oldValue&&("11"===a||"23_13"===a||"13_13_13"===a)||"13_13_13"===this.oldValue&&("11"===a||"23_13"===a||"13_23"===a)?(tdcIFrameData.changeRowModel(c,this.oldValue,a),c.getShortcodeRender(1,null,!0)):this.oldValue!==a&&new tdcNotice.notice("Invalid row change detected: this.oldValue:"+this.oldValue+" and curValue: "+a,
!1,!0);this.oldValue=a},300)});e.on("change focus",".tdc-tab-no-design .tdc-innerRow-col-dropdown select",function(b){if("focusin"===b.type||"focus"===b.type)this.oldValue=this.value;else{b=jQuery(this).val();var d=tdcSidebar._$currentInnerRow.data("model_id"),d=tdcIFrameData.getModel(d);tdcIFrameData.changeInnerRowModel(d,this.oldValue,b);d.getShortcodeRender(tdcIFrameData.getColumnNumber(d),null,!0);this.oldValue=b}});e.on("change",".tdc-tab-no-design .tdc-innerRow-col-dropdown input.tdc-property-input-radio",
function(b){"undefined"!==typeof tdcSidebarPanel.timerChangingInnerColumns&&clearTimeout(tdcSidebarPanel.timerChangingInnerColumns);var d=jQuery(this);tdcSidebarPanel.timerChangingInnerColumns=setTimeout(function(){var a=d.val(),c=tdcSidebar._$currentInnerRow.data("model_id"),c=tdcIFrameData.getModel(c),b=c.get("childCollection");this.oldValue="11";_.isUndefined(b)||(b=tdcIFrameData.getChildCollectionWidths(b),_.isUndefined(b)||(this.oldValue=b));tdcIFrameData.changeInnerRowModel(c,this.oldValue,
a);c.getShortcodeRender(tdcIFrameData.getColumnNumber(c),null,!0);this.oldValue=a},300)});e.on("change focus",".tdc-tab-no-design .tdc-widget-sidebar-dropdown select",function(b){if("focusin"===b.type||"focus"===b.type)this.oldValue=this.value;else{b=jQuery(this).val();var d=tdcIFrameData.getModel(jQuery(this).data("model_id"));tdcSidebarController.onUpdate(d,jQuery(this).data("param_name"),this.oldValue,b);this.oldValue=b}});e.on("click",".tdc-tab-no-design .tdc-open-wpeditor",function(b){b.preventDefault();
var d=jQuery(this);b=jQuery("#tdc-wpeditor");var a=b.children(".content"),c=d.data("mapped_parameter_name"),d=d.data("model_id"),g=tdcIFrameData.getModel(d).get("parentModel").get("attrs"),e="tdc-three-column";if(_.has(g,"width"))switch(g.width){case "1/3":e="tdc-one-column";break;case "2/3":e="tdc-two-column"}a.addClass("tdc-dropped-wpeditor");a.html('<iframe id="tdc-iframe-wpeditor" class="'+e+'" src="'+window.tdcAdminSettings.pluginUrl+'/includes/wpeditor.php" scrolling="auto" style="width: 100%; height: 100%" data-model_id="'+
d+'" data-mapped_parameter_name="'+c+'"></iframe>');b.show();tdcWindowFrame.setWindowFrame(b)});e.on("click","#tdc-wpeditor .tdc-iframe-close-button",function(b){b.preventDefault();jQuery("#tdc-wpeditor").hide()});e.on("click",".tdc-sidebar-delete-row",tdcRowHandlerUI.deleteHandler);e.on("click",".tdc-sidebar-delete-inner-row",tdcInnerRowHandlerUI.deleteHandler);e.on("click",".tdc-sidebar-clone-row",tdcRowHandlerUI.cloneHandler);e.on("click",".tdc-sidebar-clone-inner-row",tdcInnerRowHandlerUI.cloneHandler)},
tdcImageWrapHandler:function(e){var b=jQuery(e.currentTarget);b.closest(".tdc-tab-content");window.original_send_to_editor=window.send_to_editor;wp.media.editor.open(b);jQuery(".media-menu .media-menu-item:nth-of-type(2)").addClass("hidden");jQuery(".media-menu .media-menu-item:nth-of-type(3)").addClass("hidden");jQuery(".media-menu .media-menu-item:nth-of-type(4)").addClass("hidden");window.send_to_editor=function(d){var a=jQuery("img",d).attr("src"),c="";"undefined"===typeof a?(a=jQuery(d).attr("src"),
c=jQuery(d).attr("class")):c=jQuery("img",d).attr("class");jQuery.ajax({timeout:1E4,type:"POST",url:tdcUtil.getRestEndPoint("td-composer/get_image_id","uuid="+tdcJobManager._getUniqueID()),beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",window.tdcAdminSettings.wpRestNonce)},dataType:"json",data:{image_class:c,action:"tdc_ajax_get_image_id"}}).done(function(c,d,e){"success"===d&&(_.isObject(c)&&_.has(c,"errors")?new tdcNotice.notice(c.errors,!0,!1):(b.closest(".tdc-property").find(".tdc-image-remove").removeClass("tdc-hidden-button"),
b.attr("style","background-image: url( '"+a+"') "),b.data("image_link",a),b.data("image_id",c.image_id),b.removeClass("tdc-no-image-selected"),window.send_to_editor=window.original_send_to_editor,window.tb_remove(),d="",e=b.data("model_id"),e=tdcIFrameData.getModel(e),b.hasClass("tdc-no-image-selected")||(d=c.image_id.toString()),tdcSidebarController.onUpdate(e,b.data("param_name"),"",d)))}).fail(function(a,c,b){})};return!1},tdcImageRemoveHandler:function(e){var b=jQuery(e.currentTarget);e=b.closest(".tdc-property-wrap").find(".tdc-image-wrap");
b.addClass("tdc-hidden-button");e.addClass("tdc-no-image-selected");jQuery.removeData(e,"image_link");e.attr("style","background-image: url( '"+window.tdcAdminSettings.pluginUrl+"/assets/images/sidebar/no_img.png'");b=e.data("model_id");b=tdcIFrameData.getModel(b);tdcSidebarController.onUpdate(b,e.data("param_name"),"","")},bindPanelToModel:function(e,b){if(_.isUndefined(tdcSidebarPanel._currentBoundModel)||tdcSidebarPanel._currentBoundModel.cid!==e.cid||!_.isUndefined(b)&&(_.isUndefined(b)||!0===
b)){var d=window.tdcAdminSettings.mappedShortcodes[e.attributes.tag];tdcSidebarPanel._deletePanel();jQuery(".tdc-empty-sidebar").hide();tdcSidebarPanel._currentBoundModel=e;for(var a=[],c=0;c<d.params.length;c++){var g=tdcSidebarPanel._defaultGroupName;_.isEmpty(d.params[c].group)||(g=d.params[c].group);a.push(g)}var a=_.uniq(a),f=g="",k=tdcSidebar.getCurrentTabId(),q,h,g=g+'<div class="tdc-tabs">';var m=h=q="";for(c=0;c<a.length;c++){f=tdcSidebarPanel._fixGroupName(a[c]);var n=tdcUtil.makeSafeForCSS(f);
0===c?(q='<a href="#" data-tab-id="td-tab-'+n+'" class="tdc-tab-active" title="'+f+' settings">'+f+"</a>",h='<a href="#" data-tab-id="td-tab-'+n+'" title="'+f+' settings">'+f+"</a>"):_.isUndefined(k)||k!=="td-tab-"+n?m+='<a href="#" data-tab-id="td-tab-'+n+'" title="'+f+' settings">'+f+"</a>":(q=h,m+='<a href="#" data-tab-id="td-tab-'+n+'" class="tdc-tab-active" title="'+f+' settings">'+f+"</a>")}g=g+(q+m)+'</div><div class="tdc-tab-content-wrap">';m=h=q="";for(c=0;c<a.length;c++)f=tdcSidebarPanel._fixGroupName(a[c]),
n=tdcUtil.makeSafeForCSS(f),f="tdc-tab-no-design","css"===n&&(f="tdc-tab-design"),0===c?(q='<div class="tdc-tab-content tdc-tab-content-visible '+f+'" id="td-tab-'+n+'">',h='<div class="tdc-tab-content '+f+'" id="td-tab-'+n+'">'):_.isUndefined(k)||k!=="td-tab-"+n?m+='<div class="tdc-tab-content '+f+'" id="td-tab-'+n+'">':(q=h,m+='<div class="tdc-tab-content tdc-tab-content-visible '+f+'" id="td-tab-'+n+'">'),m+=tdcSidebarPanel._bindGroupAndGetHtml(a[c],d,e),n=' data-model_id="'+e.cid+'" ',"vc_row"===
e.attributes.tag?(m+='<div class="tdc-sidebar-row-buttons">',m+='<div class="tdc-sidebar-button tdc-sidebar-delete-row" '+n+' title="Delete the current selected Row">Delete Row</div>',m+='<div class="tdc-sidebar-button tdc-sidebar-clone-row" '+n+' title="Make a copy of the current selected Row. The copy will appear below the current Row">Clone Row</div>',m+="</div>"):"vc_row_inner"===e.attributes.tag&&(m+='<div class="tdc-sidebar-row-buttons">',m+='<div class="tdc-sidebar-button tdc-sidebar-delete-inner-row" '+
n+' title="Delete the current selected Inner Row">Delete Inner Row</div>',m+='<div class="tdc-sidebar-button tdc-sidebar-clone-inner-row" '+n+' title="Make a copy of the current selected Inner Row. The copy will appear below the current Inner Row">Clone Inner Row</div>',m+="</div>"),m+="</div>";g=g+(q+m)+"</div>";jQuery(".tdc-inspector .tdc-tabs-wrapper").html(g);jQuery(".tdc-inspector-wrap").addClass("tdc-inspector-active");jQuery(".tdc-breadcrumbs").show();tdcSidebarPanel._hook.doAction("panel_rendered");
tdcSidebarPanel._hook.doAction("panel_css");(function(){if("vc_row"===e.get("tag")){var a=jQuery("body .tdc-row-col-dropdown select"),c=jQuery("body .tdc-row-stretch-dropdown select"),b=e.get("childCollection");if(!_.isUndefined(b)){b=tdcIFrameData.getChildCollectionWidths(b);_.isUndefined(b)&&(b="11");a.length?a.val(b):(a=jQuery("body .tdc-row-col-dropdown input[value='"+b+"']"),a.length&&a.attr("checked","checked"));var a=e.get("attrs");if(_.has(a,"full_width"))var d=a.full_width;_.isUndefined(d)&&
(d="");c.val(d)}}})();(function(){if("vc_row_inner"===e.get("tag")){var a=jQuery("body .tdc-innerRow-col-dropdown select"),c=e.get("childCollection");if(!_.isUndefined(c)){c=tdcIFrameData.getChildCollectionWidths(c);_.isUndefined(c)&&(c="11");var b=e.get("parentModel").get("attrs"),d="";_.has(b,"width")&&(d=b.width.replace("/",""));if(a.length)switch(a.val(c),d){case "":a.find("option[value=12_12]").hide();a.find("option[value=23_13]").show();a.find("option[value=13_23]").show();a.find("option[value=13_13_13]").show();
break;case "13":a.find("option[value=12_12]").hide();a.find("option[value=23_13]").hide();a.find("option[value=13_23]").hide();a.find("option[value=13_13_13]").hide();break;case "23":a.find("option[value=12_12]").show(),a.find("option[value=23_13]").hide(),a.find("option[value=13_23]").hide(),a.find("option[value=13_13_13]").hide()}else if(a=jQuery('body .tdc-innerRow-col-dropdown input[value="'+c+'"]'),a.length)switch(a.attr("checked","checked"),a.next("label").show(),d){case "":a.parent().find("input[value=12_12] + label").hide();
a.parent().find("input[value=23_13] + label").show();a.parent().find("input[value=13_23] + label").show();a.parent().find("input[value=13_13_13] + label").show();break;case "13":a.parent().find("input[value=12_12] + label").hide();a.parent().find("input[value=23_13] + label").hide();a.parent().find("input[value=13_23] + label").hide();a.parent().find("input[value=13_13_13] + label").hide();break;case "23":a.parent().find("input[value=12_12] + label").show(),a.parent().find("input[value=23_13] + label").hide(),
a.parent().find("input[value=13_23] + label").hide(),a.parent().find("input[value=13_13_13] + label").hide()}}}})()}},_bindGroupAndGetHtml:function(e,b,d){var a="",c=window.tdcAdminSettings.mappedBlockTemplates,g=d.get("attrs");if(_.has(g,"block_template_id")&&!_.isEmpty(g.block_template_id)){for(var g=g.block_template_id,f,k,q,h=0;h<b.params.length;h++)"custom_title"===b.params[h].param_name?f=h:"custom_url"===b.params[h].param_name?k=h:"block_template_id"===b.params[h].param_name&&(q=h);_.isUndefined(f)||
(e===tdcSidebarPanel._defaultGroupName?_.isEmpty(b.params[f].group)&&(a+=tdcSidebarPanel._bindParamAndGetHtml(b.params[f],d)):b.params[f].group===e&&(a+=tdcSidebarPanel._bindParamAndGetHtml(b.params[f],d)));_.isUndefined(k)||(e===tdcSidebarPanel._defaultGroupName?_.isEmpty(b.params[k].group)&&(a+=tdcSidebarPanel._bindParamAndGetHtml(b.params[k],d)):b.params[k].group===e&&(a+=tdcSidebarPanel._bindParamAndGetHtml(b.params[k],d)));_.isUndefined(q)||(e===tdcSidebarPanel._defaultGroupName?_.isEmpty(b.params[q].group)&&
(a+=tdcSidebarPanel._bindParamAndGetHtml(b.params[q],d)):b.params[q].group===e&&(a+=tdcSidebarPanel._bindParamAndGetHtml(b.params[q],d)));for(h=0;h<c[g].params.length;h++)e===tdcSidebarPanel._defaultGroupName?_.isEmpty(c[g].params[h].group)&&(a+=tdcSidebarPanel._bindParamAndGetHtml(c[g].params[h],d)):c[g].params[h].group===e&&(a+=tdcSidebarPanel._bindParamAndGetHtml(c[g].params[h],d));for(h=0;h<b.params.length;h++)_.isEmpty(b.params[h].td_type)&&"custom_title"!==b.params[h].param_name&&"custom_url"!==
b.params[h].param_name&&"block_template_id"!==b.params[h].param_name&&(e===tdcSidebarPanel._defaultGroupName?_.isEmpty(b.params[h].group)&&(a+=tdcSidebarPanel._bindParamAndGetHtml(b.params[h],d)):b.params[h].group===e&&(a+=tdcSidebarPanel._bindParamAndGetHtml(b.params[h],d)))}else for(h=0;h<b.params.length;h++)e===tdcSidebarPanel._defaultGroupName?_.isEmpty(b.params[h].group)&&(a+=tdcSidebarPanel._bindParamAndGetHtml(b.params[h],d)):b.params[h].group===e&&(a+=tdcSidebarPanel._bindParamAndGetHtml(b.params[h],
d));return a},_bindParamAndGetHtml:function(e,b){switch(e.type){case "colorpicker":return tdcSidebarPanel.addColorpicker(e,b);case "dropdown":return tdcSidebarPanel.addDropDown(e,b);case "checkbox":return tdcSidebarPanel.addCheckBox(e,b);case "attach_image":return tdcSidebarPanel.addUploadImage(e,b);case "textfield":return tdcSidebarPanel.addTextField(e,b);case "textarea_html":return tdcSidebarPanel.addTextAreaHtml(e,b);case "textarea_raw_html":return tdcSidebarPanel.addTextAreaRawHtml(e,b);case "css_editor":return"";
case "tdc_css_editor":return tdcCssEditor.init(),tdcCssEditor.addComposerCssEditor(e,b);case "horizontal_separator":return tdcSidebarPanel.addSeparatorHorizontal(e,b);default:return e.param_name+" - "+e.type+"<br>"}},_deletePanel:function(){tdcDebug.log("clear _deletePanel ");tdcSidebarPanel._hook._hooks=[];tdcSidebarPanel._currentBoundModel=f;jQuery(".tdc-breadcrumbs").hide();jQuery(".tdc-inspector .tdc-current-element-head").empty();jQuery(".tdc-inspector .tdc-tabs-wrapper").empty();jQuery(".tdc-inspector-wrap").removeClass("tdc-inspector-active");
jQuery(".tdc-empty-sidebar").show();tdcSidebar.$_currentElementSiblings.removeClass("tdc-current-element-siblings-visible");tdcSidebar.$_currentElementHead.removeClass("tdc-current-element-siblings-button-on");tdcSidebar.hideWpeditor()},_getParameterClasses:function(e){var b="tdc-property-wrap tdc-property-"+e.type;b+=" tdc-property-"+e.param_name;_.isUndefined(e["class"])||(b+=" "+e["class"]);return b},_getParameterCurrentValue:function(e,b){return _.isEmpty(b.get("attrs")[e.param_name])?"dropdown"===
e.type||_.isEmpty(e.value)?"":e.value:b.get("attrs")[e.param_name]},_getParameterDomName:function(e){return"tdc-param-"+e.param_name},_getParamterDataAtts:function(e,b){var d="";if("undefined"===typeof b)return d;d+=' data-model_id="'+b.cid+'"';"undefined"!==typeof e&&(d+=' data-param_name="'+e.param_name+'"');return d},_fixGroupName:function(e){switch(e){case "Design options":return"Css";case "Pagination":return"Extra";case "Ajax filter":return"Ajax"}return e},clearPanel:function(){tdcSidebarPanel._deletePanel()},
addColorpicker:function(e,b){var d="";_.has(e,"description")&&""!==e.description&&(d=' title="'+e.description+'" ');var a="",c=_.uniqueId(),a=a+('<div class="'+tdcSidebarPanel._getParameterClasses(e)+'">'),a=a+('<div class="tdc-property-title"><span'+d+">"+e.heading+"</span></div>"),a=a+'<div class="tdc-property">'+("<input "+tdcSidebarPanel._getParamterDataAtts(e,b)+' id="'+c+'" name="'+tdcSidebarPanel._getParameterDomName(e)+'" type="text" value="'+tdcSidebarPanel._getParameterCurrentValue(e,b)+
'"/>'),a=a+"</div></div>";tdcSidebarPanel._hook.addAction("panel_rendered",function(){jQuery("#"+c).cs_wpColorPicker()});return a},addDropDown:function(e,b){var d=!0;_.has(e,"tdc_dropdown_images")&&""!==e.tdc_dropdown_images&&(d=!1);for(var a="",c="",g=Object.keys(e.value),f=0;f<g.length;f++){var k=e.value[g[f]],q=tdcSidebarPanel._getParameterCurrentValue(e,b),h="";d?(String(q)===String(k)&&(h=' selected="selected" '),c+="<option "+h+' value="'+k+'">'+g[f]+"</option>"):(String(q)===String(k)&&(h=
" checked "),q=_.uniqueId(),c+='<input class="tdc-property-input-radio" type="radio" id="'+q+'" name="'+tdcSidebarPanel._getParameterDomName(e)+'" '+h+' value="'+k+'">',c+='<label class="tdc-property-input-radio-label" for="'+q+'" title="'+g[f]+'"><div class="col_'+String(k)+'"></div></label>')}g="";_.has(e,"description")&&""!==e.description&&(g=' title="'+e.description+'" ');a+='<div class="'+tdcSidebarPanel._getParameterClasses(e)+'">';a+='<div class="tdc-property-title"><span'+g+">"+e.heading+
"</span></div>";a+='<div class="tdc-property">';d?(a+="<select "+tdcSidebarPanel._getParamterDataAtts(e,b)+' name="'+tdcSidebarPanel._getParameterDomName(e)+'">',a=a+c+"</select>"):a+=c;return a+"</div></div>"},addCheckBox:function(e,b){var d="";_.has(e,"description")&&""!==e.description&&(d=' title="'+e.description+'" ');var a="";""!==tdcSidebarPanel._getParameterCurrentValue(e,b)&&(a=" checked ");var c=""+('<div class="'+tdcSidebarPanel._getParameterClasses(e)+'">');c+='<div class="tdc-property-title"><span'+
d+">"+e.heading+"</span></div>";c=c+'<div class="tdc-property">'+("<input "+tdcSidebarPanel._getParamterDataAtts(e,b)+' name="'+tdcSidebarPanel._getParameterDomName(e)+'" type="checkbox" value="yes" '+a+"/>");return c+"</div></div>"},addUploadImage:function(e,b){var d="";_.has(e,"description")&&""!==e.description&&(d=' title="'+e.description+'" ');var a=""+('<div class="'+tdcSidebarPanel._getParameterClasses(e)+'">');a+='<div class="tdc-property-title"><span'+d+">"+e.heading+"</span></div>";a=a+'<div class="tdc-property">'+
('<div class="tdc-image-wrap tdc-no-image-selected" '+tdcSidebarPanel._getParamterDataAtts(e,b)+" style=\"background-image: url('"+window.tdcAdminSettings.pluginUrl+"/assets/images/sidebar/no_img.png')\">");a+='</div><a class="tdc-image-remove tdc-hidden-button" href="#" >Remove</a></div></div>';tdcSidebarPanel._hook.addAction("panel_rendered",function(){jQuery(".tdc-image-wrap").each(function(a,d){var c=jQuery(d);if(!c.parent().parent(".tdc-bg-upload").length&&e.param_name===c.data("param_name")){var g=
tdcSidebarPanel._getParameterCurrentValue(e,b);""!==g&&jQuery.ajax({timeout:1E4,type:"POST",url:tdcUtil.getRestEndPoint("td-composer/get_image_url","uuid="+tdcJobManager._getUniqueID()),beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",window.tdcAdminSettings.wpRestNonce)},dataType:"json",data:{image_id:g,action:"tdc_ajax_get_image_url"}}).done(function(a,b,d){"success"===b&&(_.isObject(a)&&_.has(a,"errors")?new tdcNotice.notice(a.errors,!0,!1):(c.attr("style","background-image: url('"+a.image_url+
"')").removeClass("tdc-no-image-selected"),c.data("image_link",a.image_url),c.data("image_id",g),c.closest(".tdc-property").find(".tdc-image-remove").removeClass("tdc-hidden-button")))}).fail(function(a,c,b){})}})});return a},addTextArea:function(){},addTextField:function(e,b){var d="",a="";if(_.has(e,"description")&&""!==e.description){var c=jQuery("<div>"+e.description+"</div>");e.description===c.text()?d=' title="'+e.description+'" ':a='<div class="tdc-description">'+e.description+"</div>"}c=""+
('<div class="'+tdcSidebarPanel._getParameterClasses(e)+'">');c+='<div class="tdc-property-title"><span'+d+">"+e.heading+"</span></div>";c=c+'<div class="tdc-property">'+("<input "+tdcSidebarPanel._getParamterDataAtts(e,b)+' name="'+tdcSidebarPanel._getParameterDomName(e)+'" type="text" value="'+tdcSidebarPanel._getParameterCurrentValue(e,b)+'"/>');return c=c+a+"</div></div>"},addTextAreaHtml:function(e,b){_.has(e,"description");var d='<a href="#" class="tdc-open-wpeditor" data-model_id="'+b.cid+
'" data-mapped_parameter_name="'+e.param_name+'">Edit Content</a>';tdcSidebarPanel._hook.addAction("panel_rendered",function(){});return d},addTextAreaRawHtml:function(e,b){var d=_.uniqueId("tdc_textarea_"),a="";_.has(e,"description")&&""!==e.description&&(a=' title="'+e.description+'" ');var c=""+('<div class="'+tdcSidebarPanel._getParameterClasses(e)+'">');c+='<div class="tdc-property-title"><span'+a+">"+e.heading+"</span></div>";c=c+'<div class="tdc-property">'+('<textarea id="'+d+'" class="tdc-textarea" '+
tdcSidebarPanel._getParamterDataAtts(e,b)+">"+tdcSidebarPanel._getParameterCurrentValue(e,b)+"</textarea>");c+="</div></div>";jQuery.ajax({timeout:1E4,type:"POST",url:tdcUtil.getRestEndPoint("td-composer/decode_html_content","uuid="+tdcJobManager._getUniqueID()),beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",window.tdcAdminSettings.wpRestNonce)},dataType:"json",data:{post_id:window.tdcPostSettings.postId,action:"tdc_ajax_decode_html_content",content:tdcSidebarPanel._getParameterCurrentValue(e,
b)}}).done(function(a,c,b){"success"===c&&(_.isObject(a)&&_.has(a,"errors")?new tdcNotice.notice(a.errors,!0,!1):jQuery("#"+d).html(a.parsed_content).show())}).fail(function(a,c,b){});jQuery("body").on("keyup","#"+d,function(a){a=jQuery(a.target);var c=tdcIFrameData.getModel(a.data("model_id")),b=window.btoa(a.val());tdcSidebarController.onUpdate(c,a.data("param_name"),b,b)});return c},addSeparatorHorizontal:function(e,b){return""+('<div class="tdc-sidebar-horizontal-separator '+tdcSidebarPanel._getParameterClasses(e)+
'"></div>')}}})();var tdcSidebar;
(function(f,e,b){tdcSidebar={$_sidebar:b,$_editRow:b,$_editColumn:b,$_editInnerRow:b,$_editInnerColumn:b,_currentTabId:b,_currentModel:b,_$currentElement:b,_$currentRow:b,_$currentColumn:b,_$currentInnerRow:b,_$currentInnerColumn:b,$_currentElementHead:b,$_inspector:b,$_sidebarInfo:b,$_sidebarClosePage:b,$_sidebarBullet:b,$_sidebarClose:b,$_sidebarOpen:b,$_sidebarMenu:b,$_sidebarSearch:b,$_liveIframeWrapper:b,init:function(){tdcSidebar.$_sidebar=f("#tdc-sidebar");tdcSidebar.$_liveIframeWrapper=f("#tdc-live-iframe-wrapper");
tdcSidebar.$_editRow=tdcSidebar.$_sidebar.find("#tdc-breadcrumb-row");tdcSidebar.$_editRow.data("name","Row");tdcSidebar.$_editColumn=tdcSidebar.$_sidebar.find("#tdc-breadcrumb-column");tdcSidebar.$_editColumn.data("name","Column");tdcSidebar.$_editInnerRow=tdcSidebar.$_sidebar.find("#tdc-breadcrumb-inner-row");tdcSidebar.$_editInnerRow.data("name","Inner Row");tdcSidebar.$_editInnerColumn=tdcSidebar.$_sidebar.find("#tdc-breadcrumb-inner-column");tdcSidebar.$_editInnerColumn.data("name","Inner Column");
tdcSidebar.$_currentElementHead=tdcSidebar.$_sidebar.find(".tdc-current-element-head:first");tdcSidebar.$_currentElementSiblings=tdcSidebar.$_sidebar.find(".tdc-current-element-siblings:first");tdcSidebar.$_inspector=tdcSidebar.$_sidebar.find(".tdc-inspector:first");tdcSidebar.$_sidebarInfo=tdcSidebar.$_sidebar.find(".tdc-sidebar-info:first");tdcSidebar.$_sidebarClosePage=tdcSidebar.$_sidebar.find(".tdc-close-page:first");tdcSidebar.$_sidebarBullet=tdcSidebar.$_sidebar.find(".tdc-bullet:first");tdcSidebar.$_sidebarClose=
tdcSidebar.$_sidebar.find(".tdc-sidebar-close:first");tdcSidebar.$_sidebarOpen=tdcSidebar.$_sidebar.siblings(".tdc-sidebar-open:first");tdcSidebar.$_sidebarMenu=tdcSidebar.$_sidebar.find(".tdc-main-menu:first");tdcSidebar.$_sidebarSearch=tdcSidebar.$_sidebar.find(".tdc-sidebar-modal-search:first > input");tdcSidebar.$_editRow.click(function(){tdcSidebar.setSettings({$currentRow:tdcSidebar.getCurrentRow()})}).mouseenter(function(b){e.isUndefined(tdcSidebar._$currentElement)||(tdcMaskUI.setCurrentElement(tdcSidebar._$currentElement),
tdcMaskUI.$wrapper.hide());e.isUndefined(tdcSidebar._$currentRow)||tdcMaskUI.setCurrentContainer(tdcSidebar._$currentRow)}).mouseleave(function(b){tdcMaskUI.hide()});tdcSidebar.$_editColumn.click(function(){tdcSidebar.setSettings({$currentRow:tdcSidebar.getCurrentRow(),$currentColumn:tdcSidebar.getCurrentColumn()})}).mouseenter(function(b){e.isUndefined(tdcSidebar._$currentElement)||(tdcMaskUI.setCurrentElement(tdcSidebar._$currentElement),tdcMaskUI.$wrapper.hide());e.isUndefined(tdcSidebar._$currentColumn)||
tdcMaskUI.setCurrentContainer(tdcSidebar._$currentColumn)}).mouseleave(function(b){tdcMaskUI.hide()});tdcSidebar.$_editInnerRow.click(function(){tdcSidebar.setSettings({$currentRow:tdcSidebar.getCurrentRow(),$currentColumn:tdcSidebar.getCurrentColumn(),$currentInnerRow:tdcSidebar.getCurrentInnerRow()})}).mouseenter(function(b){e.isUndefined(tdcSidebar._$currentElement)||(tdcMaskUI.setCurrentElement(tdcSidebar._$currentElement),tdcMaskUI.$wrapper.hide());e.isUndefined(tdcSidebar._$currentInnerRow)||
tdcMaskUI.setCurrentContainer(tdcSidebar._$currentInnerRow)}).mouseleave(function(b){tdcMaskUI.hide()});tdcSidebar.$_editInnerColumn.click(function(){tdcSidebar.setSettings({$currentRow:tdcSidebar.getCurrentRow(),$currentColumn:tdcSidebar.getCurrentColumn(),$currentInnerRow:tdcSidebar.getCurrentInnerRow(),$currentInnerColumn:tdcSidebar.getCurrentInnerColumn()})}).mouseenter(function(b){e.isUndefined(tdcSidebar._$currentElement)||(tdcMaskUI.setCurrentElement(tdcSidebar._$currentElement),tdcMaskUI.$wrapper.hide());
e.isUndefined(tdcSidebar._$currentInnerColumn)||tdcMaskUI.setCurrentContainer(tdcSidebar._$currentInnerColumn)}).mouseleave(function(b){tdcMaskUI.hide()});f(".tdc-sidebar-element").each(function(b,a){tdcSidebar._bindElement(f(a))});tdcSidebar.$_sidebarClosePage.click(function(d){tdcMain.getContentModified()?tdConfirm.showModal("Close tagDiv Composer",tdcSidebar,function(){window.onbeforeunload=null;window.location=window.tdcAdminSettings.editPostUrl;tb_remove()},b):tdConfirm.showModal("Close tagDiv Composer",
tdcSidebar,function(){window.location=window.tdcAdminSettings.editPostUrl;tb_remove()},b,"Are you sure you want to close tagDiv Composer?")});"1"===window.localStorage.getItem("tdc_live_iframe_wrapper_inline")&&(tdcMain.setSidebarInline(),tdcSidebar.$_sidebar.addClass("tdc-sidebar-inline"),tdcSidebar.$_liveIframeWrapper.addClass("tdc-live-iframe-wrapper-inline").removeClass("tdc-live-iframe-wrapper-full"));tdcSidebar.$_sidebarBullet.click(function(b){tdcSidebar.$_sidebar.toggleClass("tdc-sidebar-inline");
tdcSidebar.$_liveIframeWrapper.toggleClass("tdc-live-iframe-wrapper-inline");tdcSidebar.$_liveIframeWrapper.hasClass("tdc-live-iframe-wrapper-inline")?(tdcSidebar.$_liveIframeWrapper.removeClass("tdc-live-iframe-wrapper-full"),tdcMain.setSidebarInline(),window.localStorage.setItem("tdc_live_iframe_wrapper_inline",1)):(tdcSidebar.$_liveIframeWrapper.addClass("tdc-live-iframe-wrapper-full"),tdcMain.resetSidebarInline(),window.localStorage.setItem("tdc_live_iframe_wrapper_inline",0))});tdcSidebar.$_sidebarClose.click(function(b){tdcSidebar.$_sidebar.addClass("tdc-sidebar-hidden");
tdcSidebar.$_sidebarOpen.addClass("tdc-sidebar-reopen");tdcSidebar.$_sidebar.hasClass("tdc-sidebar-inline")&&tdcSidebar.$_liveIframeWrapper.toggleClass("tdc-live-iframe-wrapper-inline");tdcSidebar.$_sidebar.hasClass("tdc-sidebar-hidden")?tdcSidebar.$_liveIframeWrapper.removeClass("tdc-live-iframe-wrapper-full"):tdcSidebar.$_liveIframeWrapper.hasClass("tdc-live-iframe-wrapper-inline")||tdcSidebar.$_liveIframeWrapper.addClass("tdc-live-iframe-wrapper-full");tdcMain.setSidebarHidden()});tdcSidebar.$_sidebarOpen.click(function(b){tdcSidebar.$_sidebar.removeClass("tdc-sidebar-hidden");
tdcSidebar.$_sidebarOpen.removeClass("tdc-sidebar-reopen");tdcSidebar.$_sidebar.hasClass("tdc-sidebar-inline")&&tdcSidebar.$_liveIframeWrapper.toggleClass("tdc-live-iframe-wrapper-inline");tdcSidebar.$_sidebar.hasClass("tdc-sidebar-hidden")?tdcSidebar.$_liveIframeWrapper.removeClass("tdc-live-iframe-wrapper-full"):tdcSidebar.$_liveIframeWrapper.hasClass("tdc-live-iframe-wrapper-inline")||tdcSidebar.$_liveIframeWrapper.addClass("tdc-live-iframe-wrapper-full");tdcMain.resetSidebarHidden()});tdcSidebar.$_sidebarMenu.click(function(b){f(this).toggleClass("tdc-window-open");
f(".tdc-sidebar-modal").each(function(a,c){var b=f(c),d=b.data("button_class");b.hasClass("tdc-sidebar-modal-menu")?b.toggleClass("tdc-modal-open"):(b.removeClass("tdc-modal-open"),"undefined"!==typeof d&&""!==d&&(b=f("."+d),b.length&&b.removeClass("tdc-window-open")))})});tdcSidebar.$_sidebarSearch.keyup(function(b){var a=f(this);f(".tdc-sidebar-element").each(function(c,b){var d=f(b);-1===d.find(".tdc-element-id").html().toLowerCase().indexOf(a.val().trim().toLowerCase())?d.hide():d.show()});f(".tdc-sidebar-separator").each(function(a,
b){var c=f(b);c.nextUntil(".tdc-sidebar-separator").is(":visible")?c.show():c.hide()})});f("body").css("overflow","hidden");tdcSidebar._sidebarModal();tdcSidebar._liveInspectorTabs();tdcSidebarPanel.init()},hideWpeditor:function(){f("#tdc-wpeditor").hide()},_activeBreadcrumbItem:function(){var b=tdcSidebar.getCurrentModel(),a=b.get("tag"),c="<span>"+window.tdcPostSettings.shortcodes[b.get("tag")]+"</span>",g="",l;for(l in window.tdcAdminSettings.mappedShortcodes)if("undefined"!==typeof window.tdcAdminSettings.mappedShortcodes[l].tdc_category&&
window.tdcAdminSettings.mappedShortcodes[l].tdc_category===window.tdcAdminSettings.mappedShortcodes[a].tdc_category){var k="";l===a&&(k="tdc-selected-option");g+='<li class="'+k+'" data-block_type="'+window.tdcAdminSettings.mappedShortcodes[l].base+'"><div class="tdc-element-ico tdc-ico-'+window.tdcAdminSettings.mappedShortcodes[l].base+'"></div><div class="tdc-element-id">'+window.tdcAdminSettings.mappedShortcodes[l].name+"</div></li>"}""!==g?(g="<ul>"+g+"</ul>",tdcSidebar.$_currentElementHead.addClass("tdc-block-selection")):
tdcSidebar.$_currentElementHead.removeClass("tdc-block-selection");switch(a){case "vc_row":tdcSidebar.$_editRow.hide();tdcSidebar.$_editColumn.hide();tdcSidebar.$_editInnerRow.hide();tdcSidebar.$_editInnerColumn.hide();var q=tdcSidebar.$_editRow;break;case "vc_column":tdcSidebar.$_editRow.show();tdcSidebar.$_editColumn.hide();tdcSidebar.$_editInnerRow.hide();tdcSidebar.$_editInnerColumn.hide();q=tdcSidebar.$_editColumn;break;case "vc_row_inner":tdcSidebar.$_editRow.show();tdcSidebar.$_editColumn.show();
tdcSidebar.$_editInnerRow.hide();tdcSidebar.$_editInnerColumn.hide();q=tdcSidebar.$_editInnerRow;break;case "vc_column_inner":tdcSidebar.$_editRow.show();tdcSidebar.$_editColumn.show();tdcSidebar.$_editInnerRow.show();tdcSidebar.$_editInnerColumn.hide();q=tdcSidebar.$_editInnerColumn;break;default:tdcSidebar.$_editRow.show(),tdcSidebar.$_editColumn.show(),q=tdcSidebar.getCurrentElement(),"vc_column_inner"===b.get("parentModel").get("tag")?(tdcSidebar.$_editInnerRow.show(),tdcSidebar.$_editInnerColumn.show()):
(tdcSidebar.$_editInnerRow.hide(),tdcSidebar.$_editInnerColumn.hide())}tdcSidebar.$_currentElementHead.html(c);tdcSidebar.$_currentElementSiblings.html(g);tdcSidebar.$_sidebar.find(".tdc-responsiveness").addClass(a);tdcSidebar.$_currentElementHead.off().mouseenter(function(a){a.preventDefault();q.trigger(a)}).mouseleave(function(a){a.preventDefault();q.trigger(a)}).click(function(a){""!==g&&(tdcSidebar.$_currentElementSiblings.toggleClass("tdc-current-element-siblings-visible"),a=f(this),tdcSidebar.$_currentElementSiblings.hasClass("tdc-current-element-siblings-visible")?
a.addClass("tdc-current-element-siblings-button-on"):a.removeClass("tdc-current-element-siblings-button-on"))});tdcSidebar.$_currentElementSiblings.find("li").off().click(function(a){a=f(this);var c=a.data("block_type"),d=a.children(".tdc-element-id").html();a.siblings(".tdc-selected-option").removeClass("tdc-selected-option");a.addClass("tdc-selected-option");tdcSidebar.$_currentElementHead.html("<span>"+d+"</span>");e.isUndefined(c)||(b.set("tag",c),tdcSidebarController.onUpdate(b));tdcSidebar.$_currentElementSiblings.removeClass("tdc-current-element-siblings-visible")});
tdcSidebar.$_currentElementSiblings.mouseleave(function(a){tdcSidebar.$_currentElementSiblings.removeClass("tdc-current-element-siblings-visible")});tdcSidebar.$_inspector.show()},closeModals:function(){f(".tdc-sidebar-modal").each(function(b,a){var c=f(a),d=c.data("button_class");c.removeClass("tdc-modal-open");"undefined"!==typeof d&&""!==d&&(c=f("."+d),c.length&&c.removeClass("tdc-window-open"))})},_sidebarModal:function(){f(".tdc-add-element").click(function(){f(this).toggleClass("tdc-window-open");
f(".tdc-sidebar-modal").each(function(b,a){var c=f(a),d=c.data("button_class");c.hasClass("tdc-sidebar-modal-elements")?(c.toggleClass("tdc-modal-open"),setTimeout(function(){var a=f(".tdc-sidebar-modal-search > input");a.focus();a.val("");f(".tdc-sidebar-element").each(function(a,c){f(c).show()})},100)):(c.removeClass("tdc-modal-open"),"undefined"!==typeof d&&""!==d&&(c=f("."+d),c.length&&c.removeClass("tdc-window-open")))})})},_bindElement:function(b){b.click(function(a){a.preventDefault()}).mousedown(function(a){if(1===
a.which){if("td_block_homepage_full_1"===b.data("shortcode-name")){var c=tdcIFrameData.getFirstModelByTag("td_block_homepage_full_1");if(!e.isUndefined(c)){new tdcNotice.notice("td_block_homepage_full_1 este deja in pagina",!1,!0);return}}a.preventDefault();tdcOperationUI.activeDraggedElement(b);tdcOperationUI.showHelper(a)}}).mouseup(function(a){tdcOperationUI.isSidebarElementDragged()&&(a.preventDefault(),tdcOperationUI.deactiveDraggedElement(),tdcOperationUI.hideHelper())})},_liveInspectorTabs:function(){f("body").on("click",
".tdc-tabs a",function(){var b=f(this);tdcSidebar._setCurrentTabId(b.data("tab-id"));b.hasClass("tdc-tab-active")||(f(".tdc-tabs a").removeClass("tdc-tab-active"),b.addClass("tdc-tab-active"),f(".tdc-tab-content-wrap .tdc-tab-content").removeClass("tdc-tab-content-visible"),b=b.data("tab-id"),f("#"+b).addClass("tdc-tab-content-visible"))})},_setCurrentTabId:function(b){tdcSidebar._currentTabId=b},getCurrentTabId:function(){return tdcSidebar._currentTabId},_setCurrentElement:function(b){tdcSidebar._$currentElement=
b},getCurrentElement:function(){return tdcSidebar._$currentElement},_setCurrentRow:function(b){tdcSidebar._$currentRow=b},getCurrentRow:function(){return tdcSidebar._$currentRow},_setCurrentColumn:function(b){tdcSidebar._$currentColumn=b},getCurrentColumn:function(){return tdcSidebar._$currentColumn},_setCurrentInnerRow:function(b){tdcSidebar._$currentInnerRow=b},getCurrentInnerRow:function(){return tdcSidebar._$currentInnerRow},_setCurrentInnerColumn:function(b){tdcSidebar._$currentInnerColumn=b},
getCurrentInnerColumn:function(){return tdcSidebar._$currentInnerColumn},setSidebarInfo:function(b){tdcSidebar.$_sidebarInfo.html(b)},getCurrentModel:function(){return tdcSidebar._currentModel},setSettings:function(d,a){e.isUndefined(tdcSidebar._currentModel)||tdcSidebar._currentModel.set("current",!1);e.isUndefined(d)?(tdcSidebar._setCurrentRow(b),tdcSidebar._setCurrentColumn(b),tdcSidebar._setCurrentInnerRow(b),tdcSidebar._setCurrentInnerColumn(b),tdcSidebar._setCurrentElement(b),tdcSidebar._currentModel=
b):e.has(d,"$currentRow")&&!e.isUndefined(d.$currentRow)?(tdcSidebar._setCurrentRow(d.$currentRow),e.has(d,"$currentColumn")&&!e.isUndefined(d.$currentColumn)?(tdcSidebar._setCurrentColumn(d.$currentColumn),e.has(d,"$currentInnerRow")&&!e.isUndefined(d.$currentInnerRow)?(tdcSidebar._setCurrentInnerRow(d.$currentInnerRow),e.has(d,"$currentInnerColumn")&&!e.isUndefined(d.$currentInnerColumn)?(tdcSidebar._setCurrentInnerColumn(d.$currentInnerColumn),e.has(d,"$currentElement")&&!e.isUndefined(d.$currentElement)?
(tdcSidebar._setCurrentElement(d.$currentElement),tdcSidebar._currentModel=tdcIFrameData.getModel(d.$currentElement.data("model_id"))):(tdcSidebar._setCurrentElement(b),tdcSidebar._currentModel=tdcIFrameData.getModel(d.$currentInnerColumn.data("model_id")))):(tdcSidebar._setCurrentInnerColumn(b),tdcSidebar._setCurrentElement(b),tdcSidebar._currentModel=tdcIFrameData.getModel(d.$currentInnerRow.data("model_id")))):(tdcSidebar._setCurrentInnerRow(b),tdcSidebar._setCurrentInnerColumn(b),e.has(d,"$currentElement")&&
!e.isUndefined(d.$currentElement)?(tdcSidebar._setCurrentElement(d.$currentElement),tdcSidebar._currentModel=tdcIFrameData.getModel(d.$currentElement.data("model_id"))):(tdcSidebar._setCurrentElement(b),tdcSidebar._currentModel=tdcIFrameData.getModel(d.$currentColumn.data("model_id"))))):(tdcSidebar._setCurrentColumn(b),tdcSidebar._setCurrentInnerRow(b),tdcSidebar._setCurrentInnerColumn(b),tdcSidebar._setCurrentElement(b),tdcSidebar._currentModel=tdcIFrameData.getModel(d.$currentRow.data("model_id")))):
(tdcSidebar._setCurrentRow(b),tdcSidebar._setCurrentColumn(b),tdcSidebar._setCurrentInnerRow(b),tdcSidebar._setCurrentInnerColumn(b),tdcSidebar._setCurrentElement(b),tdcSidebar._currentModel=b);e.isUndefined(tdcSidebar._currentModel)?tdcSidebarPanel.clearPanel():(tdcSidebar._currentModel.set("current",!0),tdcSidebarPanel.bindPanelToModel(tdcSidebar._currentModel,a),tdcSidebar._activeBreadcrumbItem(),tdcSidebar.closeModals(),tdcSidebar.hideWpeditor(tdcSidebar._currentModel))}};tdcSidebar.init()})(jQuery,
_);var tdcSidebarController={};
(function(f){tdcSidebarController={updateJobBuffer:{},updateJobTimer:"",_updateJob:function(){this.value=this.oldValue=this.paramName=this.model=""},_getParamMap:function(e,b,d){for(var a=window.tdcAdminSettings.mappedShortcodes[e],c=0;c<a.params.length;c++)if(a.params[c].param_name===b)return a.params[c];if(!_.isEmpty(d.block_template_id))for(d=window.tdcAdminSettings.mappedBlockTemplates[d.block_template_id],a=0;a<d.params.length;a++)if(d.params[a].param_name===b)return d.params[a];new tdcNotice.notice("Map value not found for "+
e+" "+b,!0,!1);return f},onUpdate:function(e,b,d,a){var c=new tdcSidebarController._updateJob;c.model=e;c.paramName=b;c.oldValue=d;c.value=a;tdcSidebarController._addToBuffer(c)},_addToBuffer:function(e){tdcSidebarController.updateJobBuffer[e.model.get("blockUid")]=e;""!==tdcSidebarController.updateJobTimer&&clearTimeout(tdcSidebarController.updateJobTimer);tdcSidebarController.updateJobTimer=setTimeout(function(){1<tdcSidebarController.updateJobBuffer.length&&(console.log("Multiple jobs detected - see below"),
console.log(tdcSidebarController.updateJobBuffer));for(var b in tdcSidebarController.updateJobBuffer)tdcSidebarController._doUpdateJob(tdcSidebarController.updateJobBuffer[b]);tdcSidebarController.updateJobBuffer={};tdcSidebarController.updateJobTimer=""},500)},_doUpdateJob:function(e){if(!_.isUndefined(e.paramName)){var b=e.model.get("attrs"),d=_.clone(b),b=tdcSidebarController._getParamMap(e.model.attributes.tag,e.paramName,b);b.value===e.value?delete d[b.param_name]:d[b.param_name]=e.value;e.model.set("attrs",
d)}d={error:f,getShortcode:""};tdcIFrameData._checkModelData(e.model,d);if(!_.isUndefined(d.getShortcode)){var a=e.model.get("blockUid"),c=new tdcJobManager.job;c.shortcode=d.getShortcode;c.columns=tdcIFrameData.getColumnNumber(e.model);c.blockUid=a;4>parseInt(e.model.get("level"),10)&&e.model.set("bindNewContent",!0);c.success_callback=function(b){var d=tdcAdminIFrameUI.getIframeWindow();tdcIFrameData.deleteCallback(e.model);e.model.set("blockUid",b.blockUid);_.has(b,"replyHtml")&&(e.model.set("shortcode",
c.shortcode),e.model.set("html",b.replyHtml));_.has(b,"replyJsForEval")&&(d.tdcEvalGlobal={oldBlockUid:a},tdcAdminIFrameUI.evalInIframe(b.replyJsForEval))};c.error_callback=function(a,c){tdcDebug.log(c);tdcDebug.log(a)};d=tdcSidebar.getCurrentElement();_.isUndefined(d)&&(d=tdcSidebar.getCurrentInnerColumn(),_.isUndefined(d)&&(d=tdcSidebar.getCurrentInnerRow(),_.isUndefined(d)&&(d=tdcSidebar.getCurrentColumn(),_.isUndefined(d)&&(d=tdcSidebar.getCurrentRow()))));_.isUndefined(d)||d.addClass("tdc-changed");
tdcJobManager.addJob(c)}}}})();var tdcCssEditor={};
(function(f,e,b){tdcCssEditor={_mappedParameter:b,_model:b,_currentViewportSettings:{name:"all",settings:b},_currentCssSettings:b,_INHERITED_CSS_CLASS:"tdc-css-inherited",_INACTIVE_CSS_CLASS:"tdc-css-inactive",_isInitialized:!1,init:function(){tdcCssEditor._isInitialized||(tdcCssEditor._bindEvents(),tdcCssEditor._isInitialized=!0)},tdcCssImageWrapHandler:function(b){var a=f(b.currentTarget),c=a.closest(".tdc-tab-content");window.original_send_to_editor=window.send_to_editor;wp.media.editor.open(a);
f(".media-menu .media-menu-item:nth-of-type(2)").addClass("hidden");f(".media-menu .media-menu-item:nth-of-type(3)").addClass("hidden");f(".media-menu .media-menu-item:nth-of-type(4)").addClass("hidden");window.send_to_editor=function(b){var d=f("img",b).attr("src"),g="";"undefined"===typeof d?(d=f(b).attr("src"),g=f(b).attr("class")):g=f("img",b).attr("class");f.ajax({timeout:1E4,type:"POST",url:tdcUtil.getRestEndPoint("td-composer/get_image_id","uuid="+tdcJobManager._getUniqueID()),beforeSend:function(a){a.setRequestHeader("X-WP-Nonce",
window.tdcAdminSettings.wpRestNonce)},dataType:"json",data:{image_class:g,action:"tdc_ajax_get_image_id"}}).done(function(b,g,f){if("success"===g)if(e.isObject(b)&&e.has(b,"errors"))new tdcNotice.notice(b.errors,!0,!1);else{g=a.closest(".tdc-property-wrap");f=g.find(".tdc-css-image-remove");var h=g.find(".tdc-inherit-image");f.removeClass("tdc-hidden-button");"all"===tdcCssEditor._currentViewportSettings.name?h.hide():h.show();a.attr("style","background-image: url( '"+d+"') ");a.data("image_link",
d);a.data("image_id",b.image_id);window.send_to_editor=window.original_send_to_editor;window.tb_remove();g.removeClass(tdcCssEditor._INHERITED_CSS_CLASS);"undefined"===typeof a.data("model_id")?tdcCssEditor.saveWidgetForm(a):(b=tdcCssEditor._generateCssAttValue(c),g=tdcIFrameData.getModel(a.data("model_id")),tdcSidebarController.onUpdate(g,a.data("param_name"),"",b))}}).fail(function(a,c,b){})};return!1},tdcCssImageRemoveHandler:function(b){var a=f(b.currentTarget),c=a.closest(".tdc-property-wrap");
b=c.find(".tdc-css-image-wrap");var d=c.find(".tdc-inherit-image");a.addClass("tdc-hidden-button");"all"!==tdcCssEditor._currentViewportSettings.name&&d.show();c.removeClass(tdcCssEditor._INHERITED_CSS_CLASS);b.attr("style","background-image: url( '"+window.tdcAdminSettings.pluginUrl+"/assets/images/sidebar/no_img.png'");"all"===tdcCssEditor._currentViewportSettings.name?b.data("image_link",""):b.data("image_link","no_value");d=b.data("model_id");e.isUndefined(d)?tdcCssEditor.saveWidgetForm(a):(a=
c.closest(".tdc-tab-content"),a=tdcCssEditor._generateCssAttValue(a),d=tdcIFrameData.getModel(d),tdcSidebarController.onUpdate(d,b.data("param_name"),"",a))},_updateColorField:function(b){var a=b.closest(".tdc-property-wrap"),c=a.data("tdc-for"),d=a.find(".tdc-inherit-color"),f=a.find(".wp-color-result"),k=b.data("no_value"),q=b.data("default_value");e.isUndefined(k)||1!==k?("all"!==tdcCssEditor._currentViewportSettings.name&&d.show(),tdcCssEditor._updateData(b),d={isInherited:!1},c=tdcCssEditor._getSettingsProperty(c,
"",d),d.isInherited?(b.attr("placeholder",c),b.val(""),a.addClass(tdcCssEditor._INHERITED_CSS_CLASS),f.attr("style","background-color: "+tdcCssEditor._getRgba(c))):(a.removeClass(tdcCssEditor._INHERITED_CSS_CLASS),tdcCssEditor._checkDefaultColor(b))):(b.val("no_value"),tdcCssEditor._updateData(b),b.val(""),e.isUndefined(q)||f.attr("style","background-color: "+tdcCssEditor._getRgba(q)),tdcCssEditor._checkDefaultColor(b))},_clearColorPicker:function(b){b=f(b.currentTarget).closest(".tdc-property-wrap");
var a=b.closest(".tdc-tab-content"),c=b.find("input.wp-color-picker"),d=b.find(".tdc-inherit-color");b.removeClass(tdcCssEditor._INHERITED_CSS_CLASS);"all"!==tdcCssEditor._currentViewportSettings.name&&(c.data("no_value",1),c.attr("placeholder",""),d.show());tdcCssEditor._checkDefaultColor(c);a.hasClass("tdc-tab-widget")&&(c.val(""),c.trigger("keyup"))},_showColorPicker:function(b){b=f(b.currentTarget).closest(".tdc-property-wrap").find("input.wp-color-picker");"no_value"===b.val()&&b.val("")},_changeColor:function(b){var a=
f(b.currentTarget).closest(".wp-picker-container").find("input.wp-color-picker");""!==a.val()&&a.data("no_value",0);"keyup"===b.type?setTimeout(function(){tdcCssEditor._updateColorField(a)},100):tdcCssEditor._updateColorField(a)},_inheritSelect:function(d){d=f(d.currentTarget);var a=d.closest(".tdc-property-wrap"),c=a.data("tdc-for");e.isUndefined(tdcCssEditor._currentCssSettings[tdcCssEditor._currentViewportSettings.name][c])||delete tdcCssEditor._currentCssSettings[tdcCssEditor._currentViewportSettings.name][c];
var g={isInherited:!1},c=tdcCssEditor._getSettingsProperty(c,b,g),l=a.find("select:first");g.isInherited?(a.addClass(tdcCssEditor._INHERITED_CSS_CLASS),d.hide()):(a.removeClass(tdcCssEditor._INHERITED_CSS_CLASS),d.show());e.isUndefined(c)?(l.val(l.find("option:first").val()),d.hide()):l.val(c);tdcCssEditor._updateData(l)},_inheritColor:function(d){d=f(d.currentTarget);var a=d.closest(".tdc-property-wrap"),c=a.find(".wp-color-picker"),g=a.find(".wp-color-result"),l=a.data("tdc-for");e.isUndefined(tdcCssEditor._currentCssSettings[tdcCssEditor._currentViewportSettings.name][l])||
delete tdcCssEditor._currentCssSettings[tdcCssEditor._currentViewportSettings.name][l];c.data("no_value",0);var k={isInherited:!1},l=tdcCssEditor._getSettingsProperty(l,b,k);k.isInherited?(a.addClass(tdcCssEditor._INHERITED_CSS_CLASS),d.hide()):(a.removeClass(tdcCssEditor._INHERITED_CSS_CLASS),d.show());e.isUndefined(l)?(c.val(""),d.hide(),tdcCssEditor._updateData(c),tdcCssEditor._checkDefaultColor(c)):(c.val(""),c.attr("placeholder",l),g.attr("style","background-color: "+tdcCssEditor._getRgba(l)),
tdcCssEditor._updateData(c))},_inheritImage:function(d){var a=f(d.currentTarget);d=a.closest(".tdc-property-wrap");var c=d.find(".tdc-css-image-wrap"),g=d.find(".tdc-css-image-remove");d.find(".tdc-inherit-image").hide();g.addClass("tdc-hidden-button");c.data("image_link","");g=c.data("model_id");e.isUndefined(g)?tdcCssEditor.saveWidgetForm(a):(a=d.closest(".tdc-tab-content"),a=tdcCssEditor._generateCssAttValue(a),g=tdcIFrameData.getModel(g),tdcSidebarController.onUpdate(g,c.data("param_name"),"",
a));g={isInherited:!1};a=tdcCssEditor._getSettingsProperty("background-image",b,g);g.isInherited?(d.addClass(tdcCssEditor._INHERITED_CSS_CLASS),c.attr("style","background-image: url('"+a+"'")):c.attr("style","background-image: url( '"+window.tdcAdminSettings.pluginUrl+"/assets/images/sidebar/no_img.png'")},_clearCssProperties:function(d){d=f(d.currentTarget);var a=d.data("model_id");tdConfirm.showModal("Clear CSS settings",tdcCssEditor,function(a,d){tdcCssEditor._currentCssSettings=b;if("undefined"===
typeof d)f(".tdc-responsiveness").replaceWith(tdcCssEditor._generateEditorResponsiveContent()),tdcCssEditor.doActionPanelRender(),tdcCssEditor.saveWidgetForm(f("."+a.get(0).className));else{var c=tdcIFrameData.getModel(d);tdcSidebarController.onUpdate(c,a.data("param_name"),"","");f(".tdc-responsiveness").replaceWith(tdcCssEditor._generateEditorResponsiveContent());tdcCssEditor.doActionPanelRender()}tb_remove()},[d,a],"Are you sure you want to clear all the CSS settings of the selected component?")},
_changeTextInput:function(b){var a=f(b.currentTarget),c=a.parent(),d=a;c.hasClass("tdc-box-margin")||c.hasClass("tdc-box-border")||c.hasClass("tdc-box-padding")||(d=a.closest(".tdc-property-wrap"));var c=a.val(),l=1;a.hasClass("tdc-css-opacity")&&(l=.01);var k=NaN;switch(b.type){case "keyup":switch(b.keyCode){case 38:f.isNumeric(c)&&(k=parseFloat(c)+l);break;case 40:f.isNumeric(c)&&(k=parseFloat(c)-l)}break;case "mousewheel":f.isNumeric(c)&&(k=0<b.originalEvent.deltaY?parseFloat(c)-l:parseFloat(c)+
l)}e.isNaN(k)||(1>l&&(k=k.toFixed(2)),a.val(k));tdcCssEditor._updateData(a);c=d.data("tdc-for");b={isInherited:!1};c=tdcCssEditor._getSettingsProperty(c,"",b);b.isInherited?(a.attr("placeholder",c),a.val(""),d.addClass(tdcCssEditor._INHERITED_CSS_CLASS)):d.removeClass(tdcCssEditor._INHERITED_CSS_CLASS)},_keydownTextInput:function(b){if(38===b.keyCode||40===b.keyCode)return!1},_focusTextInput:function(b){b=f(b.currentTarget);for(var a=b.closest(".tdc-property-wrap"),c=a[0].classList,d=0;d<c.length;d++)c[d].startsWith("tdc-el-")&&
a.removeClass(c[d]);a.addClass("tdc-el-"+b.data("tdc-for"))},_changeDropDown:function(b){b=f(b.currentTarget);var a=b.closest(".tdc-property-wrap"),c=a.find(".tdc-inherit-select");a.removeClass(tdcCssEditor._INHERITED_CSS_CLASS);tdcCssEditor._updateData(b);var d=a.data("tdc-for"),l={isInherited:!1};tdcCssEditor._getSettingsProperty(d,"",l);l.isInherited?(a.addClass(tdcCssEditor._INHERITED_CSS_CLASS),c.hide()):(a.removeClass(tdcCssEditor._INHERITED_CSS_CLASS),"all"===tdcCssEditor._currentViewportSettings.name?
c.hide():0===b[0].selectedIndex?e.isUndefined(tdcCssEditor._currentCssSettings.all)||e.isUndefined(tdcCssEditor._currentCssSettings.all[d])?c.hide():c.show():c.show())},doActionPanelRender:function(){tdcSidebarPanel._hook.doAction("panel_rendered");tdcSidebarPanel._hook.doAction("panel_css")},_bindEvents:function(){var d=f("body");d.on("keydown",".tdc-tab-design input.tdc-css-box-input",tdcCssEditor._keydownTextInput);d.on("keyup mousewheel",".tdc-tab-design input.tdc-css-box-input",tdcCssEditor._changeTextInput);
d.on("focus",".tdc-tab-design input.tdc-css-box-input",tdcCssEditor._focusTextInput);d.on("change keyup",".tdc-tab-design .tdc-css-bg-color",tdcCssEditor._changeColor);d.on("change keyup",".tdc-tab-design .tdc-css-border-color",tdcCssEditor._changeColor);d.on("change",".tdc-tab-design .tdc-css-border-style",tdcCssEditor._changeDropDown);d.on("keydown",".tdc-tab-design input.tdc-css-border-radius",tdcCssEditor._keydownTextInput);d.on("keyup mousewheel",".tdc-tab-design input.tdc-css-border-radius",
tdcCssEditor._changeTextInput);d.on("change",".tdc-tab-design .tdc-css-bg-style",tdcCssEditor._changeDropDown);d.on("change",".tdc-tab-design .tdc-css-bg-position",tdcCssEditor._changeDropDown);d.on("keydown",".tdc-tab-design input.tdc-css-opacity",tdcCssEditor._keydownTextInput);d.on("keyup mousewheel",".tdc-tab-design input.tdc-css-opacity",tdcCssEditor._changeTextInput);d.on("change keyup",".tdc-tab-design input.tdc-css-color-1-overlay",tdcCssEditor._changeColor);d.on("change keyup",".tdc-tab-design input.tdc-css-color-2-overlay",
tdcCssEditor._changeColor);d.on("mousedown",".tdc-tab-design .wp-picker-clear",tdcCssEditor._clearColorPicker);d.on("mousedown",".tdc-tab-design .wp-color-result",tdcCssEditor._showColorPicker);d.on("click",".tdc-tab-design .tdc-inherit-select",tdcCssEditor._inheritSelect);d.on("click",".tdc-tab-design .tdc-inherit-color",tdcCssEditor._inheritColor);d.on("click",".tdc-tab-design .tdc-css-image-wrap",tdcCssEditor.tdcCssImageWrapHandler);d.on("click",".tdc-tab-design .tdc-css-image-remove",tdcCssEditor.tdcCssImageRemoveHandler);
d.on("click",".tdc-tab-design .tdc-inherit-image",tdcCssEditor._inheritImage);d.on("click",".tdc-clear-css-properties",tdcCssEditor._clearCssProperties);d.on("click",".tdc-tab-design .tdc-responsive-buttons > div",function(a){var c,d=f(this);d.addClass("selected");d.siblings().removeClass("selected");var l="undefined"===typeof window.td_viewport_interval_list?tdcAdminIFrameUI._liveIframeWindowObject.td_viewport_interval_list:window.td_viewport_interval_list;a=tdcAdminIFrameUI.getLiveIframe();e.isUndefined(a)||
(c=a.contents().find(".tdc-element-selected").offset().top-a.contents().scrollTop());d.hasClass("tdc-responsive-all")?(tdcCssEditor._currentViewportSettings={name:"all",settings:b},e.isUndefined(a)||a.css("width","100%")):d.hasClass("tdc-responsive-tablet-landscape")?(tdcCssEditor._currentViewportSettings={name:"landscape",settings:{limitTop:l[2].limitBottom,limitBottom:parseInt(l[1].limitBottom)+1}},e.isUndefined(a)||a.css("width",tdcCssEditor._currentViewportSettings.settings.limitTop)):d.hasClass("tdc-responsive-tablet-portrait")?
(tdcCssEditor._currentViewportSettings={name:"portrait",settings:{limitTop:l[1].limitBottom,limitBottom:parseInt(l[0].limitBottom)+1}},e.isUndefined(a)||a.css("width",tdcCssEditor._currentViewportSettings.settings.limitTop)):d.hasClass("tdc-responsive-phone")&&(tdcCssEditor._currentViewportSettings={name:"phone",settings:{limitTop:l[0].limitBottom,limitBottom:b}},e.isUndefined(a)||a.css("width",tdcCssEditor._currentViewportSettings.settings.limitTop-300));f(".tdc-responsiveness").replaceWith(tdcCssEditor._generateEditorResponsiveContent());
tdcCssEditor.doActionPanelRender();e.isUndefined(a)||(d=a.contents().find(".tdc-element-selected"),d.length&&(d=d.offset().top,d=0<c?window.innerHeight>c?d-c:d-100:d-100,a.contents().scrollTop(d)))})},_updateData:function(b){var a=b.data("model_id"),c=b.data("param_name"),d=b.closest(".tdc-tab-content");"undefined"===typeof a?tdcCssEditor.saveWidgetForm(b):(b=tdcIFrameData.getModel(a),d=tdcCssEditor._generateCssAttValue(d),tdcSidebarController.onUpdate(b,c,"",d))},saveWidgetForm:function(b){var a=
b.closest("form");b=b.closest(".tdc-tab-content");if(a.length){var c=a.find('input[name="id_base"]').val(),d=a.find('input[name="widget-id"]').val().replace(c+"-",""),c="'widget-"+c+"["+d+"][tdc_css]'",d=a.find("input[name="+c+"]"),e=tdcCssEditor._generateCssAttValue(b);b.data("tdc_css",e);d.length?d.val(e):a.append('<input type="hidden" name='+c+' value="'+e+'">')}},addWidgetCssEditor:function(b,a){tdcCssEditor._mappedParameter=b;return tdcCssEditor._generateEditorContent(a)},addComposerCssEditor:function(b,
a){tdcCssEditor._mappedParameter=b;tdcCssEditor._model=a;var c=a.get("attrs")[b.param_name];return tdcCssEditor._generateEditorContent(c)},_CsWpColorPicker:function(b){var a=b.closest(".tdc-property-wrap");b.cs_wpColorPicker();a.find(".wp-color-result");a.hasClass(tdcCssEditor._INHERITED_CSS_CLASS)?(a=a.find(".wp-color-result"),""!==b.attr("placeholder")&&a.attr("style","background-color: "+tdcCssEditor._getRgba(b.attr("placeholder")))):("no_value"===b.val()&&b.val(""),tdcCssEditor._checkDefaultColor(b))},
_checkDefaultColor:function(b){var a=b.closest(".tdc-property-wrap").find(".wp-color-result");""===b.val()&&(b=b.data("default_value"),e.isUndefined(b)?a.attr("style",""):a.attr("style","background-color: "+tdcCssEditor._getRgba(b)))},_generateEditorContent:function(d){if(e.isEmpty(d))tdcCssEditor._currentCssSettings=b;else try{var a=JSON.parse(window.atob(d));tdcDebug.log(a);e.isObject(a)?tdcCssEditor._currentCssSettings=a:tdcCssEditor._currentCssSettings=b}catch(l){tdcCssEditor._currentCssSettings=
b,new tdcNotice.notice(l.message,!1,!1)}tdcSidebarPanel._hook.addAction("panel_rendered",function(){f(".tdc-css-image-wrap").each(function(a,c){var d=f(c),g=d.closest(".tdc-property-wrap"),l=g.find(".tdc-css-image-remove"),k=g.find(".tdc-inherit-image"),p={isInherited:!1},u=tdcCssEditor._getSettingsProperty("background-image",b,p);p.isInherited?g.addClass(tdcCssEditor._INHERITED_CSS_CLASS):g.removeClass(tdcCssEditor._INHERITED_CSS_CLASS);e.isUndefined(u)?(l.addClass("tdc-hidden-button"),k.hide()):
("no_value"===u?l.addClass("tdc-hidden-button"):(l.removeClass("tdc-hidden-button"),d.attr("style",'background-image: url("'+u+'")')),"all"!==tdcCssEditor._currentViewportSettings.name&&k.show());d.data("image_link",u)});f(".tdc-inherit").each(function(a,c){var d=f(c),g=d.closest(".tdc-property-wrap");if("all"===tdcCssEditor._currentViewportSettings.name||g.hasClass(tdcCssEditor._INHERITED_CSS_CLASS))d.hide();else{var l=g.data("tdc-for"),g={isInherited:!1},l=tdcCssEditor._getSettingsProperty(l,b,
g);g.isInherited?d.hide():e.isUndefined(l)||d.show()}})});var c=a="",g="";d="";switch(tdcCssEditor._currentViewportSettings.name){case "all":a="selected";break;case "landscape":c="selected";break;case "portrait":g="selected";break;case "phone":d="selected"}a='<div class="tdc-responsive-buttons">'+('<div class="tdc-responsive-all '+a+'" title="Desktop viewport"><span class="tdc-all-icon"></span></div>')+('<div class="tdc-responsive-tablet-landscape '+c+'" title="Landscape viewport"><span class="tdc-tablet-landscape-icon"></span></div>')+
('<div class="tdc-responsive-tablet-portrait '+g+'" title="Portrait viewport"><span class="tdc-tablet-portrait-icon"></span></div>');a+='<div class="tdc-responsive-phone '+d+'" title="Phone viewport"><span class="tdc-phone-icon"></span></div>';a+="</div>";return a+=tdcCssEditor._generateEditorResponsiveContent()},_cleanCss:function(d,a){if("undefined"===typeof a)return b;if("no_value"===a)return a;if("background-image"===d){var c=/(url\s*\(\s*['"]?)(.*?)\s*(['"]?\s*\))/ig.exec(a);return e.isEmpty(c)?
"":c[2]}a=a.toLowerCase();a=a.replace(/!important|px/g,"");return a.trim()},_getDataNoValue:function(b){var a="";"no_value"===b&&(a=' data-no_value="1" ');return a},_generateEditorResponsiveContent:function(){function d(){return q={isInherited:!1}}function a(a){return"all"!==tdcCssEditor._currentViewportSettings.name?'placeholder="'+a+'"':""}function c(){return q.isInherited?" "+tdcCssEditor._INHERITED_CSS_CLASS:""}function g(a,b){var g=tdcCssEditor._getSettingsProperty(a,b,d()),f="-",h="";q.isInherited&&
(f=g,g="");e.isUndefined(k)||"margin-left"!==a&&"margin-right"!==a||(h=k.get("tag"),h="vc_column"===h||"vc_column_inner"===h?" "+tdcCssEditor._INACTIVE_CSS_CLASS:"");return'<input data-tdc-for="'+a+'" name="" type="text" value="'+g+'" class="tdc-css-box-input tdc-css-box-input-'+a+c()+h+'" title="Css '+a+'" placeholder="'+f+'" '+tdcSidebarPanel._getParamterDataAtts(l,k)+"/>"}tdcSidebarPanel._hook.removeAction("panel_css");var l=tdcCssEditor._mappedParameter,k=tdcCssEditor._model,q={isInherited:!1};
var h='<div class="tdc-responsiveness">'+('<div class="'+tdcSidebarPanel._getParameterClasses(l)+'">');h=h+'<div class="tdc-box-margin"><div class="tdc-margin-label">Margin</div>'+g("margin-top","");h+=g("margin-right","");h+=g("margin-bottom","");h+=g("margin-left","");h=h+'<div class="tdc-box-border"><div class="tdc-border-label">Border</div>'+g("border-top-width","");h+=g("border-right-width","");h+=g("border-bottom-width","");h+=g("border-left-width","");h=h+'<div class="tdc-box-padding"><div class="tdc-padding-label">Padding</div>'+
g("padding-top","");h+=g("padding-right","");h+=g("padding-bottom","");h+=g("padding-left","");h+="</div></div></div></div>";var m=tdcCssEditor._getSettingsProperty("border-style",b,d());h+='<div class="tdc-property-wrap tdc-border-style tdc-dropdown-big'+c()+'" data-tdc-for="border-style">';h=h+'<div class="tdc-property-title"><span title="Css border-style">Border style<div title="Revert to desktop settings" class="tdc-inherit tdc-inherit-select"></div></span></div><div class="tdc-property">'+('<select class="tdc-css-border-style" '+
tdcSidebarPanel._getParamterDataAtts(l,k)+' name="">');h+=tdcCssEditor._generateDropdownOptions([{value:"solid",display:"Solid"},{value:"dotted",display:"Dotted"},{value:"dashed",display:"Dashed"},{value:"none",display:"None"},{value:"hidden",display:"Hidden"},{value:"double",display:"Double"},{value:"groove",display:"Groove"},{value:"ridge",display:"Ridge"},{value:"inset",display:"Inset"},{value:"outset",display:"Outset"},{value:"initial",display:"Initial"},{value:"inherit",display:"Inherit"}],m);
h+="</select></div></div>";var n=e.uniqueId(),m=tdcCssEditor._getSettingsProperty("border-color","",d()),p="";q.isInherited&&(p=m,m="");h+='<div class="tdc-property-wrap tdc-property-colorpicker tdc-border-color'+c()+'" data-tdc-for="border-color">';h=h+'<div class="tdc-property-title"><span title="Css border-color">Border color<div title="Revert to desktop settings" class="tdc-inherit tdc-inherit-color"></div></span></div><div class="tdc-property">'+('<input class="tdc-css-border-color" '+tdcSidebarPanel._getParamterDataAtts(l,
k)+tdcCssEditor._getDataNoValue(m)+' data-default_value="#888888" id="'+n+'" name="" type="text" '+a(p)+' value="'+m+'"/>');h+="</div></div>";tdcSidebarPanel._hook.addAction("panel_css",function(){tdcCssEditor._CsWpColorPicker(f("#"+n))});m=tdcCssEditor._getSettingsProperty("border-radius","",d());p="";q.isInherited&&(p=m,m="");h+='<div class="tdc-property-wrap tdc-border-radius tdc-textfield-small'+c()+'" data-tdc-for="border-radius">';h=h+'<div class="tdc-property-title"><span title="Css border-radius">Border radius</span></div><div class="tdc-property">'+
('<input class="tdc-css-border-radius" '+tdcSidebarPanel._getParamterDataAtts(l,k)+' name="" type="text" '+a(p)+' value="'+m+'"/>');h+='</div></div><div class="tdc-sidebar-horizontal-separator tdc-property-wrap tdc-property-horizontal_separator tdc-property-separator "></div>';var u=e.uniqueId(),m=tdcCssEditor._getSettingsProperty("background-color","",d()),p="";q.isInherited&&(p=m,m="");h+='<div class="tdc-property-wrap tdc-property-colorpicker tdc-bg-color'+c()+'" data-tdc-for="background-color">';
h=h+'<div class="tdc-property-title"><span title="Css background-color">Background color<div title="Revert to desktop settings" class="tdc-inherit tdc-inherit-color"></div></span></div><div class="tdc-property">'+('<input class="tdc-css-bg-color" '+tdcSidebarPanel._getParamterDataAtts(l,k)+tdcCssEditor._getDataNoValue(m)+' id="'+u+'" name="" type="text" '+a(p)+' value="'+m+'"/>');h+="</div></div>";tdcSidebarPanel._hook.addAction("panel_css",function(){tdcCssEditor._CsWpColorPicker(f("#"+u))});tdcCssEditor._getSettingsProperty("background-image",
b,d());h+='<div class="tdc-property-wrap tdc-property-attach_image'+c()+'">';h=h+'<div class="tdc-property-title"><span title="Css background-image">Background image<div title="Revert to desktop settings" class="tdc-inherit tdc-inherit-image"></div></span></div><div class="tdc-property">'+('<div class="tdc-css-bg-image tdc-css-image-wrap " '+tdcSidebarPanel._getParamterDataAtts(l,k)+" style=\"background-image: url( '"+window.tdcAdminSettings.pluginUrl+"/assets/images/sidebar/no_img.png' )\"></div>");
h+='<a class="tdc-css-image-remove tdc-hidden-button" href="#" >Remove</a></div></div>';m=tdcCssEditor._getSettingsProperty("background-style",b,d());h+='<div class="tdc-property-wrap tdc-bg-style tdc-dropdown-big'+c()+'" data-tdc-for="background-style">';h=h+'<div class="tdc-property-title"><span title="Css background-size & background-repeat">Background style<div title="Revert to desktop settings" class="tdc-inherit tdc-inherit-select"></div></span></div><div class="tdc-property">'+('<select class="tdc-css-bg-style" '+
tdcSidebarPanel._getParamterDataAtts(l,k)+' name="">');h+=tdcCssEditor._generateDropdownOptions([{value:"cover",display:"Cover"},{value:"contain",display:"Contain"},{value:"no-repeat",display:"No repeat"},{value:"repeat",display:"Repeat"}],m);h+="</select></div></div>";m=tdcCssEditor._getSettingsProperty("background-position",b,d());h+='<div class="tdc-property-wrap tdc-bg-position tdc-dropdown-big'+c()+'" data-tdc-for="background-position">';h=h+'<div class="tdc-property-title"><span title="Css background-position">Background position<div title="Revert to desktop settings" class="tdc-inherit tdc-inherit-select"></div></span></div><div class="tdc-property">'+
('<select class="tdc-css-bg-position" '+tdcSidebarPanel._getParamterDataAtts(l,k)+' name="">');h+=tdcCssEditor._generateDropdownOptions([{value:"center top",display:"Center Top"},{value:"center center",display:"Center Center"},{value:"center bottom",display:"Center Bottom"},{value:"left top",display:"Left Top"},{value:"left center",display:"Left Center"},{value:"left bottom",display:"Left Bottom"},{value:"right top",display:"Right Top"},{value:"right center",display:"Right Center"},{value:"right bottom",
display:"Right Bottom"}],m);h+="</select></div></div>";m=tdcCssEditor._getSettingsProperty("opacity","",d());p="";q.isInherited&&(p=m,m="");h+='<div class="tdc-property-wrap tdc-opacity tdc-textfield-small'+c()+'" data-tdc-for="opacity">';h=h+'<div class="tdc-property-title"><span title="Css background-image opacity">Background opacity</span></div><div class="tdc-property">'+('<input class="tdc-css-opacity" '+tdcSidebarPanel._getParamterDataAtts(l,k)+' name="" type="text" '+a(p)+' value="'+m+'"/>');
h+='</div></div><div class="tdc-sidebar-horizontal-separator tdc-property-wrap tdc-property-horizontal_separator tdc-property-separator"></div>';var v=e.uniqueId(),m=tdcCssEditor._getSettingsProperty("color-1-overlay","",d()),p="";q.isInherited&&(p=m,m="");h+='<div class="tdc-property-wrap tdc-property-colorpicker tdc-color-1-overlay'+c()+'" data-tdc-for="color-1-overlay">';h=h+'<div class="tdc-property-title"><span title="Css gradient color From">Color 1 overlay<div title="Revert to desktop settings" class="tdc-inherit tdc-inherit-color"></div></span></div><div class="tdc-property">'+
('<input class="tdc-css-color-1-overlay" '+tdcSidebarPanel._getParamterDataAtts(l,k)+tdcCssEditor._getDataNoValue(m)+' id="'+v+'" name="" type="text" '+a(p)+' value="'+m+'"/>');h+="</div></div>";tdcSidebarPanel._hook.addAction("panel_css",function(){tdcCssEditor._CsWpColorPicker(f("#"+v))});var w=e.uniqueId(),m=tdcCssEditor._getSettingsProperty("color-2-overlay","",d()),p="";q.isInherited&&(p=m,m="");h+='<div class="tdc-property-wrap tdc-property-colorpicker tdc-color-2-overlay'+c()+'" data-tdc-for="color-2-overlay">';
h=h+'<div class="tdc-property-title"><span  title="Css gradient color To">Color 2 overlay<div title="Revert to desktop settings" class="tdc-inherit tdc-inherit-color"></div></span></div><div class="tdc-property">'+('<input class="tdc-css-color-2-overlay" '+tdcSidebarPanel._getParamterDataAtts(l,k)+tdcCssEditor._getDataNoValue(m)+' id="'+w+'" name="" type="text" '+a(p)+' value="'+m+'"/>');h+="</div></div>";tdcSidebarPanel._hook.addAction("panel_css",function(){tdcCssEditor._CsWpColorPicker(f("#"+w))});
h=h+'<div class="tdc-sidebar-horizontal-separator tdc-property-wrap tdc-property-horizontal_separator tdc-property-separator"></div>'+('<div class="tdc-clear-css-properties" '+tdcSidebarPanel._getParamterDataAtts(l,k)+' title="Clear all tab css settings">Clear CSS settings</div>');return h+"</div>"},_getAvailableViewportSetting:function(b,a,c){if("undefined"!==typeof tdcCssEditor._currentCssSettings){var d;switch(b){case "all":"undefined"!==typeof tdcCssEditor._currentCssSettings[b]&&(d="all");break;
case "landscape":case "portrait":case "phone":"undefined"!==typeof tdcCssEditor._currentCssSettings[b]?d=b:"undefined"!==typeof tdcCssEditor._currentCssSettings.all&&(d="all")}if("undefined"!==typeof d){if("undefined"!==typeof tdcCssEditor._currentCssSettings[d][a])return tdcCssEditor._currentViewportSettings.name!==d&&(c.isInherited=!0,tdcDebug.log(a)),tdcCssEditor._cleanCss(a,tdcCssEditor._currentCssSettings[d][a]);if("all"!==d)return tdcCssEditor._getAvailableViewportSetting("all",a,c)}}},_getSettingsProperty:function(b,
a,c){var d;"undefined"===typeof c&&(c={isInherited:!1});"undefined"!==typeof tdcCssEditor._currentCssSettings&&(d=tdcCssEditor._getAvailableViewportSetting(tdcCssEditor._currentViewportSettings.name,b,c));"undefined"===typeof d&&"undefined"!==typeof a&&(d=a);return d},_generateDropdownOptions:function(b,a,c){for(var d=[],f,k=!1,q=0,h=0;h<b.length;h++)e.isUndefined(c)||c!==b[h].value||(q=h),f="",e.isUndefined(a)||a!==b[h].value||(f='selected="selected"',k=!0),d.push("<option "+f+' value="'+b[h].value+
'">'+b[h].display+"</option>");k||(d[q]='<option selected="selected" value="'+b[q].value+'">'+b[q].display+"</option>");return d.join("")},_generateCssAttValue:function(b){var a={},c=b.find(".tdc-css-box-input-margin-top").val().trim(),d=b.find(".tdc-css-box-input-margin-right").val().trim(),f=b.find(".tdc-css-box-input-margin-bottom").val().trim(),k=b.find(".tdc-css-box-input-margin-left").val().trim(),q=b.find(".tdc-css-box-input-border-top-width").val().trim(),h=b.find(".tdc-css-box-input-border-right-width").val().trim(),
m=b.find(".tdc-css-box-input-border-bottom-width").val().trim(),n=b.find(".tdc-css-box-input-border-left-width").val().trim(),p=b.find(".tdc-css-box-input-padding-top").val().trim(),u=b.find(".tdc-css-box-input-padding-right").val().trim(),v=b.find(".tdc-css-box-input-padding-bottom").val().trim(),w=b.find(".tdc-css-box-input-padding-left").val().trim(),r=b.find(".tdc-css-border-radius").val().trim(),t=b.find(".tdc-css-opacity").val().trim();""!==c&&(a["margin-top"]=c);""!==d&&(a["margin-right"]=
d);""!==f&&(a["margin-bottom"]=f);""!==k&&(a["margin-left"]=k);""!==q&&(a["border-top-width"]=q);""!==h&&(a["border-right-width"]=h);""!==m&&(a["border-bottom-width"]=m);""!==n&&(a["border-left-width"]=n);""!==p&&(a["padding-top"]=p);""!==u&&(a["padding-right"]=u);""!==v&&(a["padding-bottom"]=v);""!==w&&(a["padding-left"]=w);c=b.find(".tdc-css-border-style");d=c.val().trim();""===d||c.closest(".tdc-property-wrap").hasClass(tdcCssEditor._INHERITED_CSS_CLASS)||(a["border-style"]=d);c=b.find(".tdc-css-border-color");
d=c.val().trim();""!==d?a["border-color"]=d:(c=c.data("no_value"),e.isUndefined(c)||1!==c||(a["border-color"]="no_value"));""!==r&&(a["border-radius"]=r);r=b.find(".tdc-css-bg-color");c=r.val().trim();""!==c?a["background-color"]=c:(r=r.data("no_value"),e.isUndefined(r)||1!==r||(a["background-color"]="no_value"));r=b.find(".tdc-css-bg-image");r.closest(".tdc-property-wrap").hasClass(tdcCssEditor._INHERITED_CSS_CLASS)||(r=r.data("image_link"),e.isUndefined(r)||("no_value"===r?a["background-image"]=
"no_value":""!==r&&(a["background-image"]='url("'+r+'")')));r=b.find(".tdc-css-bg-style");c=r.val().trim();""===c||r.closest(".tdc-property-wrap").hasClass(tdcCssEditor._INHERITED_CSS_CLASS)||(a["background-style"]=c);r=b.find(".tdc-css-bg-position");c=r.val().trim();""===c||r.closest(".tdc-property-wrap").hasClass(tdcCssEditor._INHERITED_CSS_CLASS)||(a["background-position"]=c);""!==t&&(a.opacity=t);t=b.find(".tdc-css-color-1-overlay");r=t.val().trim();""!==r?a["color-1-overlay"]=r:(t=t.data("no_value"),
e.isUndefined(t)||1!==t||(a["color-1-overlay"]="no_value"));b=b.find(".tdc-css-color-2-overlay");t=b.val().trim();""!==t?a["color-2-overlay"]=t:(b=b.data("no_value"),e.isUndefined(b)||1!==b||(a["color-2-overlay"]="no_value"));e.isUndefined(tdcCssEditor._currentCssSettings)&&(tdcCssEditor._currentCssSettings={});e.isUndefined(a["border-style"])||"solid"!==a["border-style"]||("all"===tdcCssEditor._currentViewportSettings.name||e.isUndefined(tdcCssEditor._currentCssSettings.all)||e.isUndefined(tdcCssEditor._currentCssSettings.all["border-style"]))&&
delete a["border-style"];e.isUndefined(a["background-style"])||"cover"!==a["background-style"]||("all"===tdcCssEditor._currentViewportSettings.name||e.isUndefined(tdcCssEditor._currentCssSettings.all)||e.isUndefined(tdcCssEditor._currentCssSettings.all["background-style"]))&&delete a["background-style"];e.isUndefined(a["background-position"])||"center top"!==a["background-position"]||("all"===tdcCssEditor._currentViewportSettings.name||e.isUndefined(tdcCssEditor._currentCssSettings.all)||e.isUndefined(tdcCssEditor._currentCssSettings.all["background-position"]))&&
delete a["background-position"];tdcDebug.log(a);e.isEmpty(a)?(delete tdcCssEditor._currentCssSettings[tdcCssEditor._currentViewportSettings.name],delete tdcCssEditor._currentCssSettings[tdcCssEditor._currentViewportSettings.name+"_max_width"],delete tdcCssEditor._currentCssSettings[tdcCssEditor._currentViewportSettings.name+"_min_width"]):(tdcCssEditor._currentCssSettings[tdcCssEditor._currentViewportSettings.name]=a,e.isUndefined(tdcCssEditor._currentViewportSettings.settings)||(tdcCssEditor._currentCssSettings[tdcCssEditor._currentViewportSettings.name+
"_max_width"]=tdcCssEditor._currentViewportSettings.settings.limitTop,tdcCssEditor._currentCssSettings[tdcCssEditor._currentViewportSettings.name+"_min_width"]=tdcCssEditor._currentViewportSettings.settings.limitBottom));tdcDebug.log(tdcCssEditor._currentCssSettings);tdcDebug.log("JSON.stringify");tdcDebug.log(JSON.stringify(tdcCssEditor._currentCssSettings));return e.isEmpty(tdcCssEditor._currentCssSettings)?"":window.btoa(JSON.stringify(tdcCssEditor._currentCssSettings))},_getRgba:function(b){return-1!==
b.indexOf("rgb")?b:(b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b))?"rgb("+parseInt(b[1],16)+", "+parseInt(b[2],16)+", "+parseInt(b[3],16)+")":""}}})(jQuery,_);
(function(f,e,b,d){f.widget("wp.wpColorPicker",{options:{defaultColor:!1,change:!1,clear:!1,hide:!0,palettes:!0,width:255,mode:"hsv"},_create:function(){if(f.support.iris){var a=this,b=a.element;f.extend(a.options,b.data());a.close=f.proxy(a.close,a);a.initialValue=b.val();b.addClass("wp-color-picker").hide().wrap('<div class="wp-picker-container" />');a.wrap=b.parent();a.toggler=f('<a tabindex="0" class="wp-color-result" />').insertBefore(b).css({backgroundColor:a.initialValue}).attr("title",wpColorPickerL10n.pick).attr("data-current",
wpColorPickerL10n.current);a.pickerContainer=f('<div class="wp-picker-holder" />').insertAfter(b);a.button=f('<input type="button" class="button button-small hidden" />');a.options.defaultColor?a.button.addClass("wp-picker-default").val(wpColorPickerL10n.defaultString):a.button.addClass("wp-picker-clear").val(wpColorPickerL10n.clear);b.wrap('<span class="wp-picker-input-wrap" />').after(a.button);b.iris({target:a.pickerContainer,hide:a.options.hide,width:a.options.width,mode:a.options.mode,palettes:a.options.palettes,
change:function(b,c){a.toggler.css({backgroundColor:c.color.toString()});f.isFunction(a.options.change)&&a.options.change.call(this,b,c)}});b.val(a.initialValue);a._addListeners();a.options.hide||a.toggler.click()}},_addListeners:function(){var a=this;a.wrap.on("click.wpcolorpicker",function(a){a.stopPropagation()});a.toggler.click(function(){a.toggler.hasClass("wp-picker-open")?a.close():a.open()});a.element.change(function(b){var c=f(this).val();if(""===c||"#"===c)a.toggler.css("backgroundColor",
""),f.isFunction(a.options.clear)&&a.options.clear.call(this,b)});a.toggler.on("keyup",function(b){if(13===b.keyCode||32===b.keyCode)b.preventDefault(),a.toggler.trigger("click").next().focus()});a.button.click(function(b){var c=f(this);c.hasClass("wp-picker-clear")?(a.element.val(""),a.toggler.css("backgroundColor",""),f.isFunction(a.options.clear)&&a.options.clear.call(this,b)):c.hasClass("wp-picker-default")&&a.element.val(a.options.defaultColor).change()})},open:function(){this.element.show().iris("toggle").focus();
this.button.removeClass("hidden");this.wrap.addClass("wp-picker-active");this.toggler.addClass("wp-picker-open");f("body").trigger("click.wpcolorpicker").on("click.wpcolorpicker",this.close)},close:function(){this.element.hide();this.element.iris("instance")&&this.element.iris("toggle");this.button.addClass("hidden");this.wrap.removeClass("wp-picker-active");this.toggler.removeClass("wp-picker-open");f("body").off("click.wpcolorpicker",this.close)},color:function(a){if(a===d)return this.element.iris("option",
"color");this.element.iris("option","color",a)},defaultColor:function(a){if(a===d)return this.options.defaultColor;this.options.defaultColor=a}});typeof Color.fn.toString!==d&&(Color.fn.toString=function(){if(1>this._alpha)return this.toCSS("rgba",this._alpha).replace(/\s+/g,"");var a=parseInt(this._color,10).toString(16);if(this.error)return"";if(6>a.length)for(var b=6-a.length-1;0<=b;b--)a="0"+a;return"#"+a});f.cs_ParseColorValue=function(a){a=a.replace(/\s+/g,"");var b=-1!==a.indexOf("rgba")?parseFloat(100*
a.replace(/^.*,(.+)\)/,"$1")):100;return{value:a,alpha:b,rgba:100>b?!0:!1}};f.fn.cs_wpColorPicker=function(){return this.each(function(){var a=f(this);if(!1!==a.data("rgba")){var b=f.cs_ParseColorValue(a.val());a.wpColorPicker({clear:function(){a.trigger("keyup")},change:function(b,c){var d=c.color.toString();a.closest(".wp-picker-container").find(".cs-alpha-slider-offset").css("background-color",d);a.val(d).trigger("change")},create:function(){var c=a.data("a8cIris"),d=a.closest(".wp-picker-container"),
e=f('<div class="cs-alpha-wrap"><div class="cs-alpha-slider"></div><div class="cs-alpha-slider-offset"></div><div class="cs-alpha-text"></div></div>').appendTo(d.find(".wp-picker-holder")),q=e.find(".cs-alpha-slider"),h=e.find(".cs-alpha-text"),m=e.find(".cs-alpha-slider-offset");q.slider({slide:function(b,d){var e=parseFloat(d.value/100);c._color._alpha=e;a.wpColorPicker("color",c._color.toString());h.text(1>e?e:"")},create:function(){var g=parseFloat(b.alpha/100);h.text(1>g?g:"");m.css("background-color",
b.value);d.on("click",".wp-picker-clear",function(){c._color._alpha=1;h.text("");q.slider("option","value",100).trigger("slide")});d.on("click",".wp-picker-default",function(){var b=f.cs_ParseColorValue(a.data("default-color")),d=parseFloat(b.alpha/100);c._color._alpha=d;h.text(1>d?d:"");q.slider("option","value",b.alpha).trigger("slide")});d.on("click",".wp-color-result",function(a){e.toggle()});f("body").on("click.wpcolorpicker",function(){e.hide()})},value:b.alpha,step:1,min:1,max:100})}})}else a.wpColorPicker({clear:function(){a.trigger("keyup")},
change:function(b,c){a.val(c.color.toString()).trigger("change")}})})};f(b).ready(function(){f(".cs-wp-color-picker").cs_wpColorPicker()})})(jQuery,window,document);
(function(f){var e=function(){this.cssImportStatements=[];this.cssKeyframeStatements=[];this.cssRegex=RegExp("([\\s\\S]*?){([\\s\\S]*?)}","gi");this.cssMediaQueryRegex="((@media [\\s\\S]*?){([\\s\\S]*?}\\s*?)})";this.cssKeyframeRegex="((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})";this.combinedCSSRegex="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})";this.cssCommentsRegex="(\\/\\*[\\s\\S]*?\\*\\/)";this.cssImportStatementRegex=RegExp("@import .*?;",
"gi")};e.prototype.stripComments=function(b){return b.replace(new RegExp(this.cssCommentsRegex,"gi"),"")};e.prototype.parseCSS=function(b){if(void 0===b)return[];for(var d=[];;){var a=this.cssImportStatementRegex.exec(b);if(null!==a)this.cssImportStatements.push(a[0]),d.push({selector:"@imports",type:"imports",styles:a[0]});else break}b=b.replace(this.cssImportStatementRegex,"");for(var a=new RegExp(this.cssKeyframeRegex,"gi"),c;;){c=a.exec(b);if(null===c)break;d.push({selector:"@keyframes",type:"keyframes",
styles:c[0]})}b=b.replace(a,"");for(a=new RegExp(this.combinedCSSRegex,"gi");;){c=a.exec(b);if(null===c)break;var e=void 0===c[2]?c[5].split("\r\n").join("\n").trim():c[2].split("\r\n").join("\n").trim();var f=new RegExp(this.cssCommentsRegex,"gi"),k=f.exec(e);null!==k&&(e=e.replace(f,"").trim());e=e.replace(/\n+/,"\n");-1!==e.indexOf("@media")?(e={selector:e,type:"media",subStyles:this.parseCSS(c[3]+"\n}")},null!==k&&(e.comments=k[0]),d.push(e)):(c=this.parseRules(c[6]),c={selector:e,rules:c},"@font-face"===
e&&(c.type="font-face"),null!==k&&(c.comments=k[0]),d.push(c))}return d};e.prototype.parseRules=function(b){b=b.split("\r\n").join("\n");var d=[];b=b.split(";");for(var a=0;a<b.length;a++){var c=b[a],c=c.trim();if(-1!==c.indexOf(":")){var c=c.split(":"),e=c[0].trim(),c=c.slice(1).join(":").trim();1>e.length||1>c.length||d.push({directive:e,value:c})}else"base64,"===c.trim().substr(0,7)?d[d.length-1].value+=c.trim():0<c.length&&d.push({directive:"",value:c,defective:!0})}return d};e.prototype.findCorrespondingRule=
function(b,d,a){void 0===a&&(a=!1);for(var c=!1,e=0;e<b.length&&(b[e].directive!==d||(c=b[e],a!==b[e].value));e++);return c};e.prototype.findBySelector=function(b,d,a){void 0===a&&(a=!1);for(var c=[],e=0;e<b.length;e++)!1===a?b[e].selector===d&&c.push(b[e]):-1!==b[e].selector.indexOf(d)&&c.push(b[e]);if(2>c.length)return c;b=c[0];for(e=1;e<c.length;e++)this.intelligentCSSPush([b],c[e]);return[b]};e.prototype.deleteBySelector=function(b,d){for(var a=[],c=0;c<b.length;c++)b[c].selector!==d&&a.push(b[c]);
return a};e.prototype.compressCSS=function(b){for(var d=[],a={},c=0;c<b.length;c++){var e=b[c];if(!0!==a[e.selector]){var f=this.findBySelector(b,e.selector);0!==f.length&&(d.push(f[0]),a[e.selector]=!0)}}return d};e.prototype.cssDiff=function(b,d){if(b.selector!==d.selector||"media"===b.type||"media"===d.type)return!1;for(var a={selector:b.selector,rules:[]},c,e,f=0;f<b.rules.length;f++)c=b.rules[f],e=this.findCorrespondingRule(d.rules,c.directive,c.value),!1===e?a.rules.push(c):c.value!==e.value&&
a.rules.push(c);for(f=0;f<d.rules.length;f++)e=d.rules[f],c=this.findCorrespondingRule(b.rules,e.directive),!1===c&&(e.type="DELETED",a.rules.push(e));return 0===a.rules.length?!1:a};e.prototype.intelligentMerge=function(b,d,a){void 0===a&&(a=!1);for(var c=0;c<d.length;c++)this.intelligentCSSPush(b,d[c],a);for(c=0;c<b.length;c++)d=b[c],"media"!==d.type&&"keyframes"!==d.type&&(d.rules=this.compactRules(d.rules))};e.prototype.intelligentCSSPush=function(b,d,a){var c=!1;void 0===a&&(a=!1);if(!1===a)for(a=
0;a<b.length;a++){if(b[a].selector===d.selector){c=b[a];break}}else for(a=b.length-1;-1<a;a--)if(b[a].selector===d.selector){c=b[a];break}if(!1===c)b.push(d);else if("media"!==d.type)for(b=0;b<d.rules.length;b++){a=d.rules[b];var e=this.findCorrespondingRule(c.rules,a.directive);!1===e?c.rules.push(a):"DELETED"===a.type?e.type="DELETED":e.value=a.value}else c.subStyles=c.subStyles.concat(d.subStyles)};e.prototype.compactRules=function(b){for(var d=[],a=0;a<b.length;a++)"DELETED"!==b[a].type&&d.push(b[a]);
return d};e.prototype.getCSSForEditor=function(b,d){void 0===d&&(d=0);var a="";void 0===b&&(b=this.css);for(var c=0;c<b.length;c++)"imports"===b[c].type&&(a+=b[c].styles+"\n\n");for(c=0;c<b.length;c++){var e=b[c];if(void 0!==e.selector){var f="";void 0!==e.comments&&(f=e.comments+"\n");"media"===e.type?(a+=f+e.selector+"{\n",a+=this.getCSSForEditor(e.subStyles,d+1),a+="}\n\n"):"keyframes"!==e.type&&"imports"!==e.type&&(a+=this.getSpaces(d)+f+e.selector+" {\n",a+=this.getCSSOfRules(e.rules,d+1),a+=
this.getSpaces(d)+"}\n\n")}}for(c=0;c<b.length;c++)"keyframes"===b[c].type&&(a+=b[c].styles+"\n\n");return a};e.prototype.getImports=function(b){for(var d=[],a=0;a<b.length;a++)"imports"===b[a].type&&d.push(b[a].styles);return d};e.prototype.getCSSOfRules=function(b,d){for(var a="",c=0;c<b.length;c++)void 0!==b[c]&&(a=void 0===b[c].defective?a+(this.getSpaces(d)+b[c].directive+": "+b[c].value+";\n"):a+(this.getSpaces(d)+b[c].value+";\n"));return a||"\n"};e.prototype.getSpaces=function(b){for(var d=
"",a=0;a<4*b;a++)d+=" ";return d};e.prototype.applyNamespacing=function(b,d){var a=b,c="."+this.cssPreviewNamespace;void 0!==d&&(c=d);"string"===typeof b&&(a=this.parseCSS(b));for(var e=0;e<a.length;e++){var f=a[e];if(!(-1<f.selector.indexOf("@font-face")||-1<f.selector.indexOf("keyframes")||-1<f.selector.indexOf("@import")||-1<f.selector.indexOf(".form-all")||-1<f.selector.indexOf("#stage")))if("media"!==f.type){for(var k=f.selector.split(","),q=[],h=0;h<k.length;h++)-1===k[h].indexOf(".supernova")?
q.push(c+" "+k[h]):q.push(k[h]);f.selector=q.join(",")}else f.subStyles=this.applyNamespacing(f.subStyles,d)}return a};e.prototype.clearNamespacing=function(b,d){void 0===d&&(d=!1);var a=b,c="."+this.cssPreviewNamespace;"string"===typeof b&&(a=this.parseCSS(b));for(var e=0;e<a.length;e++){var f=a[e];if("media"!==f.type){for(var k=f.selector.split(","),q=[],h=0;h<k.length;h++)q.push(k[h].split(c+" ").join(""));f.selector=q.join(",")}else f.subStyles=this.clearNamespacing(f.subStyles,!0)}return!1===
d?this.getCSSForEditor(a):a};e.prototype.createStyleElement=function(b,d,a){void 0===a&&(a=!1);!1===this.testMode&&"nonamespace"!==a&&(d=this.applyNamespacing(d));"string"!==typeof d&&(d=this.getCSSForEditor(d));!0===a&&(d=this.getCSSForEditor(this.parseCSS(d)));if(!1!==this.testMode)return this.testMode("create style #"+b,d);(a=document.getElementById(b))&&a.parentNode.removeChild(a);a=document.head||document.getElementsByTagName("head")[0];var c=document.createElement("style");c.id=b;c.type="text/css";
a.appendChild(c);c.styleSheet&&!c.sheet?c.styleSheet.cssText=d:c.appendChild(document.createTextNode(d))};f.cssjs=e})(this);var tdcLoader={init:function(){}};jQuery(window).load(function(){jQuery("body").addClass("tdcComposerLoaded")});var tdcLivePanel;
(function(f,e){tdcLivePanel={$tdcAction:e,$tdcContent:e,$tdcIframeCover:e,_iframeSrc:e,$panel:e,_currentSettingsPanel:e,_currentSettingsPanelInLoading:!1,init:function(){tdcLivePanel.$panel=jQuery("#tdc-live-panel");tdcLivePanel.$tdcAction=tdcLivePanel.$panel.find("#tdc_action");tdcLivePanel.$tdcContent=tdcLivePanel.$panel.find("#tdc_content");tdcLivePanel.$tdcCustomized=tdcLivePanel.$panel.find("#tdc_customized");tdcLivePanel.$tdcIframeCover=jQuery("#tdc-iframe-cover");tdcLivePanel.$panel.submit({},
function(b){var d=jQuery("#tdc-live-iframe-temp");d.load(function(){var a=jQuery(this);if("tdc-live-iframe-temp"!==a.attr("id"))tdcAdminIFrameUI.checkIframe(a);else{var b=jQuery("#tdc-live-iframe");tdcLivePanel.$tdcIframeCover.removeClass("tdc-iframe-cover-show");b.addClass("tdc-remove-iframe");setTimeout(function(){b.remove();d.attr("id","tdc-live-iframe");tdcAdminIFrameUI.checkIframe(d);tdcLivePanel.$panel.attr("action","")},400)}})});tdcLivePanel.$panel.on("change","#tdc_page_template",function(b){b.preventDefault();
b=jQuery(this);var d=b.data("control-id");jQuery("#hidden_"+d).val(b.closest(".td-box").attr("id"));tdcLivePanel.submit()});tdcLivePanel.$panel.on("click",".tdc-page-template",function(b){b=jQuery(this);var d=b.data("control-id");jQuery("#hidden_"+d).val(b.closest(".td-box").attr("id"));tdcLivePanel.submit()});tdcLivePanel.$panel.on("click",".td-visual-selector-o-img",function(b){b.preventDefault();b=jQuery(this);var d=b.data("uid");jQuery("#"+d).val(b.data("option-value"));tdcLivePanel.submit()});
tdcLivePanel.$panel.on("click",".tdc-panel-menu",function(b){var d=jQuery(this);b=d.data("menu_id");d=d.data("menu_name");tdcLivePanelMenuSettings.showSettings(b,d)});tdcLivePanel.$panel.on("click",".tdc-page-settings",function(b){tdcLivePanelPageSettings.showSettings()})},setCurrentSettingsPanel:function(b){var d;if(!f.isUndefined(b)){if(!f.isUndefined(tdcLivePanel._currentSettingsPanel)){if(tdcLivePanel._currentSettingsPanel===b)return;var a=(d=tdcLivePanel._currentSettingsPanel.hasClass("clear-position"))?
tdcLivePanel._currentSettingsPanel.getPosition(!1):tdcLivePanel._currentSettingsPanel.getPosition(!0);tdcLivePanel._currentSettingsPanel.removeClass("clear-position");tdcLivePanel._currentSettingsPanel.closeSettings()}tdcLivePanel._currentSettingsPanel=b;!f.isUndefined(d)&&d&&(tdcLivePanel._currentSettingsPanel.addClass("clear-position"),tdcLivePanel._currentSettingsPanel.setPosition(a))}},getCurrentSettingsPanel:function(){return tdcLivePanel._currentSettingsPanel},submit:function(){var b=jQuery("#tdc-live-iframe");
f.isUndefined(tdcLivePanel._iframeSrc)&&(tdcLivePanel._iframeSrc=b.attr("src"));var d="uid_"+Math.floor(1E4*Math.random()+1)+"_"+Math.floor(100*Math.random()+1);jQuery('<iframe id="tdc-live-iframe-temp" name="'+d+'" scrolling="auto" src="about:blank" style="width: 100%; height: 100%" class="tdc-live-iframe-temp"></iframe>').insertAfter(b);tdcLivePanel.$panel.attr("target",d);tdcLivePanel.$panel.attr("action",tdcLivePanel._iframeSrc);tdcLivePanel.$tdcIframeCover.show();tdcLivePanel.$tdcIframeCover.addClass("tdc-iframe-cover-show");
b={error:e,getShortcode:""};tdcIFrameData.getShortcodeFromData(b);f.isUndefined(b.error)||tdcDebug.log(b.error);f.isUndefined(b.getShortcode)||(tdcLivePanel.$tdcContent.val(b.getShortcode),window.tdcPostSettings.postContent=b.getShortcode);tdcLivePanel.$tdcAction.val("preview");tdcLivePanel.$tdcCustomized.val(JSON.stringify(window.tdcAdminSettings.customized));tdcLivePanel.$panel.submit()}};tdcLivePanel.init()})(_);
function preinit(f){api.menuList=f.find("#menu-to-edit");api.targetList=api.menuList}var tdcLivePanelMenuSettings;
(function(f,e){tdcLivePanelMenuSettings={_isInitialized:!1,_menuId:e,_menuName:e,_url:e,_currentIframeId:e,$_currentIframeMenuSettings:e,$_tdcMenuSettings:e,$_iframeCloseButton:e,$_iframeApplyButton:e,$_iframeOkButton:e,init:function(){tdcLivePanelMenuSettings._isInitialized||(tdcLivePanelMenuSettings.$_tdcMenuSettings=jQuery("#tdc-menu-settings"),tdcLivePanelMenuSettings._isInitialized=!0)},showSettings:function(b,d){tdcLivePanel.setCurrentSettingsPanel(tdcLivePanelMenuSettings);tdcLivePanelMenuSettings._menuId=
b;tdcLivePanelMenuSettings._menuName=d;tdcLivePanelMenuSettings._url=window.tdcAdminSettings.adminUrl+"/nav-menus.php?action=edit&menu="+b+"&tdc-menu-settings=1";tdcLivePanelMenuSettings._currentIframeId="tdc-iframe-settings-menu-"+tdcLivePanelMenuSettings._menuId;tdcLivePanelMenuSettings.$_currentIframeMenuSettings=tdcLivePanelMenuSettings.$_tdcMenuSettings.find("#"+tdcLivePanelMenuSettings._currentIframeId);var a=tdcLivePanelMenuSettings._currentIframeId+"-data",c=tdcLivePanelMenuSettings.$_tdcMenuSettings.find("#"+
a);c.length||(c=jQuery('<div id="'+a+'" style="display: none"></div>'),tdcLivePanelMenuSettings.$_tdcMenuSettings.append(c));tdcLivePanelMenuSettings.$_tdcMenuSettings.show();tdcWindowFrame.setWindowFrame(tdcLivePanelMenuSettings.$_tdcMenuSettings);tdcLivePanelMenuSettings.$_currentIframeMenuSettings.length?(tdcLivePanelMenuSettings.$_currentIframeMenuSettings.show(),tdcLivePanelMenuSettings._setIframeInterface({type:"menu",menuId:b,menuName:d}),tdcLivePanelMenuSettings._synchronizeIframeMenuData(tdcLivePanelMenuSettings._currentIframeId)):
(tdcLivePanelMenuSettings.$_tdcMenuSettings.addClass("tdc-dropped"),tdcLivePanelMenuSettings.$_currentIframeMenuSettings=jQuery('<iframe id="'+tdcLivePanelMenuSettings._currentIframeId+'" class="tdc-iframe-settings-menu" src="'+tdcLivePanelMenuSettings._url+'" data-menu_id="'+tdcLivePanelMenuSettings._menuId+'" scrolling="auto" style="width: 100%; height: 100%"></iframe>'),tdcLivePanelMenuSettings.$_tdcMenuSettings.children(".content").append(tdcLivePanelMenuSettings.$_currentIframeMenuSettings),
tdcLivePanelMenuSettings.$_currentIframeMenuSettings.load(function(){var a=tdcLivePanelMenuSettings.$_currentIframeMenuSettings.contents();tdcLivePanelMenuSettings.$_tdcMenuSettings.removeClass("tdc-dropped");tdcLivePanelMenuSettings._setIframeInterface({type:"menu",menuId:tdcLivePanelMenuSettings._menuId,menuName:tdcLivePanelMenuSettings._menuName});tdcLivePanelMenuSettings._synchronizeIframeMenuData(tdcLivePanelMenuSettings._currentIframeId);a.find("body").on("mousedown mouseup",function(a){window.parent.jQuery("#tdc-menu-settings").trigger(a)});
tdcLivePanelMenuSettings!==tdcLivePanel.getCurrentSettingsPanel()&&tdcLivePanelMenuSettings.closeSettings()}));tdcLivePanelMenuSettings.$_currentIframeMenuSettings.siblings(".tdc-iframe-settings-menu").each(function(a,b){var c=jQuery(b);c.is(":visible")&&(tdcLivePanelMenuSettings._synchronizeIframeMenuData(c.attr("id")),c.hide())});tdcLivePanelMenuSettings!==tdcLivePanel.getCurrentSettingsPanel()&&tdcLivePanelMenuSettings.closeSettings()},_closeSettings:function(){if(!f.isUndefined(tdcLivePanelMenuSettings.$_iframeCloseButton)){var b=
jQuery("#"+tdcLivePanelMenuSettings.$_iframeCloseButton.data("current_iframe")),d=jQuery("#"+tdcLivePanelMenuSettings.$_iframeCloseButton.data("current_iframe")+"-data"),a=d.html(),c=b.contents().find("#update-nav-menu");""!==a&&(c.html(a),tdcLivePanelMenuSettings._reinitWpNavMenu(b[0].contentWindow||b[0].contentDocument),d.html(""));tdcLivePanelMenuSettings.$_tdcMenuSettings.hide();b.hide()}},closeSettings:function(){f.isUndefined(tdcLivePanelMenuSettings.$_iframeCloseButton)||(tdcLivePanelMenuSettings.$_iframeCloseButton.trigger("click"),
tdcLivePanelMenuSettings.removeClass("clear-position"))},setPosition:function(b){tdcLivePanelMenuSettings.$_tdcMenuSettings.css({top:b.top,left:b.left})},getPosition:function(b){var d={};d.top=tdcLivePanelMenuSettings.$_tdcMenuSettings.offset().top-jQuery(window).scrollTop();d.left=tdcLivePanelMenuSettings.$_tdcMenuSettings.offset().left-jQuery(window).scrollLeft();b&&(d.top+=tdcLivePanelMenuSettings.$_tdcMenuSettings.height()/2,d.left+=tdcLivePanelMenuSettings.$_tdcMenuSettings.width()/2);return d},
addClass:function(b){tdcLivePanelMenuSettings.$_tdcMenuSettings.addClass(b)},removeClass:function(b){tdcLivePanelMenuSettings.$_tdcMenuSettings.removeClass(b)},hasClass:function(b){return tdcLivePanelMenuSettings.$_tdcMenuSettings.hasClass(b)},_synchronizeIframeMenuData:function(b){var d=tdcLivePanelMenuSettings.$_tdcMenuSettings.find("#"+b+"-data"),a=d.html();b=tdcLivePanelMenuSettings.$_tdcMenuSettings.find("#"+b);var c=b.contents().find("#update-nav-menu");""===a?d.html(c.contents().clone()):(c.html(a),
tdcLivePanelMenuSettings._reinitWpNavMenu(b[0].contentWindow||b[0].contentDocument))},_reinitWpNavMenu:function(b){b.menus.oneThemeLocationNoMenus=!1;b.wpNavMenu.jQueryExtensions=function(){};b.wpNavMenu.attachMenuEditListeners=function(){};b.wpNavMenu.attachQuickSearchListeners=function(){};b.wpNavMenu.attachThemeLocationsListeners=function(){};b.wpNavMenu.attachMenuSaveSubmitListeners=function(){};b.wpNavMenu.attachTabsPanelListeners=function(){};b.wpNavMenu.attachUnsavedChangesListener=function(){};
b.wpNavMenu.initManageLocations=function(){};b.wpNavMenu.initAccessibility=function(){};b.wpNavMenu.initToggles=function(){};b.wpNavMenu.initPreviewing=function(){};b.wpNavMenu.init()},_setIframeInterface:function(b){function d(a,b){var c=jQuery("#"+a),d=c.contents(),e=jQuery("#"+a+"-data");d.find("#update-nav-menu").find("select[name*=td_mega_menu_cat]").each(function(a,b){var c=jQuery(b),d=c.find("option"),e=c.find("option:first");""===c.val()?(d.removeAttr("selected"),e.attr("selected","selected")):
d.each(function(a,b){var d=jQuery(b);c.val()===d.attr("value")?d.attr("selected","selected"):d.removeAttr("selected")})});d.find("#update-nav-menu").find("input").each(function(a,b){var c=jQuery(b);c.attr("value",c.val())});e.html(d.find("#update-nav-menu").contents().clone());!0===b&&(tdcLivePanelMenuSettings.$_tdcMenuSettings.hide(),c.hide())}function a(a){a=jQuery(a);var b=a.data("current_iframe");a=a.data("current_menu");var b=jQuery("#"+b),c=b.contents();(b[0].contentWindow||b[0].contentDocument).wpNavMenu.eventOnClickMenuSave();
b=c.find("#update-nav-menu").serializeArray();window.tdcAdminSettings.customized.menus["existing_menu_"+a]=JSON.stringify(b);tdcLivePanel.submit()}if(f.isUndefined(b))tdcLivePanelMenuSettings.$_iframeCloseButton.data("current_iframe",""),tdcLivePanelMenuSettings.$_iframeApplyButton.data("current_iframe",""),tdcLivePanelMenuSettings.$_iframeOkButton.data("current_iframe",""),tdcLivePanelMenuSettings.$_iframeCloseButton.data("current_menu",""),tdcLivePanelMenuSettings.$_iframeApplyButton.data("current_menu",
""),tdcLivePanelMenuSettings.$_iframeOkButton.data("current_menu",""),tdcLivePanelMenuSettings.$_iframeCloseButton.hide(),tdcLivePanelMenuSettings.$_iframeApplyButton.hide(),tdcLivePanelMenuSettings.$_iframeOkButton.hide();else{var c=b.menuId;b=b.menuName;f.isUndefined(tdcLivePanelMenuSettings.$_iframeCloseButton)&&(tdcLivePanelMenuSettings.$_iframeCloseButton=tdcLivePanelMenuSettings.$_tdcMenuSettings.find(".tdc-iframe-close-button"),tdcLivePanelMenuSettings.$_iframeCloseButton.click(function(a){tdcLivePanelMenuSettings._closeSettings()}));
f.isUndefined(tdcLivePanelMenuSettings.$_iframeApplyButton)&&(tdcLivePanelMenuSettings.$_iframeApplyButton=tdcLivePanelMenuSettings.$_tdcMenuSettings.find(".tdc-iframe-apply-button"),tdcLivePanelMenuSettings.$_iframeApplyButton.click(function(b){d(jQuery(this).data("current_iframe"),!1);a(this)}));f.isUndefined(tdcLivePanelMenuSettings.$_iframeOkButton)&&(tdcLivePanelMenuSettings.$_iframeOkButton=tdcLivePanelMenuSettings.$_tdcMenuSettings.find(".tdc-iframe-ok-button"),tdcLivePanelMenuSettings.$_iframeOkButton.click(function(b){d(jQuery(this).data("current_iframe"),
!0);a(this)}));tdcLivePanelMenuSettings.$_tdcMenuSettings.find(".title").html("MENU: "+b);tdcLivePanelMenuSettings.$_iframeCloseButton.data("current_iframe","tdc-iframe-settings-menu-"+c);tdcLivePanelMenuSettings.$_iframeApplyButton.data("current_iframe","tdc-iframe-settings-menu-"+c);tdcLivePanelMenuSettings.$_iframeOkButton.data("current_iframe","tdc-iframe-settings-menu-"+c);tdcLivePanelMenuSettings.$_iframeCloseButton.data("current_menu",c);tdcLivePanelMenuSettings.$_iframeApplyButton.data("current_menu",
c);tdcLivePanelMenuSettings.$_iframeOkButton.data("current_menu",c);tdcLivePanelMenuSettings.$_iframeCloseButton.show();tdcLivePanelMenuSettings.$_iframeApplyButton.show();tdcLivePanelMenuSettings.$_iframeOkButton.show()}},saveMenuSettings:function(){tdcLivePanelMenuSettings.$_tdcMenuSettings.find("iframe").each(function(b,d){var a=jQuery(d);tdcLivePanelMenuSettings._synchronizeIframeMenuData(a.attr("id"));(d.contentWindow||d.contentDocument).wpNavMenu.eventOnClickMenuSave();var c=a.data("menu_id"),
a=a.contents().find("#update-nav-menu"),e=a.serializeArray(),f={};a.find("input[name=nav-menu-data]").val(JSON.stringify(e));a.find("input[type=hidden]").each(function(a,b){var c=jQuery(b);f[c.attr("name")]=c.val()});jQuery.ajax({url:"nav-menus.php?menu="+c,method:"POST",data:f})})}};tdcLivePanelMenuSettings.init()})(_);var tdcLivePanelPageSettings;
(function(f,e){tdcLivePanelPageSettings={_isInitialized:!1,_url:e,_currentIframeId:e,$_tdcPageSettings:e,$_currentIframePageSettings:e,$_iframeCloseButton:e,$_iframeApplyButton:e,$_iframeOkButton:e,init:function(){tdcLivePanelPageSettings._isInitialized||(tdcLivePanelPageSettings.$_tdcPageSettings=jQuery("#tdc-page-settings"),tdcLivePanelMenuSettings._isInitialized=!0)},showSettings:function(){tdcLivePanel.setCurrentSettingsPanel(tdcLivePanelPageSettings);tdcLivePanelPageSettings._url=window.tdcAdminSettings.editPostUrl+
"&tdc-page-settings=1";tdcLivePanelPageSettings.$_currentIframePageSettings=tdcLivePanelPageSettings.$_tdcPageSettings.find(".tdc-iframe-settings-page");tdcLivePanelPageSettings.$_tdcPageSettings.show();tdcWindowFrame.setWindowFrame(tdcLivePanelPageSettings.$_tdcPageSettings);tdcLivePanelPageSettings.$_currentIframePageSettings.length?(tdcLivePanelPageSettings.$_currentIframePageSettings.show(),tdcLivePanelPageSettings._setIframeInterface({type:"page_settings"})):(tdcLivePanelPageSettings.$_tdcPageSettings.addClass("tdc-dropped"),
tdcLivePanelPageSettings.$_currentIframePageSettings=jQuery('<iframe class="tdc-iframe-settings-page" src="'+tdcLivePanelPageSettings._url+'" scrolling="auto" style="width: 100%; height: 100%"></iframe>'),tdcLivePanelPageSettings.$_tdcPageSettings.children(".content").append(tdcLivePanelPageSettings.$_currentIframePageSettings),tdcLivePanelPageSettings.$_currentIframePageSettings.load(function(){var b=tdcLivePanelPageSettings.$_currentIframePageSettings.contents();tdcLivePanelPageSettings.$_tdcPageSettings.removeClass("tdc-dropped");
tdcLivePanelPageSettings._setIframeInterface({type:"page_settings"});b.find("body").on("mousedown mouseup",function(b){window.parent.jQuery("#tdc-page-settings").trigger(b)});tdcLivePanelPageSettings!==tdcLivePanel.getCurrentSettingsPanel()&&tdcLivePanelPageSettings.closeSettings()}));tdcLivePanelPageSettings!==tdcLivePanel.getCurrentSettingsPanel()&&tdcLivePanelPageSettings.closeSettings()},_setIframeInterface:function(b){function d(a){var b=jQuery("iframe.tdc-iframe-settings-page");b.contents();
!0===a&&(tdcLivePanelPageSettings.$_tdcPageSettings.hide(),b.hide())}function a(a){a=jQuery("iframe.tdc-iframe-settings-page").contents().find("#post").serializeArray();for(var b={td_homepage_loop:{},td_page:{},page_template:""},c=0;c<a.length;c++){var d=a[c].name;"td_homepage_loop[td_sidebar_position]"===d||"td_homepage_loop[td_sidebar]"===d||"td_homepage_loop[td_layout]"===d||"td_homepage_loop[list_custom_title_show]"===d||"td_homepage_loop[list_custom_title]"===d||"td_homepage_loop[post_ids]"===
d||"td_homepage_loop[category_id]"===d||"td_homepage_loop[category_ids]"===d||"td_homepage_loop[tag_slug]"===d||"td_homepage_loop[autors_id]"===d||"td_homepage_loop[installed_post_types]"===d||"td_homepage_loop[sort]"===d||"td_homepage_loop[limit]"===d||"td_homepage_loop[offset]"===d||"td_homepage_loop[el_class]"===d||"td_homepage_loop[show_featured_posts]"===d||"td_homepage_loop[td_unique_articles]"===d||"td_homepage_loop[td_unique_articles]"===d?(d=d.replace(/td_homepage_loop\[|\]/gi,""),b.td_homepage_loop[d]=
a[c].value):"td_page[td_unique_articles]"===d?b.td_page[d.replace(/td_page\[|\]/gi,"")]=a[c].value:"page_template"===d&&(b.page_template=a[c].value)}window.tdcAdminSettings.customized.page_settings=JSON.stringify(b);tdcLivePanel.submit()}f.isUndefined(b)?(tdcLivePanelPageSettings.$_iframeCloseButton.data("current_iframe",""),tdcLivePanelPageSettings.$_iframeApplyButton.data("current_iframe",""),tdcLivePanelPageSettings.$_iframeOkButton.data("current_iframe",""),tdcLivePanelPageSettings.$_iframeCloseButton.hide(),
tdcLivePanelPageSettings.$_iframeApplyButton.hide(),tdcLivePanelPageSettings.$_iframeOkButton.hide()):(f.isUndefined(tdcLivePanelPageSettings.$_iframeCloseButton)&&(tdcLivePanelPageSettings.$_iframeCloseButton=tdcLivePanelPageSettings.$_tdcPageSettings.find(".tdc-iframe-close-button"),tdcLivePanelPageSettings.$_iframeCloseButton.click(function(a){tdcLivePanelPageSettings._closeSettings()})),f.isUndefined(tdcLivePanelPageSettings.$_iframeApplyButton)&&(tdcLivePanelPageSettings.$_iframeApplyButton=
tdcLivePanelPageSettings.$_tdcPageSettings.find(".tdc-iframe-apply-button"),tdcLivePanelPageSettings.$_iframeApplyButton.click(function(b){d(!1);a(this)})),f.isUndefined(tdcLivePanelPageSettings.$_iframeOkButton)&&(tdcLivePanelPageSettings.$_iframeOkButton=tdcLivePanelPageSettings.$_tdcPageSettings.find(".tdc-iframe-ok-button"),tdcLivePanelPageSettings.$_iframeOkButton.click(function(b){d(!0);a(this)})),tdcLivePanelPageSettings.$_tdcPageSettings.find(".title").html("Page settings"),tdcLivePanelPageSettings.$_iframeCloseButton.data("current_iframe",
"tdc-iframe-settings-page"),tdcLivePanelPageSettings.$_iframeApplyButton.data("current_iframe","tdc-iframe-settings-page"),tdcLivePanelPageSettings.$_iframeOkButton.data("current_iframe","tdc-iframe-settings-page"),tdcLivePanelPageSettings.$_iframeCloseButton.show(),tdcLivePanelPageSettings.$_iframeApplyButton.show(),tdcLivePanelPageSettings.$_iframeOkButton.show())},_closeSettings:function(){tdcLivePanelPageSettings.$_tdcPageSettings.hide();tdcLivePanelPageSettings.removeClass("clear-position");
tdcLivePanelPageSettings.setPosition({top:"",left:""})},closeSettings:function(){f.isUndefined(tdcLivePanelPageSettings.$_iframeCloseButton)||tdcLivePanelPageSettings.$_iframeCloseButton.trigger("click")},setPosition:function(b){tdcLivePanelPageSettings.$_tdcPageSettings.css({top:b.top,left:b.left})},getPosition:function(b){var d={};d.top=tdcLivePanelPageSettings.$_tdcPageSettings.offset().top-jQuery(window).scrollTop();d.left=tdcLivePanelPageSettings.$_tdcPageSettings.offset().left-jQuery(window).scrollLeft();
b&&(d.top+=tdcLivePanelPageSettings.$_tdcPageSettings.height()/2,d.left+=tdcLivePanelPageSettings.$_tdcPageSettings.width()/2);return d},addClass:function(b){tdcLivePanelPageSettings.$_tdcPageSettings.addClass(b)},removeClass:function(b){tdcLivePanelPageSettings.$_tdcPageSettings.removeClass(b)},hasClass:function(b){return tdcLivePanelPageSettings.$_tdcPageSettings.hasClass(b)}};tdcLivePanelPageSettings.init()})(_);
